{"version":3,"file":"ReportView-nD5fRgZk.js","sources":["../../node_modules/lucide-react/dist/esm/icons/power-off.js","../../node_modules/lucide-react/dist/esm/icons/power.js","../../node_modules/lucide-react/dist/esm/icons/x-circle.js","../../src/lib/reportGeneration.ts","../../src/hooks/useReports.ts","../../src/components/AdvancedReportGenerator.tsx","../../src/components/ReportHistoryManagement.tsx","../../src/components/ScheduledReportManagement.tsx","../../src/components/ReportView.tsx"],"sourcesContent":["/**\n * @license lucide-react v0.344.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst PowerOff = createLucideIcon(\"PowerOff\", [\n  [\"path\", { d: \"M18.36 6.64A9 9 0 0 1 20.77 15\", key: \"dxknvb\" }],\n  [\"path\", { d: \"M6.16 6.16a9 9 0 1 0 12.68 12.68\", key: \"1x7qb5\" }],\n  [\"path\", { d: \"M12 2v4\", key: \"3427ic\" }],\n  [\"path\", { d: \"m2 2 20 20\", key: \"1ooewy\" }]\n]);\n\nexport { PowerOff as default };\n//# sourceMappingURL=power-off.js.map\n","/**\n * @license lucide-react v0.344.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst Power = createLucideIcon(\"Power\", [\n  [\"path\", { d: \"M12 2v10\", key: \"mnfbl\" }],\n  [\"path\", { d: \"M18.4 6.6a9 9 0 1 1-12.77.04\", key: \"obofu9\" }]\n]);\n\nexport { Power as default };\n//# sourceMappingURL=power.js.map\n","/**\n * @license lucide-react v0.344.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst XCircle = createLucideIcon(\"XCircle\", [\n  [\"circle\", { cx: \"12\", cy: \"12\", r: \"10\", key: \"1mglay\" }],\n  [\"path\", { d: \"m15 9-6 6\", key: \"1uzhvr\" }],\n  [\"path\", { d: \"m9 9 6 6\", key: \"z0biqf\" }]\n]);\n\nexport { XCircle as default };\n//# sourceMappingURL=x-circle.js.map\n","// src/lib/reportGeneration.ts\nimport { supabase } from './supabase';\nimport { calculateACWR, RecordLike } from './acwr';\nimport { getTodayJST, formatDateJST } from './date';\n\nexport interface ReportPeriod {\n  start: string; // YYYY-MM-DD\n  end: string;   // YYYY-MM-DD\n  type: 'weekly' | 'monthly' | 'quarterly' | 'semi_annual' | 'annual' | 'custom';\n}\n\nexport interface AthleteReportData {\n  athleteId: string;\n  athleteName: string;\n  athleteEmail: string;\n\n  trainingRecords: {\n    totalSessions: number;\n    totalLoad: number;\n    averageLoad: number;\n    maxLoad: number;\n    averageRPE: number;\n    totalDuration: number;\n  };\n\n  acwrData: {\n    current: number;\n    average: number;\n    max: number;\n    min: number;\n    riskLevel: 'low' | 'medium' | 'high';\n    daysInDangerZone: number;\n    trend: 'improving' | 'stable' | 'declining';\n  };\n\n  weightData: {\n    current: number | null;\n    average: number | null;\n    change: number | null;\n    changePercent: number | null;\n    trend: 'increasing' | 'stable' | 'decreasing' | 'no_data';\n  };\n\n  sleepData: {\n    averageHours: number | null;\n    averageQuality: number | null;\n    totalRecords: number;\n    qualityTrend: 'improving' | 'stable' | 'declining' | 'no_data';\n  };\n\n  motivationData: {\n    averageMotivation: number | null;\n    averageEnergy: number | null;\n    averageStress: number | null;\n    totalRecords: number;\n    motivationTrend: 'improving' | 'stable' | 'declining' | 'no_data';\n  };\n\n  performanceData: {\n    totalTests: number;\n    personalBests: number;\n    improvements: number;\n    declines: number;\n  };\n\n  alerts: {\n    total: number;\n    high: number;\n    medium: number;\n    low: number;\n    resolved: number;\n  };\n}\n\nexport interface TeamReportSummary {\n  teamId: string;\n  teamName: string;\n  period: ReportPeriod;\n  generatedAt: string;\n\n  totalAthletes: number;\n  activeAthletes: number;\n\n  teamAverageLoad: number;\n  teamAverageACWR: number;\n\n  highRiskCount: number;\n  mediumRiskCount: number;\n  lowRiskCount: number;\n\n  totalAlerts: number;\n  newAlerts: number;\n  criticalAlerts: number;\n\n  athletes: AthleteReportData[];\n\n  insights: string[];\n  recommendations: string[];\n}\n\n// ========= helpers =========\n\nfunction toNumber(v: any): number | null {\n  if (v === null || v === undefined || v === '') return null;\n  const n = typeof v === 'number' ? v : Number(v);\n  return Number.isFinite(n) ? n : null;\n}\n\nfunction toYMD(input: any): string | null {\n  if (!input) return null;\n  if (typeof input === 'string') {\n    const m = input.match(/^(\\d{4}-\\d{2}-\\d{2})/);\n    return m ? m[1] : null;\n  }\n  try {\n    const d = new Date(input);\n    if (Number.isNaN(d.getTime())) return null;\n    return d.toISOString().slice(0, 10);\n  } catch {\n    return null;\n  }\n}\n\nfunction calcLoad(row: any): number {\n  const loadRaw = toNumber(row?.load);\n  if (loadRaw != null) return loadRaw;\n  const rpe = toNumber(row?.rpe);\n  const dur = toNumber(row?.duration_min);\n  if (rpe != null && dur != null) return rpe * dur;\n  return 0;\n}\n\nfunction round2(n: number) {\n  return Math.round(n * 100) / 100;\n}\n\n// ========= main =========\n\nexport async function generateAthleteReport(\n  athleteId: string,\n  period: ReportPeriod\n): Promise<AthleteReportData> {\n  // 選手情報取得\n  const { data: athlete, error: athleteErr } = await supabase\n    .from('users')\n    .select('*')\n    .eq('id', athleteId)\n    .single();\n\n  if (athleteErr) throw athleteErr;\n  if (!athlete) throw new Error('Athlete not found');\n\n  // トレーニングデータ取得（dateはYYYY-MM-DD運用前提）\n  const { data: trainingRecords, error: trErr } = await supabase\n    .from('training_records')\n    .select('*')\n    .eq('user_id', athleteId)\n    .gte('date', period.start)\n    .lte('date', period.end)\n    .order('date', { ascending: true });\n\n  if (trErr) throw trErr;\n\n  const totalSessions = trainingRecords?.length || 0;\n\n  const totalLoad =\n    trainingRecords?.reduce((sum, r: any) => sum + calcLoad(r), 0) || 0;\n\n  const totalDuration =\n    trainingRecords?.reduce((sum, r: any) => sum + (toNumber(r.duration_min) ?? 0), 0) || 0;\n\n  const averageLoad = totalSessions > 0 ? totalLoad / totalSessions : 0;\n\n  const maxLoad =\n    trainingRecords?.reduce((max, r: any) => Math.max(max, calcLoad(r)), 0) || 0;\n\n  const averageRPE =\n    totalSessions > 0\n      ? (trainingRecords || []).reduce((sum: number, r: any) => sum + (toNumber(r.rpe) ?? 0), 0) /\n        totalSessions\n      : 0;\n\n  // ✅ ACWR：RecordLike[] に正規化してから計算（ここが超重要）\n  const recordLikes: RecordLike[] =\n    (trainingRecords || [])\n      .map((r: any) => {\n        const date = toYMD(r?.date);\n        if (!date) return null;\n        return { date, load: calcLoad(r) };\n      })\n      .filter(Boolean) as RecordLike[];\n\n  const acwrResults = recordLikes.length > 0 ? calculateACWR(recordLikes) : [];\n\n  const acwrValues = acwrResults\n    .map(r => r.acwr)\n    .filter(v => typeof v === 'number' && Number.isFinite(v)) as number[];\n\n  // null期間があるので「最後の有効値」を採用\n  const currentACWR = acwrValues.length > 0 ? acwrValues[acwrValues.length - 1] : 0;\n\n  const averageACWR =\n    acwrValues.length > 0 ? acwrValues.reduce((sum, v) => sum + v, 0) / acwrValues.length : 0;\n\n  const maxACWR = acwrValues.length > 0 ? Math.max(...acwrValues) : 0;\n  const minACWR = acwrValues.length > 0 ? Math.min(...acwrValues) : 0;\n\n  const daysInDangerZone = acwrValues.filter(v => v < 0.8 || v > 1.3).length;\n\n  // AthleteList/Chart基準に寄せる（high=1.5+, caution=1.3+）\n  const riskLevel: 'low' | 'medium' | 'high' =\n    currentACWR >= 1.5 ? 'high'\n    : currentACWR >= 1.3 ? 'medium'\n    : currentACWR >= 0.8 ? 'low'\n    : 'medium'; // 低すぎも注意扱いに寄せる（必要ならlowに変えてOK）\n\n  const acwrTrend =\n    acwrValues.length >= 3\n      ? acwrValues[acwrValues.length - 1] >\n        acwrValues[Math.floor(acwrValues.length / 2)]\n        ? 'improving'\n        : 'declining'\n      : 'stable';\n\n  // 体重データ取得\n  const { data: weightRecords, error: wErr } = await supabase\n    .from('weight_records')\n    .select('*')\n    .eq('user_id', athleteId)\n    .gte('date', period.start)\n    .lte('date', period.end)\n    .order('date', { ascending: true });\n\n  if (wErr) throw wErr;\n\n  const weights = (weightRecords || [])\n    .map((r: any) => toNumber(r.weight_kg))\n    .filter((v: any) => typeof v === 'number' && Number.isFinite(v)) as number[];\n\n  const currentWeight = weights.length > 0 ? weights[weights.length - 1] : null;\n  const firstWeight = weights.length > 0 ? weights[0] : null;\n\n  const averageWeight =\n    weights.length > 0 ? weights.reduce((sum, w) => sum + w, 0) / weights.length : null;\n\n  const weightChange =\n    currentWeight != null && firstWeight != null ? currentWeight - firstWeight : null;\n\n  const weightChangePercent =\n    currentWeight != null && firstWeight != null && firstWeight > 0\n      ? ((currentWeight - firstWeight) / firstWeight) * 100\n      : null;\n\n  const weightTrend: 'increasing' | 'stable' | 'decreasing' | 'no_data' =\n    weightChange == null\n      ? 'no_data'\n      : Math.abs(weightChange) < 0.5\n      ? 'stable'\n      : weightChange > 0\n      ? 'increasing'\n      : 'decreasing';\n\n  // 睡眠データ取得\n  const { data: sleepRecords, error: sErr } = await supabase\n    .from('sleep_records')\n    .select('*')\n    .eq('user_id', athleteId)\n    .gte('date', period.start)\n    .lte('date', period.end);\n\n  if (sErr) throw sErr;\n\n  const sleepHours = (sleepRecords || [])\n    .map((r: any) => toNumber(r.sleep_hours))\n    .filter((v: any) => typeof v === 'number' && Number.isFinite(v)) as number[];\n\n  const sleepQualities = (sleepRecords || [])\n    .map((r: any) => toNumber(r.sleep_quality))\n    .filter((v: any) => typeof v === 'number' && Number.isFinite(v)) as number[];\n\n  const averageSleepHours =\n    sleepHours.length > 0 ? sleepHours.reduce((sum, h) => sum + h, 0) / sleepHours.length : null;\n\n  const averageSleepQuality =\n    sleepQualities.length > 0\n      ? sleepQualities.reduce((sum, q) => sum + q, 0) / sleepQualities.length\n      : null;\n\n  const sleepQualityTrend: 'improving' | 'stable' | 'declining' | 'no_data' =\n    sleepQualities.length < 3\n      ? 'no_data'\n      : sleepQualities[sleepQualities.length - 1] >\n        sleepQualities[Math.floor(sleepQualities.length / 2)]\n      ? 'improving'\n      : sleepQualities[sleepQualities.length - 1] <\n        sleepQualities[Math.floor(sleepQualities.length / 2)]\n      ? 'declining'\n      : 'stable';\n\n  // モチベーションデータ取得\n  const { data: motivationRecords, error: mErr } = await supabase\n    .from('motivation_records')\n    .select('*')\n    .eq('user_id', athleteId)\n    .gte('date', period.start)\n    .lte('date', period.end);\n\n  if (mErr) throw mErr;\n\n  const motivations = (motivationRecords || [])\n    .map((r: any) => toNumber(r.motivation_level))\n    .filter((v: any) => typeof v === 'number' && Number.isFinite(v)) as number[];\n\n  const energies = (motivationRecords || [])\n    .map((r: any) => toNumber(r.energy_level))\n    .filter((v: any) => typeof v === 'number' && Number.isFinite(v)) as number[];\n\n  const stresses = (motivationRecords || [])\n    .map((r: any) => toNumber(r.stress_level))\n    .filter((v: any) => typeof v === 'number' && Number.isFinite(v)) as number[];\n\n  const averageMotivation =\n    motivations.length > 0 ? motivations.reduce((sum, m) => sum + m, 0) / motivations.length : null;\n\n  const averageEnergy =\n    energies.length > 0 ? energies.reduce((sum, e) => sum + e, 0) / energies.length : null;\n\n  const averageStress =\n    stresses.length > 0 ? stresses.reduce((sum, s) => sum + s, 0) / stresses.length : null;\n\n  const motivationTrend: 'improving' | 'stable' | 'declining' | 'no_data' =\n    motivations.length < 3\n      ? 'no_data'\n      : motivations[motivations.length - 1] >\n        motivations[Math.floor(motivations.length / 2)]\n      ? 'improving'\n      : motivations[motivations.length - 1] <\n        motivations[Math.floor(motivations.length / 2)]\n      ? 'declining'\n      : 'stable';\n\n  // パフォーマンスデータ取得\n  const { data: performanceRecords, error: pErr } = await supabase\n    .from('performance_records')\n    .select('*, performance_test_types(*)')\n    .eq('user_id', athleteId)\n    .gte('date', period.start)\n    .lte('date', period.end);\n\n  if (pErr) throw pErr;\n\n  const totalTests = performanceRecords?.length || 0;\n\n  let personalBests = 0;\n  let improvements = 0;\n  let declines = 0;\n\n  if (performanceRecords && performanceRecords.length > 0) {\n    const testTypeGroups = new Map<string, any[]>();\n    performanceRecords.forEach((record: any) => {\n      const typeId = record.test_type_id;\n      if (!testTypeGroups.has(typeId)) testTypeGroups.set(typeId, []);\n      testTypeGroups.get(typeId)!.push(record);\n    });\n\n    testTypeGroups.forEach(records => {\n      if (records.length >= 2) {\n        const sorted = [...records].sort(\n          (a, b) => new Date(a.date).getTime() - new Date(b.date).getTime()\n        );\n        const first = sorted[0];\n        const last = sorted[sorted.length - 1];\n\n        const firstValue = first?.values?.result;\n        const lastValue = last?.values?.result;\n\n        if (firstValue != null && lastValue != null) {\n          if (lastValue > firstValue) improvements++;\n          else if (lastValue < firstValue) declines++;\n        }\n      }\n    });\n  }\n\n  // アラート\n  type AlertRow = {\n    priority?: string | null;\n    metadata?: { priority?: string | null } | null;\n    is_resolved?: boolean | null;\n  };\n\n  const { data: alertsRaw } = await (supabase as any)\n    .from('alerts')\n    .select('*')\n    .eq('user_id', athleteId)\n    .gte('created_at', period.start)\n    .lte('created_at', period.end);\n\n  const alerts = (alertsRaw || []) as AlertRow[];\n\n  const totalAlerts = alerts.length;\n  const highAlerts = alerts.filter(a => a.priority === 'high').length;\n  const mediumAlerts = alerts.filter(a => a.metadata?.priority === 'medium').length;\n  const lowAlerts = alerts.filter(a => a.priority === 'low').length;\n  const resolvedAlerts = alerts.filter(a => a.is_resolved).length;\n\n  return {\n    athleteId: athlete.id,\n    athleteName: athlete.name,\n    athleteEmail: athlete.email,\n\n    trainingRecords: {\n      totalSessions,\n      totalLoad: round2(totalLoad),\n      averageLoad: round2(averageLoad),\n      maxLoad: round2(maxLoad),\n      averageRPE: round2(averageRPE),\n      totalDuration: Math.round(totalDuration),\n    },\n\n    acwrData: {\n      current: round2(currentACWR),\n      average: round2(averageACWR),\n      max: round2(maxACWR),\n      min: round2(minACWR),\n      riskLevel,\n      daysInDangerZone,\n      trend: acwrTrend,\n    },\n\n    weightData: {\n      current: currentWeight,\n      average: averageWeight != null ? round2(averageWeight) : null,\n      change: weightChange != null ? round2(weightChange) : null,\n      changePercent: weightChangePercent != null ? round2(weightChangePercent) : null,\n      trend: weightTrend,\n    },\n\n    sleepData: {\n      averageHours: averageSleepHours != null ? round2(averageSleepHours) : null,\n      averageQuality: averageSleepQuality != null ? round2(averageSleepQuality) : null,\n      totalRecords: sleepRecords?.length || 0,\n      qualityTrend: sleepQualityTrend,\n    },\n\n    motivationData: {\n      averageMotivation: averageMotivation != null ? round2(averageMotivation) : null,\n      averageEnergy: averageEnergy != null ? round2(averageEnergy) : null,\n      averageStress: averageStress != null ? round2(averageStress) : null,\n      totalRecords: motivationRecords?.length || 0,\n      motivationTrend,\n    },\n\n    performanceData: {\n      totalTests,\n      personalBests,\n      improvements,\n      declines,\n    },\n\n    alerts: {\n      total: totalAlerts,\n      high: highAlerts,\n      medium: mediumAlerts,\n      low: lowAlerts,\n      resolved: resolvedAlerts,\n    },\n  };\n}\n\nexport async function generateTeamReport(\n  teamId: string,\n  period: ReportPeriod\n): Promise<TeamReportSummary> {\n  const { data: team, error: teamErr } = await supabase\n    .from('teams')\n    .select('*')\n    .eq('id', teamId)\n    .single();\n\n  if (teamErr) throw teamErr;\n  if (!team) throw new Error('Team not found');\n\n  const { data: athletes, error: athErr } = await supabase\n    .from('users')\n    .select('*')\n    .eq('team_id', teamId)\n    .eq('role', 'athlete');\n\n  if (athErr) throw athErr;\n\n  const totalAthletes = athletes?.length || 0;\n\n  const athleteReports: AthleteReportData[] = [];\n  if (athletes) {\n    for (const athlete of athletes) {\n      try {\n        const report = await generateAthleteReport(athlete.id, period);\n        athleteReports.push(report);\n      } catch (error) {\n        console.error(`Error generating report for athlete ${athlete.id}:`, error);\n      }\n    }\n  }\n\n  const activeAthletes = athleteReports.filter(r => r.trainingRecords.totalSessions > 0).length;\n\n  const teamAverageLoad =\n    activeAthletes > 0\n      ? athleteReports.reduce((sum, r) => sum + r.trainingRecords.averageLoad, 0) / activeAthletes\n      : 0;\n\n  const athletesWithACWR = athleteReports.filter(r => r.acwrData.current > 0);\n  const teamAverageACWR =\n    athletesWithACWR.length > 0\n      ? athletesWithACWR.reduce((sum, r) => sum + r.acwrData.current, 0) / athletesWithACWR.length\n      : 0;\n\n  const highRiskCount = athleteReports.filter(r => r.acwrData.riskLevel === 'high').length;\n  const mediumRiskCount = athleteReports.filter(r => r.acwrData.riskLevel === 'medium').length;\n  const lowRiskCount = athleteReports.filter(r => r.acwrData.riskLevel === 'low').length;\n\n  const totalAlerts = athleteReports.reduce((sum, r) => sum + r.alerts.total, 0);\n  const criticalAlerts = athleteReports.reduce((sum, r) => sum + r.alerts.high, 0);\n\n  const insights: string[] = [];\n  const recommendations: string[] = [];\n\n  if (teamAverageACWR > 1.3) {\n    insights.push(\n      `チーム平均ACWR（${teamAverageACWR.toFixed(2)}）が推奨範囲を超えています。全体的にトレーニング負荷が高い状態です。`\n    );\n    recommendations.push('チーム全体のトレーニング強度を見直し、適切な休息日を設けることを推奨します。');\n  } else if (teamAverageACWR < 0.8 && teamAverageACWR > 0) {\n    insights.push(\n      `チーム平均ACWR（${teamAverageACWR.toFixed(2)}）が推奨範囲を下回っています。トレーニング負荷が不足している可能性があります。`\n    );\n    recommendations.push('選手のコンディションを確認しながら、段階的にトレーニング負荷を増やすことを検討してください。');\n  } else {\n    insights.push(`チーム平均ACWR（${teamAverageACWR.toFixed(2)}）は適切な範囲内です。`);\n  }\n\n  if (highRiskCount > 0) {\n    insights.push(`${highRiskCount}名の選手が高リスク状態です。個別対応が必要です。`);\n    recommendations.push(\n      `高リスク選手: ${athleteReports\n        .filter(r => r.acwrData.riskLevel === 'high')\n        .map(r => r.athleteName)\n        .join(', ')} の負荷調整を優先してください。`\n    );\n  }\n\n  if (criticalAlerts > 0) {\n    insights.push(`${criticalAlerts}件の重要アラートが発生しています。`);\n    recommendations.push('高優先度のアラートに対して迅速に対応してください。');\n  }\n\n  const lowSleepAthletes = athleteReports.filter(\n    r => r.sleepData.averageHours !== null && r.sleepData.averageHours < 7\n  );\n  if (lowSleepAthletes.length > 0) {\n    insights.push(`${lowSleepAthletes.length}名の選手の平均睡眠時間が7時間未満です。`);\n    recommendations.push(\n      `睡眠不足の選手（${lowSleepAthletes.map(r => r.athleteName).join('、')}）に対して、睡眠習慣の改善を指導してください。`\n    );\n  }\n\n  const lowMotivationAthletes = athleteReports.filter(\n    r => r.motivationData.averageMotivation !== null && r.motivationData.averageMotivation < 3\n  );\n  if (lowMotivationAthletes.length > 0) {\n    insights.push(`${lowMotivationAthletes.length}名の選手のモチベーションが低下しています。`);\n    recommendations.push(\n      `モチベーション低下が見られる選手（${lowMotivationAthletes.map(r => r.athleteName).join('、')}）と個別面談を行うことを推奨します。`\n    );\n  }\n\n  return {\n    teamId: team.id,\n    teamName: team.name,\n    period,\n    generatedAt: new Date().toISOString(),\n    totalAthletes,\n    activeAthletes,\n    teamAverageLoad: round2(teamAverageLoad),\n    teamAverageACWR: round2(teamAverageACWR),\n    highRiskCount,\n    mediumRiskCount,\n    lowRiskCount,\n    totalAlerts,\n    newAlerts: totalAlerts,\n    criticalAlerts,\n    athletes: athleteReports,\n    insights,\n    recommendations,\n  };\n}\n\nexport function getPeriodDates(\n  periodType: ReportPeriod['type'],\n  customStart?: string,\n  customEnd?: string\n): ReportPeriod {\n  const todayJST = getTodayJST();\n  const end = new Date(todayJST.getTime());\n  let start = new Date(end.getTime());\n\n  switch (periodType) {\n    case 'weekly':\n      start.setDate(end.getDate() - 7);\n      break;\n    case 'monthly':\n      start.setMonth(end.getMonth() - 1);\n      break;\n    case 'quarterly':\n      start.setMonth(end.getMonth() - 3);\n      break;\n    case 'semi_annual':\n      start.setMonth(end.getMonth() - 6);\n      break;\n    case 'annual':\n      start.setFullYear(end.getFullYear() - 1);\n      break;\n    case 'custom':\n      if (customStart && customEnd) {\n        return { start: customStart, end: customEnd, type: 'custom' };\n      }\n      break;\n  }\n\n  return {\n    start: formatDateJST(start),\n    end: formatDateJST(end),\n    type: periodType,\n  };\n}\n\nexport function getPeriodLabel(period: ReportPeriod): string {\n  switch (period.type) {\n    case 'weekly':\n      return '過去1週間';\n    case 'monthly':\n      return '過去1ヶ月';\n    case 'quarterly':\n      return '過去3ヶ月';\n    case 'semi_annual':\n      return '過去6ヶ月';\n    case 'annual':\n      return '過去1年';\n    case 'custom':\n      return `${period.start} 〜 ${period.end}`;\n    default:\n      return '期間不明';\n  }\n}","import { useState, useEffect } from 'react';\nimport { supabase } from '../lib/supabase';\nimport { generateTeamReport, ReportPeriod, getPeriodDates } from '../lib/reportGeneration';\nimport { getNowJSTISOString } from '../lib/date';\n\n// DB の実態に寄せて「null 許容」にしておく\nexport interface ReportConfig {\n  id: string;\n  name: string;\n  description: string | null;\n  organization_id: string | null;\n  team_id: string | null;\n  created_by: string | null;\n  period_type: 'weekly' | 'monthly' | 'quarterly' | 'semi_annual' | 'annual' | 'custom';\n  include_training_load: boolean | null;\n  include_acwr: boolean | null;\n  include_weight: boolean | null;\n  include_sleep: boolean | null;\n  include_motivation: boolean | null;\n  include_performance: boolean | null;\n  include_alerts: boolean | null;\n  compare_with_previous: boolean | null;\n  include_team_average: boolean | null;\n  highlight_high_risk: boolean | null;\n  settings: any;\n  is_active: boolean | null;\n  created_at: string | null;\n  updated_at: string | null;\n}\n\n// DB 側の型に合わせて null を許容 & report_type は optional に\nexport interface GeneratedReport {\n  id: string;\n  config_id: string | null;\n  schedule_id: string | null;\n  report_type?: string; // database.types に無くてもエラーにならないように optional\n  title: string | null;\n  period_start: string | null;\n  period_end: string | null;\n  organization_id: string | null;\n  team_id: string | null;\n  athlete_ids: string[] | null;\n  summary_data: any;\n  detailed_data: any;\n  insights: string[] | null;\n  recommendations: string[] | null;\n  pdf_url: string | null;\n  generation_status: string;\n  error_message: string | null;\n  generated_by: string | null;\n  generated_at: string | null;\n  viewed_at: string | null;\n  view_count: number;\n  created_at: string | null;\n}\n\nexport function useReports(teamId: string | null) {\n  const [reports, setReports] = useState<GeneratedReport[]>([]);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState<string | null>(null);\n\n  useEffect(() => {\n    if (teamId) {\n      fetchReports();\n    } else {\n      setReports([]);\n      setLoading(false);\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [teamId]);\n\n  const fetchReports = async () => {\n    if (!teamId) return;\n\n    try {\n      setLoading(true);\n      setError(null);\n\n      const { data, error: fetchError } = await supabase\n        .from('generated_reports')\n        .select('*')\n        .eq('team_id', teamId)\n        .order('created_at', { ascending: false })\n        .limit(50);\n\n      if (fetchError) throw fetchError;\n\n      // DB の Row 型 → GeneratedReport へのキャスト（フィールド名は同じなので OK）\n      setReports((data || []) as GeneratedReport[]);\n    } catch (err: any) {\n      console.error('Error fetching reports:', err);\n      setError(err.message);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const generateReport = async (\n    teamId: string,\n    periodType: ReportPeriod['type'],\n    customStart?: string,\n    customEnd?: string\n  ): Promise<{ success: boolean; reportId?: string; error?: string }> => {\n    try {\n      const period = getPeriodDates(periodType, customStart, customEnd);\n      const reportData = await generateTeamReport(teamId, period);\n\n      const { data: team } = await supabase\n        .from('teams')\n        .select('name')\n        .eq('id', teamId)\n        .single();\n\n      const title = `${team?.name || 'チーム'}レポート - ${period.start} 〜 ${period.end}`;\n\n      // Supabase の generated_reports 型に合わせるため any キャストで緩める\n      const insertPayload: any = {\n        report_type: periodType,\n        title,\n        period_start: period.start,\n        period_end: period.end,\n        team_id: teamId,\n        athlete_ids: reportData.athletes.map(a => a.athleteId),\n        summary_data: {\n          totalAthletes: reportData.totalAthletes,\n          activeAthletes: reportData.activeAthletes,\n          teamAverageLoad: reportData.teamAverageLoad,\n          teamAverageACWR: reportData.teamAverageACWR,\n          highRiskCount: reportData.highRiskCount,\n          mediumRiskCount: reportData.mediumRiskCount,\n          lowRiskCount: reportData.lowRiskCount,\n          totalAlerts: reportData.totalAlerts,\n          criticalAlerts: reportData.criticalAlerts\n        },\n        detailed_data: reportData,              // TeamReportSummary → Json 扱いにする\n        insights: reportData.insights,\n        recommendations: reportData.recommendations,\n        generation_status: 'completed'\n      };\n\n      const { data: insertedReport, error: insertError } = await supabase\n        .from('generated_reports')\n        .insert(insertPayload)\n        .select()\n        .single();\n\n      if (insertError) throw insertError;\n\n      await fetchReports();\n\n      return {\n        success: true,\n        reportId: insertedReport.id\n      };\n    } catch (err: any) {\n      console.error('Error generating report:', err);\n      return {\n        success: false,\n        error: err.message\n      };\n    }\n  };\n\n  const markReportAsViewed = async (reportId: string) => {\n    try {\n      const { error } = await supabase\n        .from('generated_reports')\n        .update({ viewed_at: getNowJSTISOString() })\n        .eq('id', reportId);\n\n      if (error) throw error;\n\n      await fetchReports();\n    } catch (err: any) {\n      console.error('Error marking report as viewed:', err);\n    }\n  };\n\n  const deleteReport = async (reportId: string): Promise<{ success: boolean; error?: string }> => {\n    try {\n      const { error } = await supabase\n        .from('generated_reports')\n        .delete()\n        .eq('id', reportId);\n\n      if (error) throw error;\n\n      await fetchReports();\n\n      return { success: true };\n    } catch (err: any) {\n      console.error('Error deleting report:', err);\n      return {\n        success: false,\n        error: err.message\n      };\n    }\n  };\n\n  return {\n    reports,\n    loading,\n    error,\n    generateReport,\n    markReportAsViewed,\n    deleteReport,\n    refreshReports: fetchReports\n  };\n}\n\nexport function useReportConfigs(organizationId: string | null) {\n  const [configs, setConfigs] = useState<ReportConfig[]>([]);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState<string | null>(null);\n\n  useEffect(() => {\n    if (organizationId) {\n      fetchConfigs();\n    } else {\n      setConfigs([]);\n      setLoading(false);\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [organizationId]);\n\n  const fetchConfigs = async () => {\n    if (!organizationId) return;\n\n    try {\n      setLoading(true);\n      setError(null);\n\n      const { data, error: fetchError } = await supabase\n        .from('report_configs')\n        .select('*')\n        .eq('organization_id', organizationId)\n        .order('created_at', { ascending: false });\n\n      if (fetchError) throw fetchError;\n\n      setConfigs((data || []) as ReportConfig[]);\n    } catch (err: any) {\n      console.error('Error fetching report configs:', err);\n      setError(err.message);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const createConfig = async (config: Partial<ReportConfig>): Promise<{ success: boolean; error?: string }> => {\n    try {\n      // name など必須項目は UI 側で必ず入れる前提で any キャスト\n      const { error } = await supabase\n        .from('report_configs')\n        .insert(config as any);\n\n      if (error) throw error;\n\n      await fetchConfigs();\n\n      return { success: true };\n    } catch (err: any) {\n      console.error('Error creating report config:', err);\n      return {\n        success: false,\n        error: err.message\n      };\n    }\n  };\n\n  const updateConfig = async (id: string, updates: Partial<ReportConfig>): Promise<{ success: boolean; error?: string }> => {\n    try {\n      const { error } = await supabase\n        .from('report_configs')\n        .update(updates as any)\n        .eq('id', id);\n\n      if (error) throw error;\n\n      await fetchConfigs();\n\n      return { success: true };\n    } catch (err: any) {\n      console.error('Error updating report config:', err);\n      return {\n        success: false,\n        error: err.message\n      };\n    }\n  };\n\n  const deleteConfig = async (id: string): Promise<{ success: boolean; error?: string }> => {\n    try {\n      const { error } = await supabase\n        .from('report_configs')\n        .delete()\n        .eq('id', id);\n\n      if (error) throw error;\n\n      await fetchConfigs();\n\n      return { success: true };\n    } catch (err: any) {\n      console.error('Error deleting report config:', err);\n      return {\n        success: false,\n        error: err.message\n      };\n    }\n  };\n\n  return {\n    configs,\n    loading,\n    error,\n    createConfig,\n    updateConfig,\n    deleteConfig,\n    refreshConfigs: fetchConfigs\n  };\n}","// src/components/AdvancedReportGenerator.tsx\n/// <reference deno-lint-ignore-file no-explicit-any />\nimport React, { useEffect, useMemo, useState } from 'react';\nimport {\n  FileText,\n  Download,\n  Calendar,\n  Users,\n  User,\n  Building2,\n  Filter,\n  RefreshCcw,\n  ExternalLink,\n} from 'lucide-react';\nimport { supabase } from '../lib/supabase';\n\ninterface AdvancedReportGeneratorProps {\n  organizationId: string;\n  userId: string;\n}\n\ninterface ReportTemplate {\n  id: string;\n  name: string;\n  description: string | null;\n  report_type: 'individual' | 'team' | 'organization';\n}\n\ntype TeamRow = { id: string; name: string };\ntype AthleteRow = { id: string; name: string };\n\ntype ReportHistoryRow = {\n  id: string;\n  report_type: 'individual' | 'team' | 'organization';\n  status: 'pending' | 'completed' | 'failed';\n  created_at: string;\n  started_at: string | null;\n  completed_at: string | null;\n  file_path: string | null;\n  report_url: string | null;\n  error_message: string | null;\n  parameters: any;\n};\n\nexport function AdvancedReportGenerator({ organizationId, userId }: AdvancedReportGeneratorProps) {\n  const [templates, setTemplates] = useState<ReportTemplate[]>([]);\n  const [selectedTemplate, setSelectedTemplate] = useState<ReportTemplate | null>(null);\n\n  const [reportType, setReportType] = useState<'individual' | 'team' | 'organization'>('team');\n  const [dateRange, setDateRange] = useState({ start: '', end: '' });\n\n  const [selectedTeam, setSelectedTeam] = useState('');\n  const [selectedAthlete, setSelectedAthlete] = useState('');\n\n  const [teams, setTeams] = useState<TeamRow[]>([]);\n  const [athletes, setAthletes] = useState<AthleteRow[]>([]);\n\n  const [includeMetrics, setIncludeMetrics] = useState({\n    acwr: true,\n    training_load: true,\n    performance: true,\n    injury_risk: true,\n    attendance: true,\n    trends: true,\n  });\n\n  const [loadingTeams, setLoadingTeams] = useState(false);\n  const [loadingAthletes, setLoadingAthletes] = useState(false);\n\n  const [generating, setGenerating] = useState(false);\n\n  // 生成直後にURLを表示する用\n  const [latestResult, setLatestResult] = useState<{\n    report_history_id: string;\n    report_url: string | null;\n    file_path: string | null;\n  } | null>(null);\n\n  // 履歴（直近）\n  const [history, setHistory] = useState<ReportHistoryRow[]>([]);\n  const [loadingHistory, setLoadingHistory] = useState(false);\n\n  useEffect(() => {\n    if (!organizationId) return;\n    fetchTemplates();\n    fetchTeams();\n    fetchHistory();\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [organizationId]);\n\n  useEffect(() => {\n    // reportType が変わったら矛盾しやすい選択をリセット\n    setSelectedTemplate((prev) => (prev && prev.report_type === reportType ? prev : null));\n\n    if (reportType === 'organization') {\n      setSelectedTeam('');\n      setSelectedAthlete('');\n      setAthletes([]);\n    } else if (reportType === 'team') {\n      setSelectedAthlete('');\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [reportType]);\n\n  useEffect(() => {\n    if (!selectedTeam) {\n      setAthletes([]);\n      setSelectedAthlete('');\n      return;\n    }\n    fetchAthletes(selectedTeam);\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [selectedTeam]);\n\n  const fetchTemplates = async () => {\n    try {\n      const { data, error } = await supabase\n        .from('report_templates')\n        .select('*')\n        .eq('organization_id', organizationId)\n        .order('name');\n\n      if (error) throw error;\n      setTemplates((data || []) as ReportTemplate[]);\n    } catch (e) {\n      console.error('[AdvancedReportGenerator] fetchTemplates failed:', e);\n      setTemplates([]);\n    }\n  };\n\n  const fetchTeams = async () => {\n    try {\n      setLoadingTeams(true);\n      const { data, error } = await supabase\n        .from('teams')\n        .select('id, name')\n        .eq('organization_id', organizationId)\n        .order('name');\n\n      if (error) throw error;\n      setTeams((data || []) as TeamRow[]);\n    } catch (e) {\n      console.error('[AdvancedReportGenerator] fetchTeams failed:', e);\n      setTeams([]);\n    } finally {\n      setLoadingTeams(false);\n    }\n  };\n\n  const fetchAthletes = async (teamId: string) => {\n    try {\n      setLoadingAthletes(true);\n      setAthletes([]);\n      setSelectedAthlete('');\n\n      const { data, error } = await supabase\n        .from('team_member_assignments')\n        .select('user_id, users!inner(id, name)')\n        .eq('team_id', teamId);\n\n      if (error) throw error;\n\n      const athleteList =\n        data?.map((m: any) => ({\n          id: m.user_id as string,\n          name: (m.users as any)?.name || 'unknown',\n        })) || [];\n\n      athleteList.sort((a, b) => a.name.localeCompare(b.name, 'ja'));\n      setAthletes(athleteList);\n    } catch (e) {\n      console.error('[AdvancedReportGenerator] fetchAthletes failed:', e);\n      setAthletes([]);\n    } finally {\n      setLoadingAthletes(false);\n    }\n  };\n\n  const fetchHistory = async () => {\n    try {\n      setLoadingHistory(true);\n      const { data, error } = await supabase\n        .from('report_history')\n        .select(\n          'id, report_type, status, created_at, started_at, completed_at, file_path, report_url, error_message, parameters'\n        )\n        .eq('organization_id', organizationId)\n        .order('created_at', { ascending: false })\n        .limit(20);\n\n      if (error) throw error;\n      setHistory((data || []) as ReportHistoryRow[]);\n    } catch (e) {\n      console.error('[AdvancedReportGenerator] fetchHistory failed:', e);\n      setHistory([]);\n    } finally {\n      setLoadingHistory(false);\n    }\n  };\n\n  const dateError = useMemo(() => {\n    if (!dateRange.start || !dateRange.end) return null;\n    if (dateRange.start > dateRange.end) return '開始日が終了日より後になっています';\n    return null;\n  }, [dateRange.start, dateRange.end]);\n\n  const validationError = useMemo(() => {\n    if (!dateRange.start || !dateRange.end) return '期間（開始日・終了日）を入力してください';\n    if (dateError) return dateError;\n\n    if (reportType === 'team' && !selectedTeam) return 'チームを選択してください';\n    if (reportType === 'individual') {\n      if (!selectedTeam) return 'チームを選択してください';\n      if (!selectedAthlete) return 'アスリートを選択してください';\n    }\n\n    const anyMetricOn = Object.values(includeMetrics).some(Boolean);\n    if (!anyMetricOn) return '含める指標を1つ以上選択してください';\n\n    return null;\n  }, [dateRange.start, dateRange.end, dateError, reportType, selectedTeam, selectedAthlete, includeMetrics]);\n\n  const canGenerate = !generating && !validationError;\n\n  const generateReport = async () => {\n    if (validationError) {\n      window.alert(validationError);\n      return;\n    }\n\n    setGenerating(true);\n    setLatestResult(null);\n\n    try {\n      // 1) report_history を作成（id取得）\n      const parameters = {\n        report_type: reportType,\n        date_range: dateRange,\n        team_id: reportType === 'organization' ? null : selectedTeam,\n        athlete_id: reportType === 'individual' ? selectedAthlete : null,\n        metrics: includeMetrics,\n      };\n\n      const { data: created, error: insertErr } = await supabase\n        .from('report_history')\n        .insert({\n          organization_id: organizationId,\n          template_id: selectedTemplate?.id || null,\n          report_type: reportType,\n          generated_by: userId,\n          parameters,\n          status: 'pending',\n        })\n        .select('id')\n        .single();\n\n      if (insertErr) throw insertErr;\n      const reportHistoryId = created?.id as string;\n      if (!reportHistoryId) throw new Error('Failed to create report_history');\n\n      // 2) Edge Function を呼ぶ（ここで生成が走って report_url が返る想定）\n      // supabase-js の invoke はログイン済みなら Authorization を自動で付けます\n      const { data: fnData, error: fnErr } = await supabase.functions.invoke('generate_report', {\n        body: { report_history_id: reportHistoryId },\n      });\n\n      if (fnErr) {\n        console.error('[AdvancedReportGenerator] invoke error:', fnErr);\n        throw fnErr;\n      }\n\n      // 3) 返ってきたURLを表示（＆履歴再取得）\n      const result = {\n        report_history_id: reportHistoryId,\n        report_url: fnData?.report_url ?? null,\n        file_path: fnData?.file_path ?? null,\n      };\n      setLatestResult(result);\n\n      await fetchHistory();\n\n      if (result.report_url) {\n        window.alert('レポート生成が完了しました。ダウンロードできます。');\n      } else {\n        window.alert('生成は完了しましたが、URLがまだありません（Storage設定を確認してください）');\n      }\n    } catch (e: any) {\n      console.error('[AdvancedReportGenerator] generateReport failed:', e);\n      window.alert(`レポート生成に失敗しました：${e?.message ?? e}`);\n      await fetchHistory();\n    } finally {\n      setGenerating(false);\n    }\n  };\n\n  const openReport = (url: string) => {\n    window.open(url, '_blank', 'noopener,noreferrer');\n  };\n\n  const getIcon = (type: string) => {\n    switch (type) {\n      case 'individual':\n        return <User className=\"w-5 h-5\" />;\n      case 'team':\n        return <Users className=\"w-5 h-5\" />;\n      case 'organization':\n        return <Building2 className=\"w-5 h-5\" />;\n      default:\n        return <FileText className=\"w-5 h-5\" />;\n    }\n  };\n\n  const metricLabel: Record<string, string> = {\n    acwr: 'ACWR',\n    training_load: 'トレーニング負荷',\n    performance: 'パフォーマンス',\n    injury_risk: '傷害リスク',\n    attendance: '出欠/稼働',\n    trends: 'トレンド',\n  };\n\n  const statusBadge = (s: ReportHistoryRow['status']) => {\n    const base = 'px-2 py-1 text-xs rounded-full';\n    if (s === 'completed') return `${base} bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-300`;\n    if (s === 'failed') return `${base} bg-red-100 text-red-700 dark:bg-red-900/30 dark:text-red-300`;\n    return `${base} bg-gray-100 text-gray-700 dark:bg-gray-700 dark:text-gray-200`;\n  };\n\n  return (\n    <div className=\"bg-white dark:bg-gray-800 p-6 rounded-lg shadow space-y-6\">\n      <div className=\"flex items-center gap-2\">\n        <FileText className=\"w-6 h-6 text-blue-600 dark:text-blue-400\" />\n        <h3 className=\"text-xl font-semibold text-gray-900 dark:text-white\">高度なレポート生成</h3>\n      </div>\n\n      {/* ====== Generator ====== */}\n      <div className=\"space-y-6\">\n        {/* Report Type */}\n        <div>\n          <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\n            レポートタイプ\n          </label>\n          <div className=\"grid grid-cols-3 gap-3\">\n            {(['individual', 'team', 'organization'] as const).map((type) => (\n              <button\n                key={type}\n                type=\"button\"\n                onClick={() => setReportType(type)}\n                className={`p-4 border-2 rounded-lg flex flex-col items-center gap-2 transition-colors ${\n                  reportType === type\n                    ? 'border-blue-500 bg-blue-50 dark:bg-blue-900/20'\n                    : 'border-gray-300 dark:border-gray-600 hover:border-blue-300 dark:hover:border-blue-700'\n                }`}\n              >\n                {getIcon(type)}\n                <span className=\"text-sm font-medium text-gray-900 dark:text-white\">\n                  {type === 'individual' ? '個人' : type === 'team' ? 'チーム' : '組織'}\n                </span>\n              </button>\n            ))}\n          </div>\n        </div>\n\n        {/* Template */}\n        {templates.length > 0 && (\n          <div>\n            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\n              テンプレート（任意）\n            </label>\n            <select\n              value={selectedTemplate?.id || ''}\n              onChange={(e) => {\n                const template = templates.find((t) => t.id === e.target.value);\n                setSelectedTemplate(template || null);\n                if (template) setReportType(template.report_type);\n              }}\n              className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:text-white\"\n            >\n              <option value=\"\">カスタムレポート</option>\n              {templates.map((template) => (\n                <option key={template.id} value={template.id}>\n                  {template.name}\n                </option>\n              ))}\n            </select>\n          </div>\n        )}\n\n        {/* Date Range */}\n        <div>\n          <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\n            <Calendar className=\"inline w-4 h-4 mr-1\" />\n            期間\n          </label>\n          <div className=\"grid grid-cols-2 gap-4\">\n            <div>\n              <label className=\"block text-xs text-gray-600 dark:text-gray-400 mb-1\">開始日</label>\n              <input\n                type=\"date\"\n                value={dateRange.start}\n                onChange={(e) => setDateRange({ ...dateRange, start: e.target.value })}\n                className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:text-white\"\n              />\n            </div>\n            <div>\n              <label className=\"block text-xs text-gray-600 dark:text-gray-400 mb-1\">終了日</label>\n              <input\n                type=\"date\"\n                value={dateRange.end}\n                onChange={(e) => setDateRange({ ...dateRange, end: e.target.value })}\n                className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:text-white\"\n              />\n            </div>\n          </div>\n          {dateError && <div className=\"mt-2 text-sm text-red-600 dark:text-red-400\">{dateError}</div>}\n        </div>\n\n        {/* Team */}\n        {(reportType === 'team' || reportType === 'individual') && (\n          <div>\n            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">チーム</label>\n            <select\n              value={selectedTeam}\n              onChange={(e) => setSelectedTeam(e.target.value)}\n              className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:text-white\"\n              disabled={loadingTeams}\n            >\n              <option value=\"\">{loadingTeams ? '読み込み中…' : 'チームを選択'}</option>\n              {teams.map((team) => (\n                <option key={team.id} value={team.id}>\n                  {team.name}\n                </option>\n              ))}\n            </select>\n          </div>\n        )}\n\n        {/* Athlete */}\n        {reportType === 'individual' && selectedTeam && (\n          <div>\n            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\n              アスリート\n            </label>\n            <select\n              value={selectedAthlete}\n              onChange={(e) => setSelectedAthlete(e.target.value)}\n              className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:text-white\"\n              disabled={loadingAthletes}\n            >\n              <option value=\"\">{loadingAthletes ? '読み込み中…' : 'アスリートを選択'}</option>\n              {athletes.map((athlete) => (\n                <option key={athlete.id} value={athlete.id}>\n                  {athlete.name}\n                </option>\n              ))}\n            </select>\n          </div>\n        )}\n\n        {/* Metrics */}\n        <div>\n          <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\n            <Filter className=\"inline w-4 h-4 mr-1\" />\n            含める指標\n          </label>\n          <div className=\"grid grid-cols-2 gap-3\">\n            {Object.entries(includeMetrics).map(([key, value]) => (\n              <label key={key} className=\"flex items-center gap-2 cursor-pointer\">\n                <input\n                  type=\"checkbox\"\n                  checked={value}\n                  onChange={(e) => setIncludeMetrics({ ...includeMetrics, [key]: e.target.checked })}\n                  className=\"w-4 h-4 text-blue-600 rounded focus:ring-blue-500\"\n                />\n                <span className=\"text-sm text-gray-700 dark:text-gray-300\">\n                  {metricLabel[key] ?? key.replace(/_/g, ' ')}\n                </span>\n              </label>\n            ))}\n          </div>\n        </div>\n\n        {/* Generate Button */}\n        <button\n          type=\"button\"\n          onClick={generateReport}\n          disabled={!canGenerate}\n          className=\"w-full py-3 bg-blue-600 hover:bg-blue-700 text-white font-medium rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2\"\n        >\n          <Download className=\"w-5 h-5\" />\n          {generating ? '生成中...' : 'レポートを生成'}\n        </button>\n\n        {validationError && (\n          <div className=\"text-sm text-gray-600 dark:text-gray-300\">※ {validationError}</div>\n        )}\n\n        {/* Latest Result */}\n        {latestResult && (\n          <div className=\"p-4 rounded-lg bg-blue-50 dark:bg-blue-900/20 border border-blue-100 dark:border-blue-800\">\n            <div className=\"text-sm text-gray-700 dark:text-gray-200\">\n              <div className=\"font-semibold mb-1\">最新の生成結果</div>\n              <div className=\"break-all\">report_history_id: {latestResult.report_history_id}</div>\n              {latestResult.file_path && <div className=\"break-all\">file_path: {latestResult.file_path}</div>}\n            </div>\n\n            <div className=\"mt-3 flex flex-wrap gap-2\">\n              {latestResult.report_url ? (\n                <>\n                  <button\n                    type=\"button\"\n                    onClick={() => openReport(latestResult.report_url!)}\n                    className=\"px-3 py-2 rounded bg-blue-600 hover:bg-blue-700 text-white text-sm flex items-center gap-2\"\n                  >\n                    <ExternalLink className=\"w-4 h-4\" />\n                    レポートを開く\n                  </button>\n                  <a\n                    href={latestResult.report_url}\n                    className=\"px-3 py-2 rounded bg-gray-900 hover:bg-black text-white text-sm flex items-center gap-2\"\n                    target=\"_blank\"\n                    rel=\"noreferrer\"\n                  >\n                    <Download className=\"w-4 h-4\" />\n                    ダウンロード\n                  </a>\n                </>\n              ) : (\n                <div className=\"text-sm text-orange-700 dark:text-orange-300\">\n                  report_url がまだありません（Storage/署名URL生成を確認）\n                </div>\n              )}\n            </div>\n          </div>\n        )}\n      </div>\n\n      {/* ====== History ====== */}\n      <div className=\"border-t border-gray-200 dark:border-gray-700 pt-6\">\n        <div className=\"flex items-center justify-between mb-3\">\n          <h4 className=\"font-semibold text-gray-900 dark:text-white\">レポート履歴（最新20件）</h4>\n          <button\n            type=\"button\"\n            onClick={fetchHistory}\n            disabled={loadingHistory}\n            className=\"px-3 py-2 rounded bg-gray-200 dark:bg-gray-700 text-gray-800 dark:text-gray-100 text-sm flex items-center gap-2 disabled:opacity-50\"\n          >\n            <RefreshCcw className=\"w-4 h-4\" />\n            更新\n          </button>\n        </div>\n\n        {loadingHistory ? (\n          <div className=\"text-sm text-gray-600 dark:text-gray-300\">読み込み中…</div>\n        ) : history.length === 0 ? (\n          <div className=\"text-sm text-gray-600 dark:text-gray-300\">履歴がありません。</div>\n        ) : (\n          <div className=\"space-y-3\">\n            {history.map((h) => (\n              <div\n                key={h.id}\n                className=\"p-4 rounded-lg bg-gray-50 dark:bg-gray-700/40 border border-gray-200 dark:border-gray-700\"\n              >\n                <div className=\"flex items-center justify-between gap-3\">\n                  <div className=\"min-w-0\">\n                    <div className=\"flex items-center gap-2\">\n                      <span className={statusBadge(h.status)}>{h.status}</span>\n                      <span className=\"text-sm text-gray-800 dark:text-gray-100\">\n                        {h.report_type.toUpperCase()}\n                      </span>\n                    </div>\n                    <div className=\"text-xs text-gray-600 dark:text-gray-300 mt-1 break-all\">\n                      id: {h.id}\n                    </div>\n                  </div>\n\n                  <div className=\"flex items-center gap-2\">\n                    {h.report_url ? (\n                      <button\n                        type=\"button\"\n                        onClick={() => openReport(h.report_url!)}\n                        className=\"px-3 py-2 rounded bg-blue-600 hover:bg-blue-700 text-white text-sm flex items-center gap-2\"\n                      >\n                        <Download className=\"w-4 h-4\" />\n                        開く\n                      </button>\n                    ) : (\n                      <button\n                        type=\"button\"\n                        disabled\n                        className=\"px-3 py-2 rounded bg-gray-300 dark:bg-gray-600 text-gray-700 dark:text-gray-200 text-sm flex items-center gap-2 opacity-60 cursor-not-allowed\"\n                      >\n                        <Download className=\"w-4 h-4\" />\n                        なし\n                      </button>\n                    )}\n                  </div>\n                </div>\n\n                {h.error_message && (\n                  <div className=\"mt-2 text-sm text-red-600 dark:text-red-300\">\n                    {h.error_message}\n                  </div>\n                )}\n\n                <div className=\"mt-2 text-xs text-gray-600 dark:text-gray-300 grid grid-cols-1 md:grid-cols-2 gap-2\">\n                  <div>created: {h.created_at}</div>\n                  <div>completed: {h.completed_at ?? '-'}</div>\n                  <div className=\"break-all\">file_path: {h.file_path ?? '-'}</div>\n                </div>\n              </div>\n            ))}\n          </div>\n        )}\n      </div>\n    </div>\n  );\n}","import React, { useState, useEffect } from 'react';\nimport { FileText, Download, Clock, CheckCircle, XCircle, Trash2, RefreshCw } from 'lucide-react';\nimport { supabase } from '../lib/supabase';\n\ninterface ReportHistoryManagementProps {\n  organizationId: string;\n  userId: string;\n}\n\ninterface ReportHistoryItem {\n  id: string;\n  report_type: string;\n  parameters: Record<string, any>;\n  status: 'pending' | 'completed' | 'failed';\n  error_message: string | null;\n  created_at: string;\n  generated_by: string;\n  users?: { name: string };\n}\n\nexport function ReportHistoryManagement({ organizationId, userId }: ReportHistoryManagementProps) {\n  const [reports, setReports] = useState<ReportHistoryItem[]>([]);\n  const [loading, setLoading] = useState(true);\n  const [filter, setFilter] = useState<'all' | 'completed' | 'pending' | 'failed'>('all');\n\n  useEffect(() => {\n    fetchReports();\n  }, [organizationId, filter]);\n\n  const fetchReports = async () => {\n    try {\n      setLoading(true);\n\n      let query = supabase\n        .from('report_history')\n        .select(`\n          *,\n          users!report_history_generated_by_fkey(name)\n        `)\n        .eq('organization_id', organizationId)\n        .order('created_at', { ascending: false })\n        .limit(50);\n\n      if (filter !== 'all') {\n        query = query.eq('status', filter);\n      }\n\n      const { data, error } = await query;\n\n      if (error) throw error;\n      setReports(data || []);\n    } catch (error) {\n      console.error('Error fetching reports:', error);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const deleteReport = async (id: string) => {\n    if (!confirm('このレポートを削除しますか？')) return;\n\n    try {\n      const { error } = await supabase\n        .from('report_history')\n        .delete()\n        .eq('id', id);\n\n      if (error) throw error;\n      setReports(reports.filter((r) => r.id !== id));\n    } catch (error) {\n      console.error('Error deleting report:', error);\n      alert('レポートの削除に失敗しました');\n    }\n  };\n\n  const getStatusIcon = (status: string) => {\n    switch (status) {\n      case 'completed':\n        return <CheckCircle className=\"w-5 h-5 text-green-600 dark:text-green-400\" />;\n      case 'failed':\n        return <XCircle className=\"w-5 h-5 text-red-600 dark:text-red-400\" />;\n      default:\n        return <Clock className=\"w-5 h-5 text-yellow-600 dark:text-yellow-400\" />;\n    }\n  };\n\n  const getStatusBg = (status: string) => {\n    switch (status) {\n      case 'completed':\n        return 'bg-green-50 dark:bg-green-900/20';\n      case 'failed':\n        return 'bg-red-50 dark:bg-red-900/20';\n      default:\n        return 'bg-yellow-50 dark:bg-yellow-900/20';\n    }\n  };\n\n  const getStatusText = (status: string) => {\n    switch (status) {\n      case 'completed':\n        return '完了';\n      case 'failed':\n        return '失敗';\n      default:\n        return '処理中';\n    }\n  };\n\n  const formatDate = (dateStr: string) => {\n    const date = new Date(dateStr);\n    return date.toLocaleString('ja-JP', {\n      year: 'numeric',\n      month: 'short',\n      day: 'numeric',\n      hour: '2-digit',\n      minute: '2-digit',\n    });\n  };\n\n  const getReportTypeName = (type: string) => {\n    switch (type) {\n      case 'individual':\n        return '個人レポート';\n      case 'team':\n        return 'チームレポート';\n      case 'organization':\n        return '組織レポート';\n      default:\n        return 'レポート';\n    }\n  };\n\n  if (loading) {\n    return (\n      <div className=\"flex items-center justify-center h-64\">\n        <div className=\"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600\"></div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"bg-white dark:bg-gray-800 p-6 rounded-lg shadow\">\n      <div className=\"flex items-center justify-between mb-6\">\n        <div className=\"flex items-center gap-2\">\n          <FileText className=\"w-6 h-6 text-purple-600 dark:text-purple-400\" />\n          <h3 className=\"text-xl font-semibold text-gray-900 dark:text-white\">\n            レポート履歴\n          </h3>\n        </div>\n        <button\n          onClick={fetchReports}\n          className=\"p-2 text-gray-600 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors\"\n          title=\"更新\"\n        >\n          <RefreshCw className=\"w-5 h-5\" />\n        </button>\n      </div>\n\n      {/* Filter Buttons */}\n      <div className=\"flex gap-2 mb-6\">\n        {(['all', 'completed', 'pending', 'failed'] as const).map((status) => (\n          <button\n            key={status}\n            onClick={() => setFilter(status)}\n            className={`px-4 py-2 text-sm rounded-lg transition-colors ${\n              filter === status\n                ? 'bg-purple-600 text-white'\n                : 'bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300 hover:bg-gray-300 dark:hover:bg-gray-600'\n            }`}\n          >\n            {status === 'all' ? 'すべて' : getStatusText(status)}\n          </button>\n        ))}\n      </div>\n\n      {/* Reports List */}\n      {reports.length === 0 ? (\n        <div className=\"text-center py-12 text-gray-500 dark:text-gray-400\">\n          <FileText className=\"w-12 h-12 mx-auto mb-3 opacity-50\" />\n          <p>レポート履歴がありません</p>\n        </div>\n      ) : (\n        <div className=\"space-y-3\">\n          {reports.map((report) => (\n            <div\n              key={report.id}\n              className={`p-4 rounded-lg border-2 ${getStatusBg(report.status)} border-gray-200 dark:border-gray-700`}\n            >\n              <div className=\"flex items-start justify-between\">\n                <div className=\"flex-1\">\n                  <div className=\"flex items-center gap-3 mb-2\">\n                    {getStatusIcon(report.status)}\n                    <h4 className=\"font-semibold text-gray-900 dark:text-white\">\n                      {getReportTypeName(report.report_type)}\n                    </h4>\n                    <span className=\"text-sm text-gray-600 dark:text-gray-400\">\n                      {formatDate(report.created_at)}\n                    </span>\n                  </div>\n\n                  <div className=\"grid grid-cols-2 gap-2 text-sm text-gray-600 dark:text-gray-400 mb-2\">\n                    <div>\n                      <span className=\"font-medium\">生成者: </span>\n                      {report.users?.name || 'Unknown'}\n                    </div>\n                    <div>\n                      <span className=\"font-medium\">ステータス: </span>\n                      {getStatusText(report.status)}\n                    </div>\n                  </div>\n\n                  {report.parameters && Object.keys(report.parameters).length > 0 && (\n                    <div className=\"text-sm text-gray-600 dark:text-gray-400\">\n                      <span className=\"font-medium\">パラメータ: </span>\n                      {report.parameters.date_range && (\n                        <span>\n                          {report.parameters.date_range.start} ~ {report.parameters.date_range.end}\n                        </span>\n                      )}\n                    </div>\n                  )}\n\n                  {report.error_message && (\n                    <div className=\"mt-2 p-2 bg-red-100 dark:bg-red-900/30 rounded text-sm text-red-800 dark:text-red-200\">\n                      エラー: {report.error_message}\n                    </div>\n                  )}\n                </div>\n\n                <div className=\"flex gap-2 ml-4\">\n                  {report.status === 'completed' && (\n                    <button\n                      onClick={() => alert('ダウンロード機能は実装予定です')}\n                      className=\"p-2 text-blue-600 dark:text-blue-400 hover:bg-blue-100 dark:hover:bg-blue-900/20 rounded-lg transition-colors\"\n                      title=\"ダウンロード\"\n                    >\n                      <Download className=\"w-5 h-5\" />\n                    </button>\n                  )}\n                  <button\n                    onClick={() => deleteReport(report.id)}\n                    className=\"p-2 text-red-600 dark:text-red-400 hover:bg-red-100 dark:hover:bg-red-900/20 rounded-lg transition-colors\"\n                    title=\"削除\"\n                  >\n                    <Trash2 className=\"w-5 h-5\" />\n                  </button>\n                </div>\n              </div>\n            </div>\n          ))}\n        </div>\n      )}\n    </div>\n  );\n}\n","import React, { useState, useEffect } from 'react';\nimport { Calendar, Clock, Mail, Plus, Edit2, Trash2, Power, PowerOff } from 'lucide-react';\nimport { supabase } from '../lib/supabase';\n\ninterface ScheduledReportManagementProps {\n  organizationId: string;\n  userId: string;\n}\n\ninterface ScheduledReport {\n  id: string;\n  name: string;\n  schedule_type: 'daily' | 'weekly' | 'monthly';\n  schedule_config: Record<string, any>;\n  recipients: string[];\n  is_active: boolean;\n  next_run: string | null;\n  template_id: string;\n}\n\nexport function ScheduledReportManagement({ organizationId, userId }: ScheduledReportManagementProps) {\n  const [scheduledReports, setScheduledReports] = useState<ScheduledReport[]>([]);\n  const [showForm, setShowForm] = useState(false);\n  const [editingReport, setEditingReport] = useState<ScheduledReport | null>(null);\n  const [loading, setLoading] = useState(true);\n\n  const [formData, setFormData] = useState({\n    name: '',\n    schedule_type: 'weekly' as 'daily' | 'weekly' | 'monthly',\n    day_of_week: '1',\n    day_of_month: '1',\n    time: '09:00',\n    recipients: '',\n  });\n\n  useEffect(() => {\n    fetchScheduledReports();\n  }, [organizationId]);\n\n  const fetchScheduledReports = async () => {\n    try {\n      setLoading(true);\n      const { data, error } = await supabase\n        .from('scheduled_reports')\n        .select('*')\n        .eq('organization_id', organizationId)\n        .order('name');\n\n      if (error) throw error;\n      setScheduledReports(data || []);\n    } catch (error) {\n      console.error('Error fetching scheduled reports:', error);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n\n    try {\n      const scheduleConfig: Record<string, any> = {\n        time: formData.time,\n      };\n\n      if (formData.schedule_type === 'weekly') {\n        scheduleConfig.day_of_week = parseInt(formData.day_of_week);\n      } else if (formData.schedule_type === 'monthly') {\n        scheduleConfig.day_of_month = parseInt(formData.day_of_month);\n      }\n\n      const recipients = formData.recipients\n        .split(',')\n        .map((email) => email.trim())\n        .filter((email) => email);\n\n      const { data: nextRunData } = await supabase.rpc('calculate_next_run', {\n        p_schedule_type: formData.schedule_type,\n        p_schedule_config: scheduleConfig,\n      });\n\n      const reportData = {\n        organization_id: organizationId,\n        template_id: organizationId,\n        name: formData.name,\n        schedule_type: formData.schedule_type,\n        schedule_config: scheduleConfig,\n        recipients,\n        next_run: nextRunData,\n        created_by: userId,\n      };\n\n      if (editingReport) {\n        const { error } = await supabase\n          .from('scheduled_reports')\n          .update(reportData)\n          .eq('id', editingReport.id);\n\n        if (error) throw error;\n      } else {\n        const { error } = await supabase\n          .from('scheduled_reports')\n          .insert(reportData);\n\n        if (error) throw error;\n      }\n\n      setShowForm(false);\n      setEditingReport(null);\n      setFormData({\n        name: '',\n        schedule_type: 'weekly',\n        day_of_week: '1',\n        day_of_month: '1',\n        time: '09:00',\n        recipients: '',\n      });\n      fetchScheduledReports();\n    } catch (error) {\n      console.error('Error saving scheduled report:', error);\n      alert('スケジュールの保存に失敗しました');\n    }\n  };\n\n  const toggleActive = async (report: ScheduledReport) => {\n    try {\n      const { error } = await supabase\n        .from('scheduled_reports')\n        .update({ is_active: !report.is_active })\n        .eq('id', report.id);\n\n      if (error) throw error;\n      fetchScheduledReports();\n    } catch (error) {\n      console.error('Error toggling report:', error);\n    }\n  };\n\n  const deleteReport = async (id: string) => {\n    if (!confirm('このスケジュールを削除しますか？')) return;\n\n    try {\n      const { error } = await supabase\n        .from('scheduled_reports')\n        .delete()\n        .eq('id', id);\n\n      if (error) throw error;\n      fetchScheduledReports();\n    } catch (error) {\n      console.error('Error deleting report:', error);\n      alert('削除に失敗しました');\n    }\n  };\n\n  const getScheduleText = (report: ScheduledReport) => {\n    const config = report.schedule_config;\n    const time = config.time || '09:00';\n\n    switch (report.schedule_type) {\n      case 'daily':\n        return `毎日 ${time}`;\n      case 'weekly':\n        const days = ['日', '月', '火', '水', '木', '金', '土'];\n        const dayOfWeek = config.day_of_week || 1;\n        return `毎週${days[dayOfWeek]}曜日 ${time}`;\n      case 'monthly':\n        const dayOfMonth = config.day_of_month || 1;\n        return `毎月${dayOfMonth}日 ${time}`;\n      default:\n        return '不明';\n    }\n  };\n\n  if (loading) {\n    return (\n      <div className=\"flex items-center justify-center h-64\">\n        <div className=\"animate-spin rounded-full h-12 w-12 border-b-2 border-green-600\"></div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"bg-white dark:bg-gray-800 p-6 rounded-lg shadow\">\n      <div className=\"flex items-center justify-between mb-6\">\n        <div className=\"flex items-center gap-2\">\n          <Calendar className=\"w-6 h-6 text-green-600 dark:text-green-400\" />\n          <h3 className=\"text-xl font-semibold text-gray-900 dark:text-white\">\n            スケジュールレポート\n          </h3>\n        </div>\n        <button\n          onClick={() => setShowForm(true)}\n          className=\"flex items-center gap-2 px-4 py-2 bg-green-600 hover:bg-green-700 text-white rounded-lg transition-colors\"\n        >\n          <Plus className=\"w-5 h-5\" />\n          新規作成\n        </button>\n      </div>\n\n      {showForm && (\n        <form onSubmit={handleSubmit} className=\"mb-6 p-4 bg-gray-50 dark:bg-gray-700 rounded-lg\">\n          <h4 className=\"font-semibold text-gray-900 dark:text-white mb-4\">\n            {editingReport ? 'スケジュール編集' : '新規スケジュール'}\n          </h4>\n\n          <div className=\"space-y-4\">\n            <div>\n              <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                スケジュール名\n              </label>\n              <input\n                type=\"text\"\n                required\n                value={formData.name}\n                onChange={(e) => setFormData({ ...formData, name: e.target.value })}\n                className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-green-500 dark:bg-gray-800 dark:text-white\"\n              />\n            </div>\n\n            <div>\n              <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                頻度\n              </label>\n              <select\n                value={formData.schedule_type}\n                onChange={(e) =>\n                  setFormData({ ...formData, schedule_type: e.target.value as any })\n                }\n                className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-green-500 dark:bg-gray-800 dark:text-white\"\n              >\n                <option value=\"daily\">毎日</option>\n                <option value=\"weekly\">毎週</option>\n                <option value=\"monthly\">毎月</option>\n              </select>\n            </div>\n\n            {formData.schedule_type === 'weekly' && (\n              <div>\n                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                  曜日\n                </label>\n                <select\n                  value={formData.day_of_week}\n                  onChange={(e) => setFormData({ ...formData, day_of_week: e.target.value })}\n                  className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-green-500 dark:bg-gray-800 dark:text-white\"\n                >\n                  <option value=\"0\">日曜日</option>\n                  <option value=\"1\">月曜日</option>\n                  <option value=\"2\">火曜日</option>\n                  <option value=\"3\">水曜日</option>\n                  <option value=\"4\">木曜日</option>\n                  <option value=\"5\">金曜日</option>\n                  <option value=\"6\">土曜日</option>\n                </select>\n              </div>\n            )}\n\n            {formData.schedule_type === 'monthly' && (\n              <div>\n                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                  日付\n                </label>\n                <input\n                  type=\"number\"\n                  min=\"1\"\n                  max=\"31\"\n                  value={formData.day_of_month}\n                  onChange={(e) => setFormData({ ...formData, day_of_month: e.target.value })}\n                  className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-green-500 dark:bg-gray-800 dark:text-white\"\n                />\n              </div>\n            )}\n\n            <div>\n              <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                時刻\n              </label>\n              <input\n                type=\"time\"\n                value={formData.time}\n                onChange={(e) => setFormData({ ...formData, time: e.target.value })}\n                className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-green-500 dark:bg-gray-800 dark:text-white\"\n              />\n            </div>\n\n            <div>\n              <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                送信先メールアドレス（カンマ区切り）\n              </label>\n              <input\n                type=\"text\"\n                required\n                value={formData.recipients}\n                onChange={(e) => setFormData({ ...formData, recipients: e.target.value })}\n                placeholder=\"user1@example.com, user2@example.com\"\n                className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-green-500 dark:bg-gray-800 dark:text-white\"\n              />\n            </div>\n\n            <div className=\"flex gap-2\">\n              <button\n                type=\"submit\"\n                className=\"flex-1 py-2 bg-green-600 hover:bg-green-700 text-white rounded-lg transition-colors\"\n              >\n                保存\n              </button>\n              <button\n                type=\"button\"\n                onClick={() => {\n                  setShowForm(false);\n                  setEditingReport(null);\n                }}\n                className=\"flex-1 py-2 bg-gray-300 dark:bg-gray-600 hover:bg-gray-400 dark:hover:bg-gray-500 text-gray-700 dark:text-white rounded-lg transition-colors\"\n              >\n                キャンセル\n              </button>\n            </div>\n          </div>\n        </form>\n      )}\n\n      {scheduledReports.length === 0 ? (\n        <div className=\"text-center py-12 text-gray-500 dark:text-gray-400\">\n          <Calendar className=\"w-12 h-12 mx-auto mb-3 opacity-50\" />\n          <p>スケジュールされたレポートがありません</p>\n        </div>\n      ) : (\n        <div className=\"space-y-3\">\n          {scheduledReports.map((report) => (\n            <div\n              key={report.id}\n              className=\"p-4 bg-gray-50 dark:bg-gray-700 rounded-lg flex items-center justify-between\"\n            >\n              <div className=\"flex-1\">\n                <h4 className=\"font-semibold text-gray-900 dark:text-white mb-2\">\n                  {report.name}\n                </h4>\n                <div className=\"flex items-center gap-4 text-sm text-gray-600 dark:text-gray-400\">\n                  <div className=\"flex items-center gap-1\">\n                    <Clock className=\"w-4 h-4\" />\n                    {getScheduleText(report)}\n                  </div>\n                  <div className=\"flex items-center gap-1\">\n                    <Mail className=\"w-4 h-4\" />\n                    {report.recipients.length} 人\n                  </div>\n                </div>\n              </div>\n\n              <div className=\"flex items-center gap-2\">\n                <button\n                  onClick={() => toggleActive(report)}\n                  className={`p-2 rounded-lg transition-colors ${\n                    report.is_active\n                      ? 'text-green-600 dark:text-green-400 hover:bg-green-100 dark:hover:bg-green-900/20'\n                      : 'text-gray-400 dark:text-gray-600 hover:bg-gray-200 dark:hover:bg-gray-600'\n                  }`}\n                  title={report.is_active ? '無効化' : '有効化'}\n                >\n                  {report.is_active ? (\n                    <Power className=\"w-5 h-5\" />\n                  ) : (\n                    <PowerOff className=\"w-5 h-5\" />\n                  )}\n                </button>\n                <button\n                  onClick={() => deleteReport(report.id)}\n                  className=\"p-2 text-red-600 dark:text-red-400 hover:bg-red-100 dark:hover:bg-red-900/20 rounded-lg transition-colors\"\n                  title=\"削除\"\n                >\n                  <Trash2 className=\"w-5 h-5\" />\n                </button>\n              </div>\n            </div>\n          ))}\n        </div>\n      )}\n    </div>\n  );\n}\n","import React, { useState } from 'react';\nimport { Team } from '../lib/supabase';\nimport { useReports } from '../hooks/useReports';\nimport { useAuth } from '../hooks/useAuth';\nimport { useOrganizations } from '../hooks/useOrganizations';\nimport { ReportPeriod, getPeriodLabel } from '../lib/reportGeneration';\nimport {\n  FileText,\n  Calendar,\n  TrendingUp,\n  AlertTriangle,\n  Users,\n  Download,\n  Eye,\n  Trash2,\n  Plus,\n  RefreshCw,\n  BarChart3,\n  Clock\n} from 'lucide-react';\nimport { AdvancedReportGenerator } from './AdvancedReportGenerator';\nimport { ReportHistoryManagement } from './ReportHistoryManagement';\nimport { ScheduledReportManagement } from './ScheduledReportManagement';\n\ninterface ReportViewProps {\n  team: Team;\n}\n\nexport function ReportView({ team }: ReportViewProps) {\n  const { user } = useAuth();\n  const { organizations } = useOrganizations(user?.id || '');\n  const organizationId = team.organization_id || (organizations.length > 0 ? organizations[0].id : '');\n\n  const { reports, loading, generateReport, markReportAsViewed, deleteReport, refreshReports } = useReports(team.id);\n  const [generating, setGenerating] = useState(false);\n  const [showGeneratePanel, setShowGeneratePanel] = useState(false);\n  const [selectedPeriod, setSelectedPeriod] = useState<ReportPeriod['type']>('weekly');\n  const [customStartDate, setCustomStartDate] = useState('');\n  const [customEndDate, setCustomEndDate] = useState('');\n  const [selectedReport, setSelectedReport] = useState<any>(null);\n  const [activeTab, setActiveTab] = useState<'basic' | 'advanced' | 'scheduled' | 'history'>('basic');\n\n  const handleGenerateReport = async () => {\n    setGenerating(true);\n    try {\n      const result = await generateReport(\n        team.id,\n        selectedPeriod,\n        selectedPeriod === 'custom' ? customStartDate : undefined,\n        selectedPeriod === 'custom' ? customEndDate : undefined\n      );\n\n      if (result.success) {\n        alert('レポートを生成しました！');\n        setShowGeneratePanel(false);\n      } else {\n        alert(`エラー: ${result.error}`);\n      }\n    } catch (error) {\n      console.error('Report generation error:', error);\n      alert('レポート生成に失敗しました');\n    } finally {\n      setGenerating(false);\n    }\n  };\n\n  const handleViewReport = (report: any) => {\n    setSelectedReport(report);\n    markReportAsViewed(report.id);\n  };\n\n  const handleDeleteReport = async (reportId: string) => {\n    if (!confirm('このレポートを削除してもよろしいですか？')) return;\n\n    const result = await deleteReport(reportId);\n    if (result.success) {\n      alert('レポートを削除しました');\n    } else {\n      alert(`エラー: ${result.error}`);\n    }\n  };\n\n  const getRiskLevelColor = (level: string) => {\n    switch (level) {\n      case 'high': return 'text-red-600 bg-red-50';\n      case 'medium': return 'text-yellow-600 bg-yellow-50';\n      case 'low': return 'text-green-600 bg-green-50';\n      default: return 'text-gray-600 bg-gray-50';\n    }\n  };\n\n  const getRiskLevelLabel = (level: string) => {\n    switch (level) {\n      case 'high': return '高リスク';\n      case 'medium': return '中リスク';\n      case 'low': return '低リスク';\n      default: return '不明';\n    }\n  };\n\n  if (loading) {\n    return (\n      <div className=\"flex items-center justify-center py-12\">\n        <div className=\"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600\"></div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"space-y-6\">\n      {/* Tab Navigation */}\n      <div className=\"bg-white rounded-xl shadow-sm p-2\">\n        <div className=\"flex gap-2\">\n          {[\n            { id: 'basic', label: '基本レポート', icon: FileText },\n            { id: 'advanced', label: '高度なレポート', icon: BarChart3 },\n            { id: 'scheduled', label: 'スケジュール', icon: Calendar },\n            { id: 'history', label: '履歴', icon: Clock },\n          ].map((tab) => (\n            <button\n              key={tab.id}\n              onClick={() => setActiveTab(tab.id as any)}\n              className={`flex-1 flex items-center justify-center gap-2 px-4 py-3 rounded-lg transition-colors ${\n                activeTab === tab.id\n                  ? 'bg-blue-600 text-white'\n                  : 'text-gray-600 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-700'\n              }`}\n            >\n              <tab.icon className=\"w-5 h-5\" />\n              <span className=\"font-medium\">{tab.label}</span>\n            </button>\n          ))}\n        </div>\n      </div>\n\n      {/* Tab Content */}\n      {activeTab === 'advanced' && user && (\n        <AdvancedReportGenerator organizationId={organizationId} userId={user.id} />\n      )}\n\n      {activeTab === 'scheduled' && user && (\n        <ScheduledReportManagement organizationId={organizationId} userId={user.id} />\n      )}\n\n      {activeTab === 'history' && user && (\n        <ReportHistoryManagement organizationId={organizationId} userId={user.id} />\n      )}\n\n      {activeTab === 'basic' && (\n        <>\n          <div className=\"bg-white rounded-xl shadow-sm p-6\">\n            <div className=\"flex items-center justify-between mb-4\">\n              <div>\n                <h2 className=\"text-2xl font-bold text-gray-900 flex items-center\">\n                  <FileText className=\"w-7 h-7 mr-3 text-blue-600\" />\n                  チームレポート\n                </h2>\n                <p className=\"text-gray-600 mt-1\">{team.name}の選手コンディションレポート</p>\n              </div>\n              <div className=\"flex items-center space-x-3\">\n                <button\n                  onClick={refreshReports}\n                  className=\"bg-gray-100 hover:bg-gray-200 text-gray-700 px-4 py-2 rounded-lg transition-colors flex items-center space-x-2\"\n                >\n                  <RefreshCw className=\"w-4 h-4\" />\n                  <span>更新</span>\n                </button>\n                <button\n                  onClick={() => setShowGeneratePanel(true)}\n                  className=\"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg transition-colors flex items-center space-x-2\"\n                >\n                  <Plus className=\"w-4 h-4\" />\n                  <span>レポート生成</span>\n                </button>\n              </div>\n            </div>\n\n            <div className=\"grid grid-cols-1 sm:grid-cols-4 gap-4 mt-6\">\n              <div className=\"bg-blue-50 rounded-lg p-4 text-center\">\n                <div className=\"text-2xl font-bold text-blue-600\">{reports.length}</div>\n                <div className=\"text-sm text-blue-700\">生成済みレポート</div>\n              </div>\n              <div className=\"bg-green-50 rounded-lg p-4 text-center\">\n                <div className=\"text-2xl font-bold text-green-600\">\n                  {reports.filter(r => r.viewed_at).length}\n                </div>\n                <div className=\"text-sm text-green-700\">閲覧済み</div>\n              </div>\n              <div className=\"bg-yellow-50 rounded-lg p-4 text-center\">\n                <div className=\"text-2xl font-bold text-yellow-600\">\n                  {reports.filter(r => !r.viewed_at).length}\n                </div>\n                <div className=\"text-sm text-yellow-700\">未閲覧</div>\n              </div>\n              <div className=\"bg-purple-50 rounded-lg p-4 text-center\">\n                <div className=\"text-2xl font-bold text-purple-600\">\n                  {reports[0]?.summary_data?.totalAthletes || 0}\n                </div>\n                <div className=\"text-sm text-purple-700\">対象選手数</div>\n              </div>\n            </div>\n          </div>\n\n          {/* レポート一覧 */}\n          <div className=\"bg-white rounded-xl shadow-sm p-6\">\n            <h3 className=\"text-lg font-semibold text-gray-900 mb-4\">生成済みレポート</h3>\n\n            {reports.length === 0 ? (\n              <div className=\"text-center py-12\">\n                <FileText className=\"w-16 h-16 text-gray-400 mx-auto mb-4\" />\n                <h4 className=\"text-lg font-medium text-gray-900 mb-2\">レポートがありません</h4>\n                <p className=\"text-gray-600 mb-4\">「レポート生成」ボタンから新しいレポートを作成してください。</p>\n                <button\n                  onClick={() => setShowGeneratePanel(true)}\n                  className=\"bg-blue-600 hover:bg-blue-700 text-white px-6 py-2 rounded-lg transition-colors inline-flex items-center space-x-2\"\n                >\n                  <Plus className=\"w-4 h-4\" />\n                  <span>レポート生成</span>\n                </button>\n              </div>\n            ) : (\n              <div className=\"space-y-4\">\n                {reports.map((report) => (\n                  <div\n                    key={report.id}\n                    className={`border rounded-lg p-4 hover:shadow-md transition-shadow ${\n                      !report.viewed_at ? 'border-blue-300 bg-blue-50' : 'border-gray-200'\n                    }`}\n                  >\n                    <div className=\"flex items-start justify-between\">\n                      <div className=\"flex-1\">\n                        <div className=\"flex items-center space-x-3 mb-2\">\n                          <h4 className=\"text-lg font-semibold text-gray-900\">{report.title}</h4>\n                          {!report.viewed_at && (\n                            <span className=\"bg-blue-600 text-white text-xs px-2 py-1 rounded-full\">\n                              新規\n                            </span>\n                          )}\n                        </div>\n\n                        <div className=\"flex items-center space-x-4 text-sm text-gray-600 mb-3\">\n                          <span className=\"flex items-center\">\n                            <Calendar className=\"w-4 h-4 mr-1\" />\n                            {report.period_start} 〜 {report.period_end}\n                          </span>\n                          <span className=\"flex items-center\">\n                            <Clock className=\"w-4 h-4 mr-1\" />\n                            {new Date(report.generated_at).toLocaleString('ja-JP')}\n                          </span>\n                          <span className=\"flex items-center\">\n                            <Eye className=\"w-4 h-4 mr-1\" />\n                            {report.view_count}回閲覧\n                          </span>\n                        </div>\n\n                        {report.summary_data && (\n                          <div className=\"grid grid-cols-2 sm:grid-cols-5 gap-3 mb-3\">\n                            <div className=\"bg-gray-50 rounded p-2\">\n                              <div className=\"text-xs text-gray-600\">選手数</div>\n                              <div className=\"text-lg font-bold text-gray-900\">\n                                {report.summary_data.activeAthletes || 0}\n                              </div>\n                            </div>\n                            <div className=\"bg-blue-50 rounded p-2\">\n                              <div className=\"text-xs text-blue-600\">平均ACWR</div>\n                              <div className=\"text-lg font-bold text-blue-900\">\n                                {(report.summary_data.teamAverageACWR || 0).toFixed(2)}\n                              </div>\n                            </div>\n                            <div className=\"bg-red-50 rounded p-2\">\n                              <div className=\"text-xs text-red-600\">高リスク</div>\n                              <div className=\"text-lg font-bold text-red-900\">\n                                {report.summary_data.highRiskCount || 0}名\n                              </div>\n                            </div>\n                            <div className=\"bg-yellow-50 rounded p-2\">\n                              <div className=\"text-xs text-yellow-600\">中リスク</div>\n                              <div className=\"text-lg font-bold text-yellow-900\">\n                                {report.summary_data.mediumRiskCount || 0}名\n                              </div>\n                            </div>\n                            <div className=\"bg-orange-50 rounded p-2\">\n                              <div className=\"text-xs text-orange-600\">アラート</div>\n                              <div className=\"text-lg font-bold text-orange-900\">\n                                {report.summary_data.criticalAlerts || 0}件\n                              </div>\n                            </div>\n                          </div>\n                        )}\n\n                        {report.insights && report.insights.length > 0 && (\n                          <div className=\"bg-yellow-50 border border-yellow-200 rounded p-3\">\n                            <div className=\"flex items-start\">\n                              <TrendingUp className=\"w-4 h-4 text-yellow-600 mr-2 mt-0.5 flex-shrink-0\" />\n                              <div className=\"text-sm text-yellow-800\">\n                                {report.insights[0]}\n                              </div>\n                            </div>\n                          </div>\n                        )}\n                      </div>\n\n                      <div className=\"flex items-center space-x-2 ml-4\">\n                        <button\n                          onClick={() => handleViewReport(report)}\n                          className=\"bg-blue-600 hover:bg-blue-700 text-white p-2 rounded-lg transition-colors\"\n                          title=\"詳細表示\"\n                        >\n                          <Eye className=\"w-4 h-4\" />\n                        </button>\n                        <button\n                          onClick={() => handleDeleteReport(report.id)}\n                          className=\"bg-red-600 hover:bg-red-700 text-white p-2 rounded-lg transition-colors\"\n                          title=\"削除\"\n                        >\n                          <Trash2 className=\"w-4 h-4\" />\n                        </button>\n                      </div>\n                    </div>\n                  </div>\n                ))}\n              </div>\n            )}\n      </div>\n\n      {/* レポート生成パネル */}\n      {showGeneratePanel && (\n            <div className=\"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4\">\n              <div className=\"bg-white rounded-2xl shadow-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto\">\n                <div className=\"bg-gradient-to-r from-blue-600 to-purple-600 text-white p-6 rounded-t-2xl\">\n                  <div className=\"flex items-center justify-between\">\n                    <div className=\"flex items-center space-x-3\">\n                      <BarChart3 className=\"w-8 h-8\" />\n                      <div>\n                        <h2 className=\"text-2xl font-bold\">レポート生成</h2>\n                        <p className=\"text-blue-100\">{team.name}</p>\n                      </div>\n                    </div>\n                    <button\n                      onClick={() => setShowGeneratePanel(false)}\n                      className=\"bg-blue-500 hover:bg-blue-400 rounded-full p-2 transition-colors\"\n                    >\n                      <span className=\"text-2xl\">×</span>\n                    </button>\n                  </div>\n                </div>\n\n                <div className=\"p-6 space-y-6\">\n                  <div>\n                    <h3 className=\"font-semibold text-gray-900 mb-4 flex items-center\">\n                      <Calendar className=\"w-5 h-5 mr-2 text-blue-600\" />\n                      レポート期間の選択\n                    </h3>\n\n                    <div className=\"grid grid-cols-2 sm:grid-cols-3 gap-3 mb-4\">\n                      {[\n                        { value: 'weekly', label: '1週間' },\n                        { value: 'monthly', label: '1ヶ月' },\n                        { value: 'quarterly', label: '3ヶ月' },\n                        { value: 'semi_annual', label: '6ヶ月' },\n                        { value: 'annual', label: '1年' },\n                        { value: 'custom', label: 'カスタム' }\n                      ].map((period) => (\n                        <button\n                          key={period.value}\n                          onClick={() => setSelectedPeriod(period.value as any)}\n                          className={`p-3 rounded-lg text-sm font-medium transition-colors ${\n                            selectedPeriod === period.value\n                              ? 'bg-blue-600 text-white'\n                              : 'bg-gray-100 text-gray-700 hover:bg-gray-200'\n                          }`}\n                        >\n                          {period.label}\n                        </button>\n                      ))}\n                    </div>\n\n                    {selectedPeriod === 'custom' && (\n                      <div className=\"grid grid-cols-2 gap-4 bg-gray-50 p-4 rounded-lg\">\n                        <div>\n                          <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n                            開始日\n                          </label>\n                          <input\n                            type=\"date\"\n                            value={customStartDate}\n                            onChange={(e) => setCustomStartDate(e.target.value)}\n                            className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n                          />\n                        </div>\n                        <div>\n                          <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n                            終了日\n                          </label>\n                          <input\n                            type=\"date\"\n                            value={customEndDate}\n                            onChange={(e) => setCustomEndDate(e.target.value)}\n                            className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n                          />\n                        </div>\n                      </div>\n                    )}\n                  </div>\n\n                  <div className=\"bg-blue-50 border border-blue-200 rounded-lg p-4\">\n                    <h4 className=\"font-medium text-blue-900 mb-2\">レポートに含まれるデータ</h4>\n                    <div className=\"text-sm text-blue-700 space-y-1\">\n                      <p>✓ トレーニング負荷とACWR分析</p>\n                      <p>✓ 体重変化の推移</p>\n                      <p>✓ 睡眠とモチベーションデータ</p>\n                      <p>✓ パフォーマンステスト結果</p>\n                      <p>✓ 怪我リスクアラート</p>\n                      <p>✓ チーム平均との比較</p>\n                      <p>✓ インサイトと推奨事項</p>\n                    </div>\n                  </div>\n\n                  <div className=\"flex items-center justify-end space-x-3\">\n                    <button\n                      onClick={() => setShowGeneratePanel(false)}\n                      className=\"px-6 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors\"\n                      disabled={generating}\n                    >\n                      キャンセル\n                    </button>\n                    <button\n                      onClick={handleGenerateReport}\n                      disabled={generating || (selectedPeriod === 'custom' && (!customStartDate || !customEndDate))}\n                      className=\"bg-blue-600 hover:bg-blue-700 text-white px-6 py-2 rounded-lg transition-colors disabled:opacity-50 flex items-center space-x-2\"\n                    >\n                      {generating ? (\n                        <>\n                          <div className=\"animate-spin rounded-full h-4 w-4 border-b-2 border-white\"></div>\n                          <span>生成中...</span>\n                        </>\n                      ) : (\n                        <>\n                          <BarChart3 className=\"w-4 h-4\" />\n                          <span>レポート生成</span>\n                        </>\n                      )}\n                    </button>\n                  </div>\n                </div>\n              </div>\n            </div>\n      )}\n\n      {/* レポート詳細モーダル */}\n      {selectedReport && (\n            <div className=\"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4 overflow-y-auto\">\n              <div className=\"bg-white rounded-2xl shadow-xl max-w-6xl w-full max-h-[90vh] overflow-y-auto\">\n                <div className=\"bg-gradient-to-r from-blue-600 to-purple-600 text-white p-6 rounded-t-2xl sticky top-0 z-10\">\n                  <div className=\"flex items-center justify-between\">\n                    <div>\n                      <h2 className=\"text-2xl font-bold\">{selectedReport.title}</h2>\n                      <p className=\"text-blue-100\">\n                        {selectedReport.period_start} 〜 {selectedReport.period_end}\n                      </p>\n                    </div>\n                    <button\n                      onClick={() => setSelectedReport(null)}\n                      className=\"bg-blue-500 hover:bg-blue-400 rounded-full p-2 transition-colors\"\n                    >\n                      <span className=\"text-2xl\">×</span>\n                    </button>\n                  </div>\n                </div>\n\n                <div className=\"p-6 space-y-6\">\n                  {/* サマリー */}\n                  {selectedReport.summary_data && (\n                    <div className=\"bg-gray-50 rounded-lg p-6\">\n                      <h3 className=\"text-lg font-semibold text-gray-900 mb-4\">チーム概要</h3>\n                      <div className=\"grid grid-cols-2 sm:grid-cols-4 gap-4\">\n                        <div className=\"bg-white rounded-lg p-4 text-center\">\n                          <div className=\"text-2xl font-bold text-gray-900\">\n                            {selectedReport.summary_data.activeAthletes}\n                          </div>\n                          <div className=\"text-sm text-gray-600\">活動選手数</div>\n                        </div>\n                        <div className=\"bg-white rounded-lg p-4 text-center\">\n                          <div className=\"text-2xl font-bold text-blue-600\">\n                            {selectedReport.summary_data.teamAverageACWR?.toFixed(2) || '0.00'}\n                          </div>\n                          <div className=\"text-sm text-gray-600\">平均ACWR</div>\n                        </div>\n                        <div className=\"bg-white rounded-lg p-4 text-center\">\n                          <div className=\"text-2xl font-bold text-red-600\">\n                            {selectedReport.summary_data.highRiskCount}\n                          </div>\n                          <div className=\"text-sm text-gray-600\">高リスク選手</div>\n                        </div>\n                        <div className=\"bg-white rounded-lg p-4 text-center\">\n                          <div className=\"text-2xl font-bold text-orange-600\">\n                            {selectedReport.summary_data.criticalAlerts}\n                          </div>\n                          <div className=\"text-sm text-gray-600\">重要アラート</div>\n                        </div>\n                      </div>\n                    </div>\n                  )}\n\n                  {/* インサイト */}\n                  {selectedReport.insights && selectedReport.insights.length > 0 && (\n                    <div className=\"bg-yellow-50 border border-yellow-200 rounded-lg p-6\">\n                      <h3 className=\"text-lg font-semibold text-gray-900 mb-4 flex items-center\">\n                        <TrendingUp className=\"w-5 h-5 mr-2 text-yellow-600\" />\n                        インサイト\n                      </h3>\n                      <div className=\"space-y-2\">\n                        {selectedReport.insights.map((insight: string, index: number) => (\n                          <p key={index} className=\"text-sm text-gray-700\">\n                            • {insight}\n                          </p>\n                        ))}\n                      </div>\n                    </div>\n                  )}\n\n                  {/* 推奨事項 */}\n                  {selectedReport.recommendations && selectedReport.recommendations.length > 0 && (\n                    <div className=\"bg-blue-50 border border-blue-200 rounded-lg p-6\">\n                      <h3 className=\"text-lg font-semibold text-gray-900 mb-4 flex items-center\">\n                        <AlertTriangle className=\"w-5 h-5 mr-2 text-blue-600\" />\n                        推奨事項\n                      </h3>\n                      <div className=\"space-y-2\">\n                        {selectedReport.recommendations.map((rec: string, index: number) => (\n                          <p key={index} className=\"text-sm text-gray-700\">\n                            • {rec}\n                          </p>\n                        ))}\n                      </div>\n                    </div>\n                  )}\n\n                  {/* 選手別データ */}\n                  {selectedReport.detailed_data?.athletes && (\n                    <div className=\"bg-white border border-gray-200 rounded-lg p-6\">\n                      <h3 className=\"text-lg font-semibold text-gray-900 mb-4 flex items-center\">\n                        <Users className=\"w-5 h-5 mr-2 text-gray-600\" />\n                        選手別データ\n                      </h3>\n                      <div className=\"space-y-4\">\n                        {selectedReport.detailed_data.athletes.map((athlete: any) => (\n                          <div key={athlete.athleteId} className=\"border border-gray-200 rounded-lg p-4\">\n                            <div className=\"flex items-center justify-between mb-3\">\n                              <h4 className=\"text-lg font-semibold text-gray-900\">{athlete.athleteName}</h4>\n                              <span className={`px-3 py-1 rounded-full text-sm font-medium ${getRiskLevelColor(athlete.acwrData.riskLevel)}`}>\n                                {getRiskLevelLabel(athlete.acwrData.riskLevel)}\n                              </span>\n                            </div>\n\n                            <div className=\"grid grid-cols-2 sm:grid-cols-5 gap-3 text-sm\">\n                              <div>\n                                <div className=\"text-gray-600\">トレーニング</div>\n                                <div className=\"font-semibold text-gray-900\">{athlete.trainingRecords.totalSessions}回</div>\n                              </div>\n                              <div>\n                                <div className=\"text-gray-600\">ACWR</div>\n                                <div className=\"font-semibold text-gray-900\">{athlete.acwrData.current.toFixed(2)}</div>\n                              </div>\n                              <div>\n                                <div className=\"text-gray-600\">睡眠</div>\n                                <div className=\"font-semibold text-gray-900\">\n                                  {athlete.sleepData.averageHours?.toFixed(1) || '-'}h\n                                </div>\n                              </div>\n                              <div>\n                                <div className=\"text-gray-600\">モチベ</div>\n                                <div className=\"font-semibold text-gray-900\">\n                                  {athlete.motivationData.averageMotivation?.toFixed(1) || '-'}\n                                </div>\n                              </div>\n                              <div>\n                                <div className=\"text-gray-600\">アラート</div>\n                                <div className=\"font-semibold text-red-600\">{athlete.alerts.high}件</div>\n                              </div>\n                            </div>\n                          </div>\n                        ))}\n                      </div>\n                    </div>\n                  )}\n                </div>\n              </div>\n            </div>\n      )}\n        </>\n      )}\n    </div>\n  );\n}\n"],"names":["PowerOff","createLucideIcon","d","key","Power","XCircle","cx","cy","r","toNumber","v","n","Number","isFinite","calcLoad","row","loadRaw","load","rpe","dur","duration_min","round2","Math","round","async","generateAthleteReport","athleteId","period","data","athlete","error","athleteErr","supabase","from","select","eq","single","Error","trainingRecords","trErr","gte","start","lte","end","order","ascending","totalSessions","length","totalLoad","reduce","sum","totalDuration","averageLoad","maxLoad","max","averageRPE","recordLikes","map","date","input","m","match","Date","isNaN","getTime","toISOString","slice","toYMD","filter","Boolean","acwrValues","calculateACWR","acwr","currentACWR","averageACWR","maxACWR","minACWR","min","daysInDangerZone","riskLevel","acwrTrend","floor","weightRecords","wErr","weights","weight_kg","currentWeight","firstWeight","averageWeight","w","weightChange","weightChangePercent","weightTrend","abs","sleepRecords","sErr","sleepHours","sleep_hours","sleepQualities","sleep_quality","averageSleepHours","h","averageSleepQuality","q","sleepQualityTrend","motivationRecords","mErr","motivations","motivation_level","energies","energy_level","stresses","stress_level","averageMotivation","averageEnergy","e","averageStress","s","motivationTrend","performanceRecords","pErr","totalTests","improvements","declines","testTypeGroups","Map","forEach","record","typeId","test_type_id","has","set","get","push","records","sorted","sort","a","b","first","last","firstValue","_a","values","result","lastValue","_b","alertsRaw","alerts","totalAlerts","highAlerts","priority","mediumAlerts","metadata","lowAlerts","resolvedAlerts","is_resolved","id","athleteName","name","athleteEmail","email","acwrData","current","average","trend","weightData","change","changePercent","sleepData","averageHours","averageQuality","totalRecords","qualityTrend","motivationData","performanceData","personalBests","total","high","medium","low","resolved","useReports","teamId","reports","setReports","useState","loading","setLoading","setError","useEffect","fetchReports","fetchError","limit","err","console","message","generateReport","periodType","customStart","customEnd","todayJST","getTodayJST","setDate","getDate","setMonth","getMonth","setFullYear","getFullYear","type","formatDateJST","getPeriodDates","reportData","team","teamErr","athletes","athErr","totalAthletes","athleteReports","report","activeAthletes","teamAverageLoad","athletesWithACWR","teamAverageACWR","highRiskCount","mediumRiskCount","lowRiskCount","criticalAlerts","insights","recommendations","toFixed","join","lowSleepAthletes","lowMotivationAthletes","teamName","generatedAt","newAlerts","generateTeamReport","insertPayload","report_type","title","period_start","period_end","team_id","athlete_ids","summary_data","detailed_data","generation_status","insertedReport","insertError","insert","success","reportId","markReportAsViewed","update","viewed_at","getNowJSTISOString","deleteReport","delete","refreshReports","AdvancedReportGenerator","organizationId","userId","templates","setTemplates","selectedTemplate","setSelectedTemplate","reportType","setReportType","dateRange","setDateRange","selectedTeam","setSelectedTeam","selectedAthlete","setSelectedAthlete","teams","setTeams","setAthletes","includeMetrics","setIncludeMetrics","training_load","performance","injury_risk","attendance","trends","loadingTeams","setLoadingTeams","loadingAthletes","setLoadingAthletes","generating","setGenerating","latestResult","setLatestResult","history","setHistory","loadingHistory","setLoadingHistory","fetchTemplates","fetchTeams","fetchHistory","prev","fetchAthletes","athleteList","user_id","users","localeCompare","dateError","useMemo","validationError","Object","some","canGenerate","openReport","url","window","open","getIcon","jsx","User","className","Users","Building2","FileText","metricLabel","statusBadge","base","jsxs","children","onClick","value","onChange","template","find","t","target","Calendar","disabled","Filter","entries","checked","replace","alert","parameters","date_range","athlete_id","metrics","created","insertErr","organization_id","template_id","generated_by","status","reportHistoryId","fnData","fnErr","functions","invoke","body","report_history_id","report_url","file_path","Download","Fragment","ExternalLink","href","rel","RefreshCcw","toUpperCase","error_message","created_at","completed_at","ReportHistoryManagement","setFilter","query","getStatusIcon","CheckCircle","Clock","getStatusBg","getStatusText","getReportTypeName","RefreshCw","dateStr","toLocaleString","year","month","day","hour","minute","keys","confirm","Trash2","ScheduledReportManagement","scheduledReports","setScheduledReports","showForm","setShowForm","editingReport","setEditingReport","formData","setFormData","schedule_type","day_of_week","day_of_month","time","recipients","fetchScheduledReports","getScheduleText","config","schedule_config","Plus","onSubmit","preventDefault","scheduleConfig","parseInt","split","trim","nextRunData","rpc","p_schedule_type","p_schedule_config","next_run","created_by","required","placeholder","Mail","is_active","toggleActive","ReportView","user","useAuth","organizations","useOrganizations","showGeneratePanel","setShowGeneratePanel","selectedPeriod","setSelectedPeriod","customStartDate","setCustomStartDate","customEndDate","setCustomEndDate","selectedReport","setSelectedReport","activeTab","setActiveTab","getRiskLevelColor","level","getRiskLevelLabel","label","icon","BarChart3","tab","generated_at","Eye","view_count","TrendingUp","handleViewReport","handleDeleteReport","_c","insight","index","AlertTriangle","rec","_d"],"mappings":";;;;;;GASA,MAAMA,EAAWC,EAAiB,WAAY,CAC5C,CAAC,OAAQ,CAAEC,EAAG,iCAAkCC,IAAK,WACrD,CAAC,OAAQ,CAAED,EAAG,mCAAoCC,IAAK,WACvD,CAAC,OAAQ,CAAED,EAAG,UAAWC,IAAK,WAC9B,CAAC,OAAQ,CAAED,EAAG,aAAcC,IAAK,aCJ7BC,EAAQH,EAAiB,QAAS,CACtC,CAAC,OAAQ,CAAEC,EAAG,WAAYC,IAAK,UAC/B,CAAC,OAAQ,CAAED,EAAG,+BAAgCC,IAAK,aCF/CE,EAAUJ,EAAiB,UAAW,CAC1C,CAAC,SAAU,CAAEK,GAAI,KAAMC,GAAI,KAAMC,EAAG,KAAML,IAAK,WAC/C,CAAC,OAAQ,CAAED,EAAG,YAAaC,IAAK,WAChC,CAAC,OAAQ,CAAED,EAAG,WAAYC,IAAK;;;;;;GC0FjC,SAASM,EAASC,GAChB,GAAIA,SAAuC,KAANA,EAAU,OAAO,KACtD,MAAMC,EAAiB,iBAAND,EAAiBA,EAAIE,OAAOF,GAC7C,OAAOE,OAAOC,SAASF,GAAKA,EAAI,IAClC,CAiBA,SAASG,EAASC,GAChB,MAAMC,EAAUP,EAAS,MAAAM,OAAA,EAAAA,EAAKE,MAC9B,GAAe,MAAXD,EAAiB,OAAOA,EAC5B,MAAME,EAAMT,EAAS,MAAAM,OAAA,EAAAA,EAAKG,KACpBC,EAAMV,EAAS,MAAAM,OAAA,EAAAA,EAAKK,cAC1B,OAAW,MAAPF,GAAsB,MAAPC,EAAoBD,EAAMC,EACtC,CACT,CAEA,SAASE,EAAOV,GACd,OAAOW,KAAKC,MAAU,IAAJZ,GAAW,GAC/B,CAIAa,eAAsBC,EACpBC,EACAC,GAGA,MAAQC,KAAMC,EAASC,MAAOC,SAAqBC,EAChDC,KAAK,SACLC,OAAO,KACPC,GAAG,KAAMT,GACTU,SAEH,GAAIL,EAAY,MAAMA,EACtB,IAAKF,EAAS,MAAM,IAAIQ,MAAM,qBAG9B,MAAQT,KAAMU,EAAiBR,MAAOS,SAAgBP,EACnDC,KAAK,oBACLC,OAAO,KACPC,GAAG,UAAWT,GACdc,IAAI,OAAQb,EAAOc,OACnBC,IAAI,OAAQf,EAAOgB,KACnBC,MAAM,OAAQ,CAAEC,WAAW,IAE9B,GAAIN,EAAO,MAAMA,EAEjB,MAAMO,SAAgBR,WAAiBS,SAAU,EAE3CC,GACJ,MAAAV,OAAA,EAAAA,EAAiBW,OAAO,CAACC,EAAK1C,IAAW0C,EAAMpC,EAASN,GAAI,KAAM,EAE9D2C,GACJ,MAAAb,OAAA,EAAAA,EAAiBW,OAAO,CAACC,EAAK1C,IAAW0C,GAAOzC,EAASD,EAAEY,eAAiB,GAAI,KAAM,EAElFgC,EAAcN,EAAgB,EAAIE,EAAYF,EAAgB,EAE9DO,GACJ,MAAAf,OAAA,EAAAA,EAAiBW,OAAO,CAACK,EAAK9C,IAAWc,KAAKgC,IAAIA,EAAKxC,EAASN,IAAK,KAAM,EAEvE+C,EACJT,EAAgB,GACXR,GAAmB,IAAIW,OAAO,CAACC,EAAa1C,IAAW0C,GAAOzC,EAASD,EAAEU,MAAQ,GAAI,GACtF4B,EACA,EAGAU,GACHlB,GAAmB,IACjBmB,IAAKjD,IACJ,MAAMkD,EA9Ed,SAAeC,GACb,IAAKA,EAAO,OAAO,KACnB,GAAqB,iBAAVA,EAAoB,CAC7B,MAAMC,EAAID,EAAME,MAAM,wBACtB,OAAOD,EAAIA,EAAE,GAAK,IACpB,CACA,IACE,MAAM1D,EAAI,IAAI4D,KAAKH,GACnB,OAAI/C,OAAOmD,MAAM7D,EAAE8D,WAAmB,KAC/B9D,EAAE+D,cAAcC,MAAM,EAAG,GAClC,CAAA,MACE,OAAO,IACT,CACF,CAiEqBC,CAAM,MAAA3D,OAAA,EAAAA,EAAGkD,MACtB,OAAKA,EACE,CAAEA,OAAMzC,KAAMH,EAASN,IADZ,OAGnB4D,OAAOC,SAINC,GAFcd,EAAYT,OAAS,EAAIwB,EAAcf,GAAe,IAGvEC,IAAIjD,GAAKA,EAAEgE,MACXJ,OAAO1D,GAAkB,iBAANA,GAAkBE,OAAOC,SAASH,IAGlD+D,EAAcH,EAAWvB,OAAS,EAAIuB,EAAWA,EAAWvB,OAAS,GAAK,EAE1E2B,EACJJ,EAAWvB,OAAS,EAAIuB,EAAWrB,OAAO,CAACC,EAAKxC,IAAMwC,EAAMxC,EAAG,GAAK4D,EAAWvB,OAAS,EAEpF4B,EAAUL,EAAWvB,OAAS,EAAIzB,KAAKgC,OAAOgB,GAAc,EAC5DM,EAAUN,EAAWvB,OAAS,EAAIzB,KAAKuD,OAAOP,GAAc,EAE5DQ,EAAmBR,EAAWF,OAAO1D,GAAKA,EAAI,IAAOA,EAAI,KAAKqC,OAG9DgC,EACJN,GAAe,IAAM,OACnBA,GAAe,IAAM,SACrBA,GAAe,GAAM,MACrB,SAEEO,EACJV,EAAWvB,QAAU,EACjBuB,EAAWA,EAAWvB,OAAS,GAC/BuB,EAAWhD,KAAK2D,MAAMX,EAAWvB,OAAS,IACxC,YACA,YACF,UAGEnB,KAAMsD,EAAepD,MAAOqD,SAAenD,EAChDC,KAAK,kBACLC,OAAO,KACPC,GAAG,UAAWT,GACdc,IAAI,OAAQb,EAAOc,OACnBC,IAAI,OAAQf,EAAOgB,KACnBC,MAAM,OAAQ,CAAEC,WAAW,IAE9B,GAAIsC,EAAM,MAAMA,EAEhB,MAAMC,GAAWF,GAAiB,IAC/BzB,IAAKjD,GAAWC,EAASD,EAAE6E,YAC3BjB,OAAQ1D,GAAwB,iBAANA,GAAkBE,OAAOC,SAASH,IAEzD4E,EAAgBF,EAAQrC,OAAS,EAAIqC,EAAQA,EAAQrC,OAAS,GAAK,KACnEwC,EAAcH,EAAQrC,OAAS,EAAIqC,EAAQ,GAAK,KAEhDI,EACJJ,EAAQrC,OAAS,EAAIqC,EAAQnC,OAAO,CAACC,EAAKuC,IAAMvC,EAAMuC,EAAG,GAAKL,EAAQrC,OAAS,KAE3E2C,EACa,MAAjBJ,GAAwC,MAAfC,EAAsBD,EAAgBC,EAAc,KAEzEI,EACa,MAAjBL,GAAwC,MAAfC,GAAuBA,EAAc,GACxDD,EAAgBC,GAAeA,EAAe,IAChD,KAEAK,EACY,MAAhBF,EACI,UACApE,KAAKuE,IAAIH,GAAgB,GACzB,SACAA,EAAe,EACf,aACA,cAGE9D,KAAMkE,EAAchE,MAAOiE,SAAe/D,EAC/CC,KAAK,iBACLC,OAAO,KACPC,GAAG,UAAWT,GACdc,IAAI,OAAQb,EAAOc,OACnBC,IAAI,OAAQf,EAAOgB,KAEtB,GAAIoD,EAAM,MAAMA,EAEhB,MAAMC,GAAcF,GAAgB,IACjCrC,IAAKjD,GAAWC,EAASD,EAAEyF,cAC3B7B,OAAQ1D,GAAwB,iBAANA,GAAkBE,OAAOC,SAASH,IAEzDwF,GAAkBJ,GAAgB,IACrCrC,IAAKjD,GAAWC,EAASD,EAAE2F,gBAC3B/B,OAAQ1D,GAAwB,iBAANA,GAAkBE,OAAOC,SAASH,IAEzD0F,EACJJ,EAAWjD,OAAS,EAAIiD,EAAW/C,OAAO,CAACC,EAAKmD,IAAMnD,EAAMmD,EAAG,GAAKL,EAAWjD,OAAS,KAEpFuD,EACJJ,EAAenD,OAAS,EACpBmD,EAAejD,OAAO,CAACC,EAAKqD,IAAMrD,EAAMqD,EAAG,GAAKL,EAAenD,OAC/D,KAEAyD,EACJN,EAAenD,OAAS,EACpB,UACAmD,EAAeA,EAAenD,OAAS,GACvCmD,EAAe5E,KAAK2D,MAAMiB,EAAenD,OAAS,IAClD,YACAmD,EAAeA,EAAenD,OAAS,GACvCmD,EAAe5E,KAAK2D,MAAMiB,EAAenD,OAAS,IAClD,YACA,UAGEnB,KAAM6E,EAAmB3E,MAAO4E,SAAe1E,EACpDC,KAAK,sBACLC,OAAO,KACPC,GAAG,UAAWT,GACdc,IAAI,OAAQb,EAAOc,OACnBC,IAAI,OAAQf,EAAOgB,KAEtB,GAAI+D,EAAM,MAAMA,EAEhB,MAAMC,GAAeF,GAAqB,IACvChD,IAAKjD,GAAWC,EAASD,EAAEoG,mBAC3BxC,OAAQ1D,GAAwB,iBAANA,GAAkBE,OAAOC,SAASH,IAEzDmG,GAAYJ,GAAqB,IACpChD,IAAKjD,GAAWC,EAASD,EAAEsG,eAC3B1C,OAAQ1D,GAAwB,iBAANA,GAAkBE,OAAOC,SAASH,IAEzDqG,GAAYN,GAAqB,IACpChD,IAAKjD,GAAWC,EAASD,EAAEwG,eAC3B5C,OAAQ1D,GAAwB,iBAANA,GAAkBE,OAAOC,SAASH,IAEzDuG,EACJN,EAAY5D,OAAS,EAAI4D,EAAY1D,OAAO,CAACC,EAAKU,IAAMV,EAAMU,EAAG,GAAK+C,EAAY5D,OAAS,KAEvFmE,EACJL,EAAS9D,OAAS,EAAI8D,EAAS5D,OAAO,CAACC,EAAKiE,IAAMjE,EAAMiE,EAAG,GAAKN,EAAS9D,OAAS,KAE9EqE,EACJL,EAAShE,OAAS,EAAIgE,EAAS9D,OAAO,CAACC,EAAKmE,IAAMnE,EAAMmE,EAAG,GAAKN,EAAShE,OAAS,KAE9EuE,EACJX,EAAY5D,OAAS,EACjB,UACA4D,EAAYA,EAAY5D,OAAS,GACjC4D,EAAYrF,KAAK2D,MAAM0B,EAAY5D,OAAS,IAC5C,YACA4D,EAAYA,EAAY5D,OAAS,GACjC4D,EAAYrF,KAAK2D,MAAM0B,EAAY5D,OAAS,IAC5C,YACA,UAGEnB,KAAM2F,EAAoBzF,MAAO0F,SAAexF,EACrDC,KAAK,uBACLC,OAAO,gCACPC,GAAG,UAAWT,GACdc,IAAI,OAAQb,EAAOc,OACnBC,IAAI,OAAQf,EAAOgB,KAEtB,GAAI6E,EAAM,MAAMA,EAEhB,MAAMC,SAAaF,WAAoBxE,SAAU,EAEjD,IACI2E,GAAe,EACfC,GAAW,EAEf,GAAIJ,GAAsBA,EAAmBxE,OAAS,EAAG,CACvD,MAAM6E,MAAqBC,IAC3BN,EAAmBO,QAASC,IAC1B,MAAMC,EAASD,EAAOE,aACjBL,EAAeM,IAAIF,IAASJ,EAAeO,IAAIH,EAAQ,IAC5DJ,EAAeQ,IAAIJ,GAASK,KAAKN,KAGnCH,EAAeE,QAAQQ,YACrB,GAAIA,EAAQvF,QAAU,EAAG,CACvB,MAAMwF,EAAS,IAAID,GAASE,KAC1B,CAACC,EAAGC,IAAM,IAAI5E,KAAK2E,EAAE/E,MAAMM,UAAY,IAAIF,KAAK4E,EAAEhF,MAAMM,WAEpD2E,EAAQJ,EAAO,GACfK,EAAOL,EAAOA,EAAOxF,OAAS,GAE9B8F,EAAa,OAAAC,EAAA,MAAAH,OAAA,EAAAA,EAAOI,aAAP,EAAAD,EAAeE,OAC5BC,EAAY,OAAAC,EAAA,MAAAN,OAAA,EAAAA,EAAMG,aAAN,EAAAG,EAAcF,OAEd,MAAdH,GAAmC,MAAbI,IACpBA,EAAYJ,EAAYnB,KACnBuB,EAAYJ,GAAYlB,KAErC,GAEJ,CASA,MAAQ/F,KAAMuH,UAAqBnH,EAChCC,KAAK,UACLC,OAAO,KACPC,GAAG,UAAWT,GACdc,IAAI,aAAcb,EAAOc,OACzBC,IAAI,aAAcf,EAAOgB,KAEtByG,GAAUD,IAAa,GAEvBE,GAAcD,GAAOrG,OACrBuG,GAAaF,GAAOhF,UAA2B,SAAfqE,EAAEc,UAAqBxG,OACvDyG,GAAeJ,GAAOhF,OAAOqE,UAAK,MAAyB,YAAzB,OAAAK,EAAAL,EAAEgB,mBAAUF,YAAuBxG,OACrE2G,GAAYN,GAAOhF,UAA2B,QAAfqE,EAAEc,UAAoBxG,OACrD4G,GAAiBP,GAAOhF,OAAOqE,GAAKA,EAAEmB,aAAa7G,OAEzD,MAAO,CACLrB,UAAWG,EAAQgI,GACnBC,YAAajI,EAAQkI,KACrBC,aAAcnI,EAAQoI,MAEtB3H,gBAAiB,CACfQ,gBACAE,UAAW3B,EAAO2B,GAClBI,YAAa/B,EAAO+B,GACpBC,QAAShC,EAAOgC,GAChBE,WAAYlC,EAAOkC,GACnBJ,cAAe7B,KAAKC,MAAM4B,IAG5B+G,SAAU,CACRC,QAAS9I,EAAOoD,GAChB2F,QAAS/I,EAAOqD,GAChBpB,IAAKjC,EAAOsD,GACZE,IAAKxD,EAAOuD,GACZG,YACAD,mBACAuF,MAAOrF,GAGTsF,WAAY,CACVH,QAAS7E,EACT8E,QAA0B,MAAjB5E,EAAwBnE,EAAOmE,GAAiB,KACzD+E,OAAwB,MAAhB7E,EAAuBrE,EAAOqE,GAAgB,KACtD8E,cAAsC,MAAvB7E,EAA8BtE,EAAOsE,GAAuB,KAC3E0E,MAAOzE,GAGT6E,UAAW,CACTC,aAAmC,MAArBtE,EAA4B/E,EAAO+E,GAAqB,KACtEuE,eAAuC,MAAvBrE,EAA8BjF,EAAOiF,GAAuB,KAC5EsE,oBAAc9E,WAAc/C,SAAU,EACtC8H,aAAcrE,GAGhBsE,eAAgB,CACd7D,kBAAwC,MAArBA,EAA4B5F,EAAO4F,GAAqB,KAC3EC,cAAgC,MAAjBA,EAAwB7F,EAAO6F,GAAiB,KAC/DE,cAAgC,MAAjBA,EAAwB/F,EAAO+F,GAAiB,KAC/DwD,oBAAcnE,WAAmB1D,SAAU,EAC3CuE,mBAGFyD,gBAAiB,CACftD,aACAuD,cAtGgB,EAuGhBtD,gBACAC,aAGFyB,OAAQ,CACN6B,MAAO5B,GACP6B,KAAM5B,GACN6B,OAAQ3B,GACR4B,IAAK1B,GACL2B,SAAU1B,IAGhB,CC5ZO,SAAS2B,EAAWC,GACzB,MAAOC,EAASC,GAAcC,EAAAA,SAA4B,KACnDC,EAASC,GAAcF,EAAAA,UAAS,IAChC5J,EAAO+J,GAAYH,EAAAA,SAAwB,MAElDI,EAAAA,UAAU,KACJP,EACFQ,KAEAN,EAAW,IACXG,GAAW,KAGZ,CAACL,IAEJ,MAAMQ,EAAevK,UACnB,GAAK+J,EAEL,IACEK,GAAW,GACXC,EAAS,MAET,MAAMjK,KAAEA,EAAME,MAAOkK,SAAqBhK,EACvCC,KAAK,qBACLC,OAAO,KACPC,GAAG,UAAWoJ,GACd3I,MAAM,aAAc,CAAEC,WAAW,IACjCoJ,MAAM,IAET,GAAID,EAAY,MAAMA,EAGtBP,EAAY7J,GAAQ,GACtB,OAASsK,GACPC,QAAQrK,MAAM,0BAA2BoK,GACzCL,EAASK,EAAIE,QACf,CAAA,QACER,GAAW,EACb,GAyGF,MAAO,CACLJ,UACAG,UACA7J,QACAuK,eA1GqB7K,MACrB+J,EACAe,EACAC,EACAC,KAEA,IACE,MAAM7K,ED8eL,SACL2K,EACAC,EACAC,GAEA,MAAMC,EAAWC,IACX/J,EAAM,IAAImB,KAAK2I,EAASzI,WAC9B,IAAIvB,EAAQ,IAAIqB,KAAKnB,EAAIqB,WAEzB,OAAQsI,GACN,IAAK,SACH7J,EAAMkK,QAAQhK,EAAIiK,UAAY,GAC9B,MACF,IAAK,UACHnK,EAAMoK,SAASlK,EAAImK,WAAa,GAChC,MACF,IAAK,YACHrK,EAAMoK,SAASlK,EAAImK,WAAa,GAChC,MACF,IAAK,cACHrK,EAAMoK,SAASlK,EAAImK,WAAa,GAChC,MACF,IAAK,SACHrK,EAAMsK,YAAYpK,EAAIqK,cAAgB,GACtC,MACF,IAAK,SACH,GAAIT,GAAeC,EACjB,MAAO,CAAE/J,MAAO8J,EAAa5J,IAAK6J,EAAWS,KAAM,UAKzD,MAAO,CACLxK,MAAOyK,EAAczK,GACrBE,IAAKuK,EAAcvK,GACnBsK,KAAMX,EAEV,CCnhBqBa,CAAeb,EAAYC,EAAaC,GACjDY,QD6WZ5L,eACE+J,EACA5J,GAEA,MAAQC,KAAMyL,EAAMvL,MAAOwL,SAAkBtL,EAC1CC,KAAK,SACLC,OAAO,KACPC,GAAG,KAAMoJ,GACTnJ,SAEH,GAAIkL,EAAS,MAAMA,EACnB,IAAKD,EAAM,MAAM,IAAIhL,MAAM,kBAE3B,MAAQT,KAAM2L,EAAUzL,MAAO0L,SAAiBxL,EAC7CC,KAAK,SACLC,OAAO,KACPC,GAAG,UAAWoJ,GACdpJ,GAAG,OAAQ,WAEd,GAAIqL,EAAQ,MAAMA,EAElB,MAAMC,SAAgBF,WAAUxK,SAAU,EAEpC2K,EAAsC,GAC5C,GAAIH,EACF,IAAA,MAAW1L,KAAW0L,EACpB,IACE,MAAMI,QAAelM,EAAsBI,EAAQgI,GAAIlI,GACvD+L,EAAerF,KAAKsF,EACtB,OAAS7L,GACPqK,QAAQrK,MAAM,uCAAuCD,EAAQgI,MAAO/H,EACtE,CAIJ,MAAM8L,EAAiBF,EAAetJ,OAAO5D,GAAKA,EAAE8B,gBAAgBQ,cAAgB,GAAGC,OAEjF8K,EACJD,EAAiB,EACbF,EAAezK,OAAO,CAACC,EAAK1C,IAAM0C,EAAM1C,EAAE8B,gBAAgBc,YAAa,GAAKwK,EAC5E,EAEAE,EAAmBJ,EAAetJ,UAAY5D,EAAE0J,SAASC,QAAU,GACnE4D,EACJD,EAAiB/K,OAAS,EACtB+K,EAAiB7K,OAAO,CAACC,EAAK1C,IAAM0C,EAAM1C,EAAE0J,SAASC,QAAS,GAAK2D,EAAiB/K,OACpF,EAEAiL,EAAgBN,EAAetJ,OAAO5D,GAA8B,SAAzBA,EAAE0J,SAASnF,WAAsBhC,OAC5EkL,EAAkBP,EAAetJ,OAAO5D,GAA8B,WAAzBA,EAAE0J,SAASnF,WAAwBhC,OAChFmL,EAAeR,EAAetJ,OAAO5D,GAA8B,QAAzBA,EAAE0J,SAASnF,WAAqBhC,OAE1EsG,EAAcqE,EAAezK,OAAO,CAACC,EAAK1C,IAAM0C,EAAM1C,EAAE4I,OAAO6B,MAAO,GACtEkD,EAAiBT,EAAezK,OAAO,CAACC,EAAK1C,IAAM0C,EAAM1C,EAAE4I,OAAO8B,KAAM,GAExEkD,EAAqB,GACrBC,EAA4B,GAE9BN,EAAkB,KACpBK,EAAS/F,KACP,aAAa0F,EAAgBO,QAAQ,wCAEvCD,EAAgBhG,KAAK,2CACZ0F,EAAkB,IAAOA,EAAkB,GACpDK,EAAS/F,KACP,aAAa0F,EAAgBO,QAAQ,6CAEvCD,EAAgBhG,KAAK,mDAErB+F,EAAS/F,KAAK,aAAa0F,EAAgBO,QAAQ,iBAGjDN,EAAgB,IAClBI,EAAS/F,KAAK,GAAG2F,6BACjBK,EAAgBhG,KACd,WAAWqF,EACRtJ,OAAO5D,GAA8B,SAAzBA,EAAE0J,SAASnF,WACvBtB,OAASjD,EAAEsJ,aACXyE,KAAK,0BAIRJ,EAAiB,IACnBC,EAAS/F,KAAK,GAAG8F,sBACjBE,EAAgBhG,KAAK,8BAGvB,MAAMmG,EAAmBd,EAAetJ,UACJ,OAA7B5D,EAAEiK,UAAUC,cAAyBlK,EAAEiK,UAAUC,aAAe,GAEnE8D,EAAiBzL,OAAS,IAC5BqL,EAAS/F,KAAK,GAAGmG,EAAiBzL,8BAClCsL,EAAgBhG,KACd,WAAWmG,EAAiB/K,IAAIjD,GAAKA,EAAEsJ,aAAayE,KAAK,gCAI7D,MAAME,EAAwBf,EAAetJ,UACC,OAAvC5D,EAAEsK,eAAe7D,mBAA8BzG,EAAEsK,eAAe7D,kBAAoB,GAS3F,OAPIwH,EAAsB1L,OAAS,IACjCqL,EAAS/F,KAAK,GAAGoG,EAAsB1L,+BACvCsL,EAAgBhG,KACd,oBAAoBoG,EAAsBhL,IAAIjD,GAAKA,EAAEsJ,aAAayE,KAAK,2BAIpE,CACLhD,OAAQ8B,EAAKxD,GACb6E,SAAUrB,EAAKtD,KACfpI,SACAgN,aAAA,IAAiB7K,MAAOG,cACxBwJ,gBACAG,iBACAC,gBAAiBxM,EAAOwM,GACxBE,gBAAiB1M,EAAO0M,GACxBC,gBACAC,kBACAC,eACA7E,cACAuF,UAAWvF,EACX8E,iBACAZ,SAAUG,EACVU,WACAC,kBAEJ,CC3e+BQ,CAAmBtD,EAAQ5J,IAE5CC,KAAMyL,SAAerL,EAC1BC,KAAK,SACLC,OAAO,QACPC,GAAG,KAAMoJ,GACTnJ,SAKG0M,EAAqB,CACzBC,YAAazC,EACb0C,MALY,IAAG,MAAA3B,OAAA,EAAAA,EAAMtD,OAAQ,eAAepI,EAAOc,WAAWd,EAAOgB,MAMrEsM,aAActN,EAAOc,MACrByM,WAAYvN,EAAOgB,IACnBwM,QAAS5D,EACT6D,YAAahC,EAAWG,SAAS9J,IAAIgF,GAAKA,EAAE/G,WAC5C2N,aAAc,CACZ5B,cAAeL,EAAWK,cAC1BG,eAAgBR,EAAWQ,eAC3BC,gBAAiBT,EAAWS,gBAC5BE,gBAAiBX,EAAWW,gBAC5BC,cAAeZ,EAAWY,cAC1BC,gBAAiBb,EAAWa,gBAC5BC,aAAcd,EAAWc,aACzB7E,YAAa+D,EAAW/D,YACxB8E,eAAgBf,EAAWe,gBAE7BmB,cAAelC,EACfgB,SAAUhB,EAAWgB,SACrBC,gBAAiBjB,EAAWiB,gBAC5BkB,kBAAmB,cAGb3N,KAAM4N,EAAgB1N,MAAO2N,SAAsBzN,EACxDC,KAAK,qBACLyN,OAAOZ,GACP5M,SACAE,SAEH,GAAIqN,EAAa,MAAMA,EAIvB,aAFM1D,IAEC,CACL4D,SAAS,EACTC,SAAUJ,EAAe3F,GAE7B,OAASqC,GAEP,OADAC,QAAQrK,MAAM,2BAA4BoK,GACnC,CACLyD,SAAS,EACT7N,MAAOoK,EAAIE,QAEf,GA4CAyD,mBAzCyBrO,MAAOoO,IAChC,IACE,MAAQ9N,MAAAA,SAAgBE,EACrBC,KAAK,qBACL6N,OAAO,CAAEC,UAAWC,MACpB7N,GAAG,KAAMyN,GAEZ,GAAI9N,EAAO,MAAMA,QAEXiK,GACR,OAASG,GACPC,QAAQrK,MAAM,kCAAmCoK,EACnD,GA8BA+D,aA3BmBzO,MAAOoO,IAC1B,IACE,MAAQ9N,MAAAA,SAAgBE,EACrBC,KAAK,qBACLiO,SACA/N,GAAG,KAAMyN,GAEZ,GAAI9N,EAAO,MAAMA,EAIjB,aAFMiK,IAEC,CAAE4D,SAAS,EACpB,OAASzD,GAEP,OADAC,QAAQrK,MAAM,yBAA0BoK,GACjC,CACLyD,SAAS,EACT7N,MAAOoK,EAAIE,QAEf,GAUA+D,eAAgBpE,EAEpB,CCpKO,SAASqE,GAAwBC,eAAEA,EAAAC,OAAgBA,IACxD,MAAOC,EAAWC,GAAgB9E,EAAAA,SAA2B,KACtD+E,EAAkBC,GAAuBhF,EAAAA,SAAgC,OAEzEiF,EAAYC,GAAiBlF,EAAAA,SAAiD,SAC9EmF,EAAWC,GAAgBpF,EAAAA,SAAS,CAAEjJ,MAAO,GAAIE,IAAK,MAEtDoO,EAAcC,GAAmBtF,EAAAA,SAAS,KAC1CuF,EAAiBC,GAAsBxF,EAAAA,SAAS,KAEhDyF,EAAOC,GAAY1F,EAAAA,SAAoB,KACvC6B,EAAU8D,GAAe3F,EAAAA,SAAuB,KAEhD4F,EAAgBC,GAAqB7F,WAAS,CACnDlH,MAAM,EACNgN,eAAe,EACfC,aAAa,EACbC,aAAa,EACbC,YAAY,EACZC,QAAQ,KAGHC,EAAcC,GAAmBpG,EAAAA,UAAS,IAC1CqG,EAAiBC,GAAsBtG,EAAAA,UAAS,IAEhDuG,EAAYC,GAAiBxG,EAAAA,UAAS,IAGtCyG,EAAcC,GAAmB1G,EAAAA,SAI9B,OAGH2G,EAASC,GAAc5G,EAAAA,SAA6B,KACpD6G,EAAgBC,GAAqB9G,EAAAA,UAAS,GAErDI,EAAAA,UAAU,KACHuE,IACLoC,IACAC,IACAC,MAEC,CAACtC,IAEJvE,EAAAA,UAAU,KAER4E,EAAqBkC,GAAUA,GAAQA,EAAK7D,cAAgB4B,EAAaiC,EAAO,MAE7D,iBAAfjC,GACFK,EAAgB,IAChBE,EAAmB,IACnBG,EAAY,KACY,SAAfV,GACTO,EAAmB,KAGpB,CAACP,IAEJ7E,EAAAA,UAAU,KACR,IAAKiF,EAGH,OAFAM,EAAY,SACZH,EAAmB,IAGrB2B,EAAc9B,IAEb,CAACA,IAEJ,MAAM0B,EAAiBjR,UACrB,IACE,MAAMI,KAAEA,EAAAE,MAAMA,SAAgBE,EAC3BC,KAAK,oBACLC,OAAO,KACPC,GAAG,kBAAmBkO,GACtBzN,MAAM,QAET,GAAId,EAAO,MAAMA,EACjB0O,EAAc5O,GAAQ,GACxB,OAASuF,GACPgF,QAAQrK,MAAM,mDAAoDqF,GAClEqJ,EAAa,GACf,GAGIkC,EAAalR,UACjB,IACEsQ,GAAgB,GAChB,MAAMlQ,KAAEA,EAAAE,MAAMA,SAAgBE,EAC3BC,KAAK,SACLC,OAAO,YACPC,GAAG,kBAAmBkO,GACtBzN,MAAM,QAET,GAAId,EAAO,MAAMA,EACjBsP,EAAUxP,GAAQ,GACpB,OAASuF,GACPgF,QAAQrK,MAAM,+CAAgDqF,GAC9DiK,EAAS,GACX,CAAA,QACEU,GAAgB,EAClB,GAGIe,EAAgBrR,MAAO+J,IAC3B,IACEyG,GAAmB,GACnBX,EAAY,IACZH,EAAmB,IAEnB,MAAMtP,KAAEA,EAAAE,MAAMA,SAAgBE,EAC3BC,KAAK,2BACLC,OAAO,kCACPC,GAAG,UAAWoJ,GAEjB,GAAIzJ,EAAO,MAAMA,EAEjB,MAAMgR,GACJ,MAAAlR,OAAA,EAAAA,EAAM6B,IAAKG,UAAY,MAAA,CACrBiG,GAAIjG,EAAEmP,QACNhJ,MAAO,OAAAjB,EAAAlF,EAAEoP,YAAF,EAAAlK,EAAiBiB,OAAQ,eAC3B,GAET+I,EAAYtK,KAAK,CAACC,EAAGC,IAAMD,EAAEsB,KAAKkJ,cAAcvK,EAAEqB,KAAM,OACxDsH,EAAYyB,EACd,OAAS3L,GACPgF,QAAQrK,MAAM,kDAAmDqF,GACjEkK,EAAY,GACd,CAAA,QACEW,GAAmB,EACrB,GAGIW,EAAenR,UACnB,IACEgR,GAAkB,GAClB,MAAM5Q,KAAEA,QAAME,SAAgBE,EAC3BC,KAAK,kBACLC,OACC,mHAEDC,GAAG,kBAAmBkO,GACtBzN,MAAM,aAAc,CAAEC,WAAW,IACjCoJ,MAAM,IAET,GAAInK,EAAO,MAAMA,EACjBwQ,EAAY1Q,GAAQ,GACtB,OAASuF,GACPgF,QAAQrK,MAAM,iDAAkDqF,GAChEmL,EAAW,GACb,CAAA,QACEE,GAAkB,EACpB,GAGIU,EAAYC,EAAAA,QAAQ,IACnBtC,EAAUpO,OAAUoO,EAAUlO,KAC/BkO,EAAUpO,MAAQoO,EAAUlO,IAAY,oBADG,KAG9C,CAACkO,EAAUpO,MAAOoO,EAAUlO,MAEzByQ,EAAkBD,EAAAA,QAAQ,KAC9B,IAAKtC,EAAUpO,QAAUoO,EAAUlO,IAAK,MAAO,uBAC/C,GAAIuQ,EAAW,OAAOA,EAEtB,GAAmB,SAAfvC,IAA0BI,EAAc,MAAO,eACnD,GAAmB,eAAfJ,EAA6B,CAC/B,IAAKI,EAAc,MAAO,eAC1B,IAAKE,EAAiB,MAAO,gBAC/B,CAGA,OADoBoC,OAAOtK,OAAOuI,GAAgBgC,KAAKjP,SAGhD,KAFkB,sBAGxB,CAACwM,EAAUpO,MAAOoO,EAAUlO,IAAKuQ,EAAWvC,EAAYI,EAAcE,EAAiBK,IAEpFiC,GAAetB,IAAemB,EAyE9BI,EAAcC,IAClBC,OAAOC,KAAKF,EAAK,SAAU,wBAGvBG,EAAW3G,IACf,OAAQA,GACN,IAAK,aACH,SAAO4G,IAACC,EAAA,CAAKC,UAAU,YACzB,IAAK,OACH,SAAOF,IAACG,EAAA,CAAMD,UAAU,YAC1B,IAAK,eACH,SAAOF,IAACI,EAAA,CAAUF,UAAU,YAC9B,QACE,SAAOF,IAACK,EAAA,CAASH,UAAU,cAI3BI,EAAsC,CAC1C3P,KAAM,OACNgN,cAAe,WACfC,YAAa,UACbC,YAAa,QACbC,WAAY,QACZC,OAAQ,QAGJwC,GAAe/M,IACnB,MAAMgN,EAAO,iCACb,MAAU,cAANhN,EAA0B,GAAGgN,yEACvB,WAANhN,EAAuB,GAAGgN,iEACvB,GAAGA,mEAGZ,SACEC,KAAC,MAAA,CAAIP,UAAU,4DACbQ,SAAA,GAAAD,KAAC,MAAA,CAAIP,UAAU,0BACbQ,SAAA,GAAAV,IAACK,EAAA,CAASH,UAAU,6CACpBF,EAAAA,IAAC,KAAA,CAAGE,UAAU,sDAAsDQ,SAAA,mBAItED,KAAC,MAAA,CAAIP,UAAU,YAEbQ,SAAA,CAAAD,OAAC,MAAA,CACCC,SAAA,CAAAV,EAAAA,IAAC,QAAA,CAAME,UAAU,kEAAkEQ,SAAA,YAGnFV,EAAAA,IAAC,MAAA,CAAIE,UAAU,yBACXQ,SAAA,CAAC,aAAc,OAAQ,gBAA0B9Q,IAAKwJ,GACtDqH,EAAAA,KAAC,SAAA,CAECrH,KAAK,SACLuH,QAAS,IAAM5D,EAAc3D,GAC7B8G,UAAW,+EACTpD,IAAe1D,EACX,iDACA,yFAGLsH,SAAA,CAAAX,EAAQ3G,GACT4G,EAAAA,IAAC,OAAA,CAAKE,UAAU,oDACbQ,SAAS,eAATtH,EAAwB,KAAgB,SAATA,EAAkB,MAAQ,SAXvDA,SAmBZsD,EAAUxN,OAAS,KAClBuR,KAAC,MAAA,CACCC,SAAA,CAAAV,EAAAA,IAAC,QAAA,CAAME,UAAU,kEAAkEQ,SAAA,eAGnFD,EAAAA,KAAC,SAAA,CACCG,aAAOhE,WAAkB5G,KAAM,GAC/B6K,SAAWvN,IACT,MAAMwN,EAAWpE,EAAUqE,KAAMC,GAAMA,EAAEhL,KAAO1C,EAAE2N,OAAOL,OACzD/D,EAAoBiE,GAAY,MAC5BA,GAAU/D,EAAc+D,EAAS5F,cAEvCgF,UAAU,4IAEVQ,SAAA,CAAAV,EAAAA,IAAC,SAAA,CAAOY,MAAM,GAAGF,SAAA,aAChBhE,EAAU9M,IAAKkR,GACdd,EAAAA,IAAC,SAAA,CAAyBY,MAAOE,EAAS9K,GACvC0K,SAAAI,EAAS5K,MADC4K,EAAS9K,kBAS7B,MAAA,CACC0K,SAAA,GAAAD,KAAC,QAAA,CAAMP,UAAU,kEACfQ,SAAA,GAAAV,IAACkB,EAAA,CAAShB,UAAU,wBAAwB,UAG9CO,KAAC,MAAA,CAAIP,UAAU,yBACbQ,SAAA,CAAAD,OAAC,MAAA,CACCC,SAAA,CAAAV,EAAAA,IAAC,QAAA,CAAME,UAAU,sDAAsDQ,SAAA,QACvEV,EAAAA,IAAC,QAAA,CACC5G,KAAK,OACLwH,MAAO5D,EAAUpO,MACjBiS,SAAWvN,GAAM2J,EAAa,IAAKD,EAAWpO,MAAO0E,EAAE2N,OAAOL,QAC9DV,UAAU,wJAGb,MAAA,CACCQ,SAAA,CAAAV,EAAAA,IAAC,QAAA,CAAME,UAAU,sDAAsDQ,SAAA,QACvEV,EAAAA,IAAC,QAAA,CACC5G,KAAK,OACLwH,MAAO5D,EAAUlO,IACjB+R,SAAWvN,GAAM2J,EAAa,IAAKD,EAAWlO,IAAKwE,EAAE2N,OAAOL,QAC5DV,UAAU,oJAIfb,KAAaW,IAAC,MAAA,CAAIE,UAAU,8CAA+CQ,SAAArB,QAI7D,SAAfvC,GAAwC,eAAfA,WACxB,MAAA,CACC4D,SAAA,CAAAV,EAAAA,IAAC,QAAA,CAAME,UAAU,kEAAkEQ,SAAA,QACnFD,EAAAA,KAAC,SAAA,CACCG,MAAO1D,EACP2D,SAAWvN,GAAM6J,EAAgB7J,EAAE2N,OAAOL,OAC1CV,UAAU,4IACViB,SAAUnD,EAEV0C,SAAA,CAAAV,MAAC,SAAA,CAAOY,MAAM,GAAIF,SAAA1C,EAAe,SAAW,WAC3CV,EAAM1N,IAAK4J,GACVwG,EAAAA,IAAC,SAAA,CAAqBY,MAAOpH,EAAKxD,GAC/B0K,SAAAlH,EAAKtD,MADKsD,EAAKxD,WASV,eAAf8G,GAA+BI,KAC9BuD,KAAC,MAAA,CACCC,SAAA,CAAAV,EAAAA,IAAC,QAAA,CAAME,UAAU,kEAAkEQ,SAAA,UAGnFD,EAAAA,KAAC,SAAA,CACCG,MAAOxD,EACPyD,SAAWvN,GAAM+J,EAAmB/J,EAAE2N,OAAOL,OAC7CV,UAAU,4IACViB,SAAUjD,EAEVwC,SAAA,CAAAV,MAAC,SAAA,CAAOY,MAAM,GAAIF,SAAAxC,EAAkB,SAAW,aAC9CxE,EAAS9J,IAAK5B,GACbgS,EAAAA,IAAC,SAAA,CAAwBY,MAAO5S,EAAQgI,GACrC0K,SAAA1S,EAAQkI,MADElI,EAAQgI,kBAS5B,MAAA,CACC0K,SAAA,GAAAD,KAAC,QAAA,CAAMP,UAAU,kEACfQ,SAAA,GAAAV,IAACoB,EAAA,CAAOlB,UAAU,wBAAwB,iBAG3C,MAAA,CAAIA,UAAU,yBACZQ,SAAAlB,OAAO6B,QAAQ5D,GAAgB7N,IAAI,EAAEtD,EAAKsU,KACzCH,EAAAA,KAAC,QAAA,CAAgBP,UAAU,yCACzBQ,SAAA,CAAAV,EAAAA,IAAC,QAAA,CACC5G,KAAK,WACLkI,QAASV,EACTC,SAAWvN,GAAMoK,EAAkB,IAAKD,EAAgBnR,CAACA,GAAMgH,EAAE2N,OAAOK,UACxEpB,UAAU,sDAEZF,EAAAA,IAAC,OAAA,CAAKE,UAAU,2CACbQ,SAAAJ,EAAYhU,IAAQA,EAAIiV,QAAQ,KAAM,SAR/BjV,SAgBlBmU,EAAAA,KAAC,SAAA,CACCrH,KAAK,SACLuH,QArQehT,UACrB,GAAI4R,EACFM,OAAO2B,MAAMjC,OADf,CAKAlB,GAAc,GACdE,EAAgB,MAEhB,IAEE,MAAMkD,EAAa,CACjBvG,YAAa4B,EACb4E,WAAY1E,EACZ1B,QAAwB,iBAAfwB,EAAgC,KAAOI,EAChDyE,WAA2B,eAAf7E,EAA8BM,EAAkB,KAC5DwE,QAASnE,IAGH1P,KAAM8T,EAAS5T,MAAO6T,SAAoB3T,EAC/CC,KAAK,kBACLyN,OAAO,CACNkG,gBAAiBvF,EACjBwF,mBAAapF,WAAkB5G,KAAM,KACrCkF,YAAa4B,EACbmF,aAAcxF,EACdgF,aACAS,OAAQ,YAET7T,OAAO,MACPE,SAEH,GAAIuT,EAAW,MAAMA,EACrB,MAAMK,EAAkB,MAAAN,OAAA,EAAAA,EAAS7L,GACjC,IAAKmM,EAAiB,MAAM,IAAI3T,MAAM,mCAItC,MAAQT,KAAMqU,EAAQnU,MAAOoU,SAAgBlU,EAASmU,UAAUC,OAAO,kBAAmB,CACxFC,KAAM,CAAEC,kBAAmBN,KAG7B,GAAIE,EAEF,MADA/J,QAAQrK,MAAM,0CAA2CoU,GACnDA,EAIR,MAAMlN,EAAS,CACbsN,kBAAmBN,EACnBO,kBAAYN,WAAQM,aAAc,KAClCC,iBAAWP,WAAQO,YAAa,MAElCpE,EAAgBpJ,SAEV2J,IAEF3J,EAAOuN,WACT7C,OAAO2B,MAAM,6BAEb3B,OAAO2B,MAAM,6CAEjB,OAASlO,GACPgF,QAAQrK,MAAM,mDAAoDqF,GAClEuM,OAAO2B,MAAM,kBAAiB,MAAAlO,OAAA,EAAAA,EAAGiF,UAAWjF,WACtCwL,GACR,CAAA,QACET,GAAc,EAChB,CAhEA,GAkQM8C,UAAWzB,EACXQ,UAAU,uLAEVQ,SAAA,GAAAV,IAAC4C,EAAA,CAAS1C,UAAU,YACnB9B,EAAa,SAAW,aAG1BmB,GACCkB,EAAAA,KAAC,MAAA,CAAIP,UAAU,2CAA2CQ,SAAA,CAAA,KAAGnB,KAI9DjB,GACCmC,EAAAA,KAAC,MAAA,CAAIP,UAAU,4FACbQ,SAAA,GAAAD,KAAC,MAAA,CAAIP,UAAU,2CACbQ,SAAA,CAAAV,EAAAA,IAAC,MAAA,CAAIE,UAAU,qBAAqBQ,SAAA,cACpCD,KAAC,MAAA,CAAIP,UAAU,YAAYQ,SAAA,CAAA,sBAAoBpC,EAAamE,qBAC3DnE,EAAaqE,WAAalC,OAAC,MAAA,CAAIP,UAAU,YAAYQ,SAAA,CAAA,cAAYpC,EAAaqE,sBAGhF,MAAA,CAAIzC,UAAU,4BACZQ,SAAApC,EAAaoE,WACZjC,EAAAA,KAAAoC,EAAAA,SAAA,CACEnC,SAAA,CAAAD,EAAAA,KAAC,SAAA,CACCrH,KAAK,SACLuH,QAAS,IAAMhB,EAAWrB,EAAaoE,YACvCxC,UAAU,6FAEVQ,SAAA,GAAAV,IAAC8C,EAAA,CAAa5C,UAAU,YAAY,aAGtCO,EAAAA,KAAC,IAAA,CACCsC,KAAMzE,EAAaoE,WACnBxC,UAAU,0FACVe,OAAO,SACP+B,IAAI,aAEJtC,SAAA,GAAAV,IAAC4C,EAAA,CAAS1C,UAAU,YAAY,eAKpCF,EAAAA,IAAC,MAAA,CAAIE,UAAU,+CAA+CQ,+DAUxED,KAAC,MAAA,CAAIP,UAAU,qDACbQ,SAAA,GAAAD,KAAC,MAAA,CAAIP,UAAU,yCACbQ,SAAA,CAAAV,EAAAA,IAAC,KAAA,CAAGE,UAAU,8CAA8CQ,SAAA,kBAC5DD,EAAAA,KAAC,SAAA,CACCrH,KAAK,SACLuH,QAAS7B,EACTqC,SAAUzC,EACVwB,UAAU,sIAEVQ,SAAA,GAAAV,IAACiD,EAAA,CAAW/C,UAAU,YAAY,WAKrCxB,QACE,MAAA,CAAIwB,UAAU,2CAA2CQ,SAAA,WACrC,IAAnBlC,EAAQtP,SACV8Q,IAAC,OAAIE,UAAU,2CAA2CQ,SAAA,gBAE1DV,IAAC,MAAA,CAAIE,UAAU,YACZQ,SAAAlC,EAAQ5O,IAAK4C,GACZiO,EAAAA,KAAC,MAAA,CAECP,UAAU,4FAEVQ,SAAA,GAAAD,KAAC,MAAA,CAAIP,UAAU,0CACbQ,SAAA,GAAAD,KAAC,MAAA,CAAIP,UAAU,UACbQ,SAAA,GAAAD,KAAC,MAAA,CAAIP,UAAU,0BACbQ,SAAA,CAAAV,EAAAA,IAAC,QAAKE,UAAWK,GAAY/N,EAAE0P,QAAUxB,WAAEwB,eAC1C,OAAA,CAAKhC,UAAU,2CACbQ,SAAAlO,EAAE0I,YAAYgI,qBAGnBzC,KAAC,MAAA,CAAIP,UAAU,0DAA0DQ,SAAA,CAAA,OAClElO,EAAEwD,SAIXgK,EAAAA,IAAC,MAAA,CAAIE,UAAU,0BACZQ,WAAEgC,WACDjC,EAAAA,KAAC,SAAA,CACCrH,KAAK,SACLuH,QAAS,IAAMhB,EAAWnN,EAAEkQ,YAC5BxC,UAAU,6FAEVQ,SAAA,GAAAV,IAAC4C,EAAA,CAAS1C,UAAU,YAAY,QAIlCO,EAAAA,KAAC,SAAA,CACCrH,KAAK,SACL+H,UAAQ,EACRjB,UAAU,gJAEVQ,SAAA,GAAAV,IAAC4C,EAAA,CAAS1C,UAAU,YAAY,aAOvC1N,EAAE2Q,eACDnD,EAAAA,IAAC,OAAIE,UAAU,8CACZQ,WAAEyC,kBAIP1C,KAAC,MAAA,CAAIP,UAAU,sFACbQ,SAAA,CAAAD,OAAC,MAAA,CAAIC,SAAA,CAAA,YAAUlO,EAAE4Q,qBAChB,MAAA,CAAI1C,SAAA,CAAA,cAAYlO,EAAE6Q,cAAgB,SACnC5C,KAAC,MAAA,CAAIP,UAAU,YAAYQ,SAAA,CAAA,cAAYlO,EAAEmQ,WAAa,YAhDnDnQ,EAAEwD,YAyDvB,CCrlBO,SAASsN,GAAwB9G,eAAEA,EAAAC,OAAgBA,IACxD,MAAO9E,EAASC,GAAcC,EAAAA,SAA8B,KACrDC,EAASC,GAAcF,EAAAA,UAAS,IAChCtH,EAAQgT,GAAa1L,EAAAA,SAAqD,OAEjFI,EAAAA,UAAU,KACRC,KACC,CAACsE,EAAgBjM,IAEpB,MAAM2H,EAAevK,UACnB,IACEoK,GAAW,GAEX,IAAIyL,EAAQrV,EACTC,KAAK,kBACLC,OAAO,oFAIPC,GAAG,kBAAmBkO,GACtBzN,MAAM,aAAc,CAAEC,WAAW,IACjCoJ,MAAM,IAEM,QAAX7H,IACFiT,EAAQA,EAAMlV,GAAG,SAAUiC,IAG7B,MAAMxC,KAAEA,EAAAE,MAAMA,SAAgBuV,EAE9B,GAAIvV,EAAO,MAAMA,EACjB2J,EAAW7J,GAAQ,GACrB,OAASE,GACPqK,QAAQrK,MAAM,0BAA2BA,EAC3C,CAAA,QACE8J,GAAW,EACb,GAoBI0L,EAAiBvB,IACrB,OAAQA,GACN,IAAK,YACH,SAAOlC,IAAC0D,EAAA,CAAYxD,UAAU,+CAChC,IAAK,SACH,SAAOF,IAACxT,EAAA,CAAQ0T,UAAU,2CAC5B,QACE,SAAOF,IAAC2D,EAAA,CAAMzD,UAAU,mDAIxB0D,EAAe1B,IACnB,OAAQA,GACN,IAAK,YACH,MAAO,mCACT,IAAK,SACH,MAAO,+BACT,QACE,MAAO,uCAIP2B,EAAiB3B,IACrB,OAAQA,GACN,IAAK,YACH,MAAO,KACT,IAAK,SACH,MAAO,KACT,QACE,MAAO,QAeP4B,EAAqB1K,IACzB,OAAQA,GACN,IAAK,aACH,MAAO,SACT,IAAK,OACH,MAAO,UACT,IAAK,eACH,MAAO,SACT,QACE,MAAO,SAIb,OAAItB,EAEAkI,MAAC,OAAIE,UAAU,wCACbQ,eAAC,MAAA,CAAIR,UAAU,uEAMnBO,KAAC,MAAA,CAAIP,UAAU,kDACbQ,SAAA,GAAAD,KAAC,MAAA,CAAIP,UAAU,yCACbQ,SAAA,GAAAD,KAAC,MAAA,CAAIP,UAAU,0BACbQ,SAAA,GAAAV,IAACK,EAAA,CAASH,UAAU,iDACpBF,EAAAA,IAAC,KAAA,CAAGE,UAAU,sDAAsDQ,SAAA,cAItEV,EAAAA,IAAC,SAAA,CACCW,QAASzI,EACTgI,UAAU,6GACV/E,MAAM,KAENuF,SAAAV,EAAAA,IAAC+D,EAAA,CAAU7D,UAAU,mBAKzBF,IAAC,MAAA,CAAIE,UAAU,kBACXQ,SAAA,CAAC,MAAO,YAAa,UAAW,UAAoB9Q,IAAKsS,GACzDlC,EAAAA,IAAC,SAAA,CAECW,QAAS,IAAM4C,EAAUrB,GACzBhC,UAAW,mDACT3P,IAAW2R,EACP,2BACA,0GAGLxB,SAAW,QAAXwB,EAAmB,MAAQ2B,EAAc3B,IARrCA,MAcS,IAAnBvK,EAAQzI,OACPuR,EAAAA,KAAC,MAAA,CAAIP,UAAU,qDACbQ,SAAA,GAAAV,IAACK,EAAA,CAASH,UAAU,wCACpBF,IAAC,KAAEU,SAAA,0BAGJ,MAAA,CAAIR,UAAU,YACZQ,SAAA/I,EAAQ/H,IAAKkK,UA3EFkK,EA4EVhE,OAAAA,EAAAA,IAAC,MAAA,CAECE,UAAW,2BAA2B0D,EAAY9J,EAAOoI,+CAEzDxB,SAAAD,EAAAA,KAAC,MAAA,CAAIP,UAAU,mCACbQ,SAAA,GAAAD,KAAC,MAAA,CAAIP,UAAU,SACbQ,SAAA,GAAAD,KAAC,MAAA,CAAIP,UAAU,+BACZQ,SAAA,CAAA+C,EAAc3J,EAAOoI,cACrB,KAAA,CAAGhC,UAAU,8CACXQ,SAAAoD,EAAkBhK,EAAOoB,qBAE3B,OAAA,CAAKgF,UAAU,2CACbQ,UAxFDsD,EAwFYlK,EAAOsJ,WAvFxB,IAAInT,KAAK+T,GACVC,eAAe,QAAS,CAClCC,KAAM,UACNC,MAAO,QACPC,IAAK,UACLC,KAAM,UACNC,OAAQ,oBAqFI7D,KAAC,MAAA,CAAIP,UAAU,uEACbQ,SAAA,CAAAD,OAAC,MAAA,CACCC,SAAA,CAAAV,EAAAA,IAAC,OAAA,CAAKE,UAAU,cAAcQ,SAAA,WAC7B,OAAAzL,EAAA6E,EAAOqF,YAAP,EAAAlK,EAAciB,OAAQ,oBAExB,MAAA,CACCwK,SAAA,CAAAV,EAAAA,IAAC,OAAA,CAAKE,UAAU,cAAcQ,SAAA,YAC7BmD,EAAc/J,EAAOoI,cAIzBpI,EAAO2H,YAAcjC,OAAO+E,KAAKzK,EAAO2H,YAAYvS,OAAS,KAC5DuR,KAAC,MAAA,CAAIP,UAAU,2CACbQ,SAAA,CAAAV,EAAAA,IAAC,OAAA,CAAKE,UAAU,cAAcQ,SAAA,YAC7B5G,EAAO2H,WAAWC,cACjBjB,KAAC,OAAA,CACEC,SAAA,CAAA5G,EAAO2H,WAAWC,WAAW9S,MAAM,MAAIkL,EAAO2H,WAAWC,WAAW5S,UAM5EgL,EAAOqJ,eACN1C,OAAC,MAAA,CAAIP,UAAU,wFAAwFQ,SAAA,CAAA,QAC/F5G,EAAOqJ,sBAKnB1C,KAAC,MAAA,CAAIP,UAAU,kBACZQ,SAAA,CAAkB,cAAlB5G,EAAOoI,QACNlC,EAAAA,IAAC,SAAA,CACCW,QAAS,IAAMa,MAAM,mBACrBtB,UAAU,gHACV/E,MAAM,SAENuF,SAAAV,EAAAA,IAAC4C,EAAA,CAAS1C,UAAU,cAGxBF,EAAAA,IAAC,SAAA,CACCW,QAAS,IAtLNhT,OAAOqI,IAC1B,GAAKwO,QAAQ,kBAEb,IACE,MAAMvW,MAAEA,SAAgBE,EACrBC,KAAK,kBACLiO,SACA/N,GAAG,KAAM0H,GAEZ,GAAI/H,EAAO,MAAMA,EACjB2J,EAAWD,EAAQpH,OAAQ5D,GAAMA,EAAEqJ,KAAOA,GAC5C,OAAS/H,GACPqK,QAAQrK,MAAM,yBAA0BA,GACxCuT,MAAM,iBACR,GAwK+BpF,CAAatC,EAAO9D,IACnCkK,UAAU,4GACV/E,MAAM,KAENuF,SAAAV,EAAAA,IAACyE,EAAA,CAAOvE,UAAU,qBA3DnBpG,EAAO9D,UAqE1B,CC1OO,SAAS0O,GAA0BlI,eAAEA,EAAAC,OAAgBA,IAC1D,MAAOkI,EAAkBC,GAAuB/M,EAAAA,SAA4B,KACrEgN,EAAUC,GAAejN,EAAAA,UAAS,IAClCkN,EAAeC,GAAoBnN,EAAAA,SAAiC,OACpEC,EAASC,GAAcF,EAAAA,UAAS,IAEhCoN,EAAUC,GAAerN,WAAS,CACvC3B,KAAM,GACNiP,cAAe,SACfC,YAAa,IACbC,aAAc,IACdC,KAAM,QACNC,WAAY,KAGdtN,EAAAA,UAAU,KACRuN,KACC,CAAChJ,IAEJ,MAAMgJ,EAAwB7X,UAC5B,IACEoK,GAAW,GACX,MAAMhK,KAAEA,EAAAE,MAAMA,SAAgBE,EAC3BC,KAAK,qBACLC,OAAO,KACPC,GAAG,kBAAmBkO,GACtBzN,MAAM,QAET,GAAId,EAAO,MAAMA,EACjB2W,EAAoB7W,GAAQ,GAC9B,OAASE,GACPqK,QAAQrK,MAAM,oCAAqCA,EACrD,CAAA,QACE8J,GAAW,EACb,GAqGI0N,EAAmB3L,IACvB,MAAM4L,EAAS5L,EAAO6L,gBAChBL,EAAOI,EAAOJ,MAAQ,QAE5B,OAAQxL,EAAOqL,eACb,IAAK,QACH,MAAO,MAAMG,IACf,IAAK,SAGH,MAAO,KAFM,CAAC,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,KAC1BI,EAAON,aAAe,QACPE,IACnC,IAAK,UAEH,MAAO,KADYI,EAAOL,cAAgB,MACfC,IAC7B,QACE,MAAO,OAIb,OAAIxN,EAEAkI,MAAC,OAAIE,UAAU,wCACbQ,eAAC,MAAA,CAAIR,UAAU,wEAMnBO,KAAC,MAAA,CAAIP,UAAU,kDACbQ,SAAA,GAAAD,KAAC,MAAA,CAAIP,UAAU,yCACbQ,SAAA,GAAAD,KAAC,MAAA,CAAIP,UAAU,0BACbQ,SAAA,GAAAV,IAACkB,EAAA,CAAShB,UAAU,+CACpBF,EAAAA,IAAC,KAAA,CAAGE,UAAU,sDAAsDQ,SAAA,kBAItED,EAAAA,KAAC,SAAA,CACCE,QAAS,IAAMmE,GAAY,GAC3B5E,UAAU,4GAEVQ,SAAA,GAAAV,IAAC4F,EAAA,CAAK1F,UAAU,YAAY,aAK/B2E,KACCpE,KAAC,OAAA,CAAKoF,SAhJSlY,MAAO2F,IAC1BA,EAAEwS,iBAEF,IACE,MAAMC,EAAsC,CAC1CT,KAAML,EAASK,MAGc,WAA3BL,EAASE,cACXY,EAAeX,YAAcY,SAASf,EAASG,aACX,YAA3BH,EAASE,gBAClBY,EAAeV,aAAeW,SAASf,EAASI,eAGlD,MAAME,EAAaN,EAASM,WACzBU,MAAM,KACNrW,IAAKwG,GAAUA,EAAM8P,QACrB3V,OAAQ6F,GAAUA,IAEbrI,KAAMoY,SAAsBhY,EAASiY,IAAI,qBAAsB,CACrEC,gBAAiBpB,EAASE,cAC1BmB,kBAAmBP,IAGfxM,EAAa,CACjBwI,gBAAiBvF,EACjBwF,YAAaxF,EACbtG,KAAM+O,EAAS/O,KACfiP,cAAeF,EAASE,cACxBQ,gBAAiBI,EACjBR,aACAgB,SAAUJ,EACVK,WAAY/J,GAGd,GAAIsI,EAAe,CACjB,MAAM9W,MAAEA,SAAgBE,EACrBC,KAAK,qBACL6N,OAAO1C,GACPjL,GAAG,KAAMyW,EAAc/O,IAE1B,GAAI/H,EAAO,MAAMA,CACnB,KAAO,CACL,MAAMA,MAAEA,SAAgBE,EACrBC,KAAK,qBACLyN,OAAOtC,GAEV,GAAItL,EAAO,MAAMA,CACnB,CAEA6W,GAAY,GACZE,EAAiB,MACjBE,EAAY,CACVhP,KAAM,GACNiP,cAAe,SACfC,YAAa,IACbC,aAAc,IACdC,KAAM,QACNC,WAAY,KAEdC,GACF,OAASvX,GACPqK,QAAQrK,MAAM,iCAAkCA,GAChDuT,MAAM,mBACR,GAgFkCtB,UAAU,kDACtCQ,SAAA,CAAAV,MAAC,KAAA,CAAGE,UAAU,mDACXQ,SAAAqE,EAAgB,WAAa,eAGhCtE,KAAC,MAAA,CAAIP,UAAU,YACbQ,SAAA,CAAAD,OAAC,MAAA,CACCC,SAAA,CAAAV,EAAAA,IAAC,QAAA,CAAME,UAAU,kEAAkEQ,SAAA,YAGnFV,EAAAA,IAAC,QAAA,CACC5G,KAAK,OACLqN,UAAQ,EACR7F,MAAOqE,EAAS/O,KAChB2K,SAAWvN,GAAM4R,EAAY,IAAKD,EAAU/O,KAAM5C,EAAE2N,OAAOL,QAC3DV,UAAU,yJAIb,MAAA,CACCQ,SAAA,CAAAV,EAAAA,IAAC,QAAA,CAAME,UAAU,kEAAkEQ,SAAA,OAGnFD,EAAAA,KAAC,SAAA,CACCG,MAAOqE,EAASE,cAChBtE,SAAWvN,GACT4R,EAAY,IAAKD,EAAUE,cAAe7R,EAAE2N,OAAOL,QAErDV,UAAU,6IAEVQ,SAAA,CAAAV,EAAAA,IAAC,SAAA,CAAOY,MAAM,QAAQF,SAAA,OACtBV,EAAAA,IAAC,SAAA,CAAOY,MAAM,SAASF,SAAA,OACvBV,EAAAA,IAAC,SAAA,CAAOY,MAAM,UAAUF,SAAA,aAIA,WAA3BuE,EAASE,iBACR1E,KAAC,MAAA,CACCC,SAAA,CAAAV,EAAAA,IAAC,QAAA,CAAME,UAAU,kEAAkEQ,SAAA,OAGnFD,EAAAA,KAAC,SAAA,CACCG,MAAOqE,EAASG,YAChBvE,SAAWvN,GAAM4R,EAAY,IAAKD,EAAUG,YAAa9R,EAAE2N,OAAOL,QAClEV,UAAU,6IAEVQ,SAAA,CAAAV,EAAAA,IAAC,SAAA,CAAOY,MAAM,IAAIF,SAAA,QAClBV,EAAAA,IAAC,SAAA,CAAOY,MAAM,IAAIF,SAAA,QAClBV,EAAAA,IAAC,SAAA,CAAOY,MAAM,IAAIF,SAAA,QAClBV,EAAAA,IAAC,SAAA,CAAOY,MAAM,IAAIF,SAAA,QAClBV,EAAAA,IAAC,SAAA,CAAOY,MAAM,IAAIF,SAAA,QAClBV,EAAAA,IAAC,SAAA,CAAOY,MAAM,IAAIF,SAAA,QAClBV,EAAAA,IAAC,SAAA,CAAOY,MAAM,IAAIF,SAAA,cAKI,YAA3BuE,EAASE,iBACR1E,KAAC,MAAA,CACCC,SAAA,CAAAV,EAAAA,IAAC,QAAA,CAAME,UAAU,kEAAkEQ,SAAA,OAGnFV,EAAAA,IAAC,QAAA,CACC5G,KAAK,SACLpI,IAAI,IACJvB,IAAI,KACJmR,MAAOqE,EAASI,aAChBxE,SAAWvN,GAAM4R,EAAY,IAAKD,EAAUI,aAAc/R,EAAE2N,OAAOL,QACnEV,UAAU,yJAKf,MAAA,CACCQ,SAAA,CAAAV,EAAAA,IAAC,QAAA,CAAME,UAAU,kEAAkEQ,SAAA,OAGnFV,EAAAA,IAAC,QAAA,CACC5G,KAAK,OACLwH,MAAOqE,EAASK,KAChBzE,SAAWvN,GAAM4R,EAAY,IAAKD,EAAUK,KAAMhS,EAAE2N,OAAOL,QAC3DV,UAAU,yJAIb,MAAA,CACCQ,SAAA,CAAAV,EAAAA,IAAC,QAAA,CAAME,UAAU,kEAAkEQ,SAAA,uBAGnFV,EAAAA,IAAC,QAAA,CACC5G,KAAK,OACLqN,UAAQ,EACR7F,MAAOqE,EAASM,WAChB1E,SAAWvN,GAAM4R,EAAY,IAAKD,EAAUM,WAAYjS,EAAE2N,OAAOL,QACjE8F,YAAY,uCACZxG,UAAU,oJAIdO,KAAC,MAAA,CAAIP,UAAU,aACbQ,SAAA,CAAAV,EAAAA,IAAC,SAAA,CACC5G,KAAK,SACL8G,UAAU,sFACXQ,SAAA,OAGDV,EAAAA,IAAC,SAAA,CACC5G,KAAK,SACLuH,QAAS,KACPmE,GAAY,GACZE,EAAiB,OAEnB9E,UAAU,+IACXQ,SAAA,mBAQoB,IAA5BiE,EAAiBzV,OAChBuR,EAAAA,KAAC,MAAA,CAAIP,UAAU,qDACbQ,SAAA,GAAAV,IAACkB,EAAA,CAAShB,UAAU,wCACpBF,IAAC,KAAEU,SAAA,iCAGJ,MAAA,CAAIR,UAAU,YACZQ,SAAAiE,EAAiB/U,IAAKkK,GACrB2G,EAAAA,KAAC,MAAA,CAECP,UAAU,+EAEVQ,SAAA,GAAAD,KAAC,MAAA,CAAIP,UAAU,SACbQ,SAAA,CAAAV,EAAAA,IAAC,KAAA,CAAGE,UAAU,mDACXQ,SAAA5G,EAAO5D,SAEVuK,KAAC,MAAA,CAAIP,UAAU,mEACbQ,SAAA,GAAAD,KAAC,MAAA,CAAIP,UAAU,0BACbQ,SAAA,GAAAV,IAAC2D,EAAA,CAAMzD,UAAU,YAChBuF,EAAgB3L,QAEnB2G,KAAC,MAAA,CAAIP,UAAU,0BACbQ,SAAA,GAAAV,IAAC2G,EAAA,CAAKzG,UAAU,YACfpG,EAAOyL,WAAWrW,OAAO,gBAKhCuR,KAAC,MAAA,CAAIP,UAAU,0BACbQ,SAAA,CAAAV,EAAAA,IAAC,SAAA,CACCW,QAAS,IApOJhT,OAAOmM,IAC1B,IACE,MAAM7L,MAAEA,SAAgBE,EACrBC,KAAK,qBACL6N,OAAO,CAAE2K,WAAY9M,EAAO8M,YAC5BtY,GAAG,KAAMwL,EAAO9D,IAEnB,GAAI/H,EAAO,MAAMA,EACjBuX,GACF,OAASvX,GACPqK,QAAQrK,MAAM,yBAA0BA,EAC1C,GAyN6B4Y,CAAa/M,GAC5BoG,UAAW,qCACTpG,EAAO8M,UACH,mFACA,6EAENzL,MAAOrB,EAAO8M,UAAY,MAAQ,MAEjClG,SAAA5G,EAAO8M,UACN5G,EAAAA,IAACzT,EAAA,CAAM2T,UAAU,YAEjBF,EAAAA,IAAC7T,EAAA,CAAS+T,UAAU,cAGxBF,EAAAA,IAAC,SAAA,CACCW,QAAS,IArOJhT,OAAOqI,IAC1B,GAAKwO,QAAQ,oBAEb,IACE,MAAMvW,MAAEA,SAAgBE,EACrBC,KAAK,qBACLiO,SACA/N,GAAG,KAAM0H,GAEZ,GAAI/H,EAAO,MAAMA,EACjBuX,GACF,OAASvX,GACPqK,QAAQrK,MAAM,yBAA0BA,GACxCuT,MAAM,YACR,GAuN6BpF,CAAatC,EAAO9D,IACnCkK,UAAU,4GACV/E,MAAM,KAENuF,SAAAV,EAAAA,IAACyE,EAAA,CAAOvE,UAAU,mBAxCjBpG,EAAO9D,SAiD1B,CChWO,SAAS8Q,GAAWtN,KAAEA,gBAC3B,MAAMuN,KAAEA,GAASC,KACXC,cAAEA,GAAkBC,GAAiB,MAAAH,OAAA,EAAAA,EAAM/Q,KAAM,IACjDwG,EAAiBhD,EAAKuI,kBAAoBkF,EAAc/X,OAAS,EAAI+X,EAAc,GAAGjR,GAAK,KAE3F2B,QAAEA,EAAAG,QAASA,EAAAU,eAASA,EAAAwD,mBAAgBA,EAAAI,aAAoBA,iBAAcE,GAAmB7E,EAAW+B,EAAKxD,KACxGoI,EAAYC,GAAiBxG,EAAAA,UAAS,IACtCsP,EAAmBC,GAAwBvP,EAAAA,UAAS,IACpDwP,EAAgBC,GAAqBzP,EAAAA,SAA+B,WACpE0P,EAAiBC,GAAsB3P,EAAAA,SAAS,KAChD4P,EAAeC,GAAoB7P,EAAAA,SAAS,KAC5C8P,EAAgBC,GAAqB/P,EAAAA,SAAc,OACnDgQ,EAAWC,GAAgBjQ,EAAAA,SAAyD,SA0CrFkQ,EAAqBC,IACzB,OAAQA,GACN,IAAK,OAAQ,MAAO,yBACpB,IAAK,SAAU,MAAO,+BACtB,IAAK,MAAO,MAAO,6BACnB,QAAS,MAAO,6BAIdC,EAAqBD,IACzB,OAAQA,GACN,IAAK,OAAQ,MAAO,OACpB,IAAK,SAAU,MAAO,OACtB,IAAK,MAAO,MAAO,OACnB,QAAS,MAAO,OAIpB,OAAIlQ,EAEAkI,MAAC,OAAIE,UAAU,yCACbQ,eAAC,MAAA,CAAIR,UAAU,uEAMnBO,KAAC,MAAA,CAAIP,UAAU,YAEbQ,SAAA,CAAAV,EAAAA,IAAC,OAAIE,UAAU,oCACbQ,SAAAV,EAAAA,IAAC,MAAA,CAAIE,UAAU,aACZQ,SAAA,CACC,CAAE1K,GAAI,QAASkS,MAAO,SAAUC,KAAM9H,GACtC,CAAErK,GAAI,WAAYkS,MAAO,UAAWC,KAAMC,GAC1C,CAAEpS,GAAI,YAAakS,MAAO,SAAUC,KAAMjH,GAC1C,CAAElL,GAAI,UAAWkS,MAAO,KAAMC,KAAMxE,IACpC/T,IAAKyY,GACL5H,EAAAA,KAAC,SAAA,CAECE,QAAS,IAAMmH,EAAaO,EAAIrS,IAChCkK,UAAW,yFACT2H,IAAcQ,EAAIrS,GACd,yBACA,6EAGN0K,SAAA,GAAAV,IAACqI,EAAIF,KAAJ,CAASjI,UAAU,YACpBF,EAAAA,IAAC,OAAA,CAAKE,UAAU,cAAeQ,WAAIwH,UAT9BG,EAAIrS,SAgBF,aAAd6R,GAA4Bd,GAC3B/G,MAACzD,GAAwBC,iBAAgCC,OAAQsK,EAAK/Q,KAGzD,cAAd6R,GAA6Bd,GAC5B/G,MAAC0E,GAA0BlI,iBAAgCC,OAAQsK,EAAK/Q,KAG3D,YAAd6R,GAA2Bd,GAC1B/G,MAACsD,GAAwB9G,iBAAgCC,OAAQsK,EAAK/Q,KAGzD,UAAd6R,GACCpH,EAAAA,KAAAoC,EAAAA,SAAA,CACEnC,SAAA,GAAAD,KAAC,MAAA,CAAIP,UAAU,oCACbQ,SAAA,GAAAD,KAAC,MAAA,CAAIP,UAAU,yCACbQ,SAAA,CAAAD,OAAC,MAAA,CACCC,SAAA,GAAAD,KAAC,KAAA,CAAGP,UAAU,qDACZQ,SAAA,GAAAV,IAACK,EAAA,CAASH,UAAU,+BAA+B,eAGrDO,KAAC,IAAA,CAAEP,UAAU,qBAAsBQ,SAAA,CAAAlH,EAAKtD,KAAK,yBAE/CuK,KAAC,MAAA,CAAIP,UAAU,8BACbQ,SAAA,CAAAD,EAAAA,KAAC,SAAA,CACCE,QAASrE,EACT4D,UAAU,iHAEVQ,SAAA,GAAAV,IAAC+D,EAAA,CAAU7D,UAAU,cACrBF,IAAC,QAAKU,SAAA,UAERD,EAAAA,KAAC,SAAA,CACCE,QAAS,IAAMyG,GAAqB,GACpClH,UAAU,8GAEVQ,SAAA,GAAAV,IAAC4F,EAAA,CAAK1F,UAAU,cAChBF,IAAC,QAAKU,SAAA,sBAKZD,KAAC,MAAA,CAAIP,UAAU,6CACbQ,SAAA,GAAAD,KAAC,MAAA,CAAIP,UAAU,wCACbQ,SAAA,CAAAV,EAAAA,IAAC,MAAA,CAAIE,UAAU,mCAAoCQ,SAAA/I,EAAQzI,SAC3D8Q,EAAAA,IAAC,MAAA,CAAIE,UAAU,wBAAwBQ,SAAA,kBAEzCD,KAAC,MAAA,CAAIP,UAAU,yCACbQ,SAAA,CAAAV,EAAAA,IAAC,MAAA,CAAIE,UAAU,oCACZQ,SAAA/I,EAAQpH,OAAO5D,GAAKA,EAAEuP,WAAWhN,SAEpC8Q,EAAAA,IAAC,MAAA,CAAIE,UAAU,yBAAyBQ,SAAA,cAE1CD,KAAC,MAAA,CAAIP,UAAU,0CACbQ,SAAA,GAAAV,IAAC,MAAA,CAAIE,UAAU,qCACZQ,SAAA/I,EAAQpH,WAAa5D,EAAEuP,WAAWhN,SAErC8Q,EAAAA,IAAC,MAAA,CAAIE,UAAU,0BAA0BQ,SAAA,aAE3CD,KAAC,MAAA,CAAIP,UAAU,0CACbQ,SAAA,CAAAV,EAAAA,IAAC,MAAA,CAAIE,UAAU,qCACZQ,UAAA,OAAArL,EAAA,OAAAJ,EAAA0C,EAAQ,SAAR,EAAA1C,EAAYuG,mBAAZ,EAAAnG,EAA0BuE,gBAAiB,IAE9CoG,EAAAA,IAAC,MAAA,CAAIE,UAAU,0BAA0BQ,SAAA,qBAM/CD,KAAC,MAAA,CAAIP,UAAU,oCACbQ,SAAA,CAAAV,EAAAA,IAAC,KAAA,CAAGE,UAAU,2CAA2CQ,SAAA,aAErC,IAAnB/I,EAAQzI,OACPuR,EAAAA,KAAC,MAAA,CAAIP,UAAU,oBACbQ,SAAA,GAAAV,IAACK,EAAA,CAASH,UAAU,yCACpBF,EAAAA,IAAC,KAAA,CAAGE,UAAU,yCAAyCQ,SAAA,eACvDV,EAAAA,IAAC,IAAA,CAAEE,UAAU,qBAAqBQ,SAAA,mCAClCD,EAAAA,KAAC,SAAA,CACCE,QAAS,IAAMyG,GAAqB,GACpClH,UAAU,qHAEVQ,SAAA,GAAAV,IAAC4F,EAAA,CAAK1F,UAAU,cAChBF,IAAC,QAAKU,SAAA,uBAIT,MAAA,CAAIR,UAAU,YACZQ,SAAA/I,EAAQ/H,IAAKkK,GACZkG,EAAAA,IAAC,MAAA,CAECE,UAAW,4DACRpG,EAAOoC,UAA2C,kBAA/B,8BAGtBwE,SAAAD,EAAAA,KAAC,MAAA,CAAIP,UAAU,mCACbQ,SAAA,GAAAD,KAAC,MAAA,CAAIP,UAAU,SACbQ,SAAA,GAAAD,KAAC,MAAA,CAAIP,UAAU,mCACbQ,SAAA,CAAAV,EAAAA,IAAC,KAAA,CAAGE,UAAU,sCAAuCQ,SAAA5G,EAAOqB,SAC1DrB,EAAOoC,iBACN,OAAA,CAAKgE,UAAU,wDAAwDQ,SAAA,YAM5ED,KAAC,MAAA,CAAIP,UAAU,yDACbQ,SAAA,GAAAD,KAAC,OAAA,CAAKP,UAAU,oBACdQ,SAAA,GAAAV,IAACkB,EAAA,CAAShB,UAAU,iBACnBpG,EAAOsB,aAAa,MAAItB,EAAOuB,gBAElCoF,KAAC,OAAA,CAAKP,UAAU,oBACdQ,SAAA,GAAAV,IAAC2D,EAAA,CAAMzD,UAAU,iBAChB,IAAIjQ,KAAK6J,EAAOwO,cAAcrE,eAAe,cAEhDxD,KAAC,OAAA,CAAKP,UAAU,oBACdQ,SAAA,GAAAV,IAACuI,EAAA,CAAIrI,UAAU,iBACdpG,EAAO0O,WAAW,YAItB1O,EAAO0B,cACNiF,OAAC,MAAA,CAAIP,UAAU,6CACbQ,SAAA,GAAAD,KAAC,MAAA,CAAIP,UAAU,yBACbQ,SAAA,CAAAV,EAAAA,IAAC,MAAA,CAAIE,UAAU,wBAAwBQ,SAAA,cACtC,MAAA,CAAIR,UAAU,kCACZQ,SAAA5G,EAAO0B,aAAazB,gBAAkB,SAG3C0G,KAAC,MAAA,CAAIP,UAAU,yBACbQ,SAAA,CAAAV,EAAAA,IAAC,MAAA,CAAIE,UAAU,wBAAwBQ,SAAA,WACvCV,EAAAA,IAAC,MAAA,CAAIE,UAAU,kCACXQ,UAAA5G,EAAO0B,aAAatB,iBAAmB,GAAGO,QAAQ,UAGxDgG,KAAC,MAAA,CAAIP,UAAU,wBACbQ,SAAA,CAAAV,EAAAA,IAAC,MAAA,CAAIE,UAAU,uBAAuBQ,SAAA,WACtCD,KAAC,MAAA,CAAIP,UAAU,iCACZQ,SAAA,CAAA5G,EAAO0B,aAAarB,eAAiB,EAAE,YAG5CsG,KAAC,MAAA,CAAIP,UAAU,2BACbQ,SAAA,CAAAV,EAAAA,IAAC,MAAA,CAAIE,UAAU,0BAA0BQ,SAAA,WACzCD,KAAC,MAAA,CAAIP,UAAU,oCACZQ,SAAA,CAAA5G,EAAO0B,aAAapB,iBAAmB,EAAE,YAG9CqG,KAAC,MAAA,CAAIP,UAAU,2BACbQ,SAAA,CAAAV,EAAAA,IAAC,MAAA,CAAIE,UAAU,0BAA0BQ,SAAA,WACzCD,KAAC,MAAA,CAAIP,UAAU,oCACZQ,SAAA,CAAA5G,EAAO0B,aAAalB,gBAAkB,EAAE,aAMhDR,EAAOS,UAAYT,EAAOS,SAASrL,OAAS,KAC3C8Q,IAAC,MAAA,CAAIE,UAAU,oDACbQ,SAAAD,EAAAA,KAAC,MAAA,CAAIP,UAAU,mBACbQ,SAAA,GAAAV,IAACyI,EAAA,CAAWvI,UAAU,4DACrB,MAAA,CAAIA,UAAU,0BACZQ,SAAA5G,EAAOS,SAAS,eAO3BkG,KAAC,MAAA,CAAIP,UAAU,mCACbQ,SAAA,CAAAV,EAAAA,IAAC,SAAA,CACCW,QAAS,IA9OR,CAAC7G,IACxB8N,EAAkB9N,GAClBkC,EAAmBlC,EAAO9D,KA4OW0S,CAAiB5O,GAChCoG,UAAU,4EACV/E,MAAM,OAENuF,SAAAV,EAAAA,IAACuI,EAAA,CAAIrI,UAAU,cAEjBF,EAAAA,IAAC,SAAA,CACCW,QAAS,IAhPNhT,OAAOoO,IAChC,IAAKyI,QAAQ,wBAAyB,OAEtC,MAAMrP,QAAeiH,EAAaL,GAC9B5G,EAAO2G,QACT0F,MAAM,eAENA,MAAM,QAAQrM,EAAOlH,UAyOc0a,CAAmB7O,EAAO9D,IACzCkK,UAAU,0EACV/E,MAAM,KAENuF,SAAAV,EAAAA,IAACyE,EAAA,CAAOvE,UAAU,qBA3FnBpG,EAAO9D,UAsGzBmR,SACM,MAAA,CAAIjH,UAAU,iFACbQ,SAAAD,EAAAA,KAAC,MAAA,CAAIP,UAAU,+EACbQ,SAAA,CAAAV,EAAAA,IAAC,OAAIE,UAAU,4EACbQ,SAAAD,EAAAA,KAAC,MAAA,CAAIP,UAAU,oCACbQ,SAAA,GAAAD,KAAC,MAAA,CAAIP,UAAU,8BACbQ,SAAA,GAAAV,IAACoI,EAAA,CAAUlI,UAAU,mBACpB,MAAA,CACCQ,SAAA,CAAAV,EAAAA,IAAC,KAAA,CAAGE,UAAU,qBAAqBQ,SAAA,WACnCV,EAAAA,IAAC,IAAA,CAAEE,UAAU,gBAAiBQ,WAAKxK,aAGvC8J,EAAAA,IAAC,SAAA,CACCW,QAAS,IAAMyG,GAAqB,GACpClH,UAAU,mEAEVQ,WAAAV,IAAC,OAAA,CAAKE,UAAU,WAAWQ,SAAA,eAKjCD,KAAC,MAAA,CAAIP,UAAU,gBACbQ,SAAA,CAAAD,OAAC,MAAA,CACCC,SAAA,GAAAD,KAAC,KAAA,CAAGP,UAAU,qDACZQ,SAAA,GAAAV,IAACkB,EAAA,CAAShB,UAAU,+BAA+B,iBAIrDF,IAAC,MAAA,CAAIE,UAAU,6CACZQ,SAAA,CACC,CAAEE,MAAO,SAAUsH,MAAO,OAC1B,CAAEtH,MAAO,UAAWsH,MAAO,OAC3B,CAAEtH,MAAO,YAAasH,MAAO,OAC7B,CAAEtH,MAAO,cAAesH,MAAO,OAC/B,CAAEtH,MAAO,SAAUsH,MAAO,MAC1B,CAAEtH,MAAO,SAAUsH,MAAO,SAC1BtY,IAAK9B,GACLkS,EAAAA,IAAC,SAAA,CAECW,QAAS,IAAM2G,EAAkBxZ,EAAO8S,OACxCV,UAAW,yDACTmH,IAAmBvZ,EAAO8S,MACtB,yBACA,+CAGLF,SAAA5S,EAAOoa,OARHpa,EAAO8S,UAaE,WAAnByG,GACC5G,OAAC,MAAA,CAAIP,UAAU,mDACbQ,SAAA,CAAAD,OAAC,MAAA,CACCC,SAAA,CAAAV,EAAAA,IAAC,QAAA,CAAME,UAAU,+CAA+CQ,SAAA,QAGhEV,EAAAA,IAAC,QAAA,CACC5G,KAAK,OACLwH,MAAO2G,EACP1G,SAAWvN,GAAMkU,EAAmBlU,EAAE2N,OAAOL,OAC7CV,UAAU,2HAGb,MAAA,CACCQ,SAAA,CAAAV,EAAAA,IAAC,QAAA,CAAME,UAAU,+CAA+CQ,SAAA,QAGhEV,EAAAA,IAAC,QAAA,CACC5G,KAAK,OACLwH,MAAO6G,EACP5G,SAAWvN,GAAMoU,EAAiBpU,EAAE2N,OAAOL,OAC3CV,UAAU,4HAOpBO,KAAC,MAAA,CAAIP,UAAU,mDACbQ,SAAA,CAAAV,EAAAA,IAAC,KAAA,CAAGE,UAAU,iCAAiCQ,SAAA,mBAC/CD,KAAC,MAAA,CAAIP,UAAU,kCACbQ,SAAA,GAAAV,IAAC,KAAEU,SAAA,wBACHV,IAAC,KAAEU,SAAA,gBACHV,IAAC,KAAEU,SAAA,sBACHV,IAAC,KAAEU,SAAA,qBACHV,IAAC,KAAEU,SAAA,kBACHV,IAAC,KAAEU,SAAA,kBACHV,IAAC,KAAEU,SAAA,yBAIPD,KAAC,MAAA,CAAIP,UAAU,0CACbQ,SAAA,CAAAV,EAAAA,IAAC,SAAA,CACCW,QAAS,IAAMyG,GAAqB,GACpClH,UAAU,+FACViB,SAAU/C,EACXsC,SAAA,UAGDV,EAAAA,IAAC,SAAA,CACCW,QAjYShT,UAC3B0Q,GAAc,GACd,IACE,MAAMlJ,QAAeqD,EACnBgB,EAAKxD,GACLqR,EACmB,WAAnBA,EAA8BE,OAAkB,EAC7B,WAAnBF,EAA8BI,OAAgB,GAG5CtS,EAAO2G,SACT0F,MAAM,gBACN4F,GAAqB,IAErB5F,MAAM,QAAQrM,EAAOlH,QAEzB,OAASA,GACPqK,QAAQrK,MAAM,2BAA4BA,GAC1CuT,MAAM,gBACR,CAAA,QACEnD,GAAc,EAChB,GA6WkB8C,SAAU/C,GAAkC,WAAnBiJ,KAAiCE,IAAoBE,GAC9EvH,UAAU,kIAETQ,WACCD,EAAAA,KAAAoC,EAAAA,SAAA,CACEnC,SAAA,GAAAV,IAAC,MAAA,CAAIE,UAAU,gEACfF,IAAC,QAAKU,SAAA,cAGRD,EAAAA,KAAAoC,EAAAA,SAAA,CACEnC,SAAA,GAAAV,IAACoI,EAAA,CAAUlI,UAAU,cACrBF,IAAC,QAAKU,SAAA,2BAWzBiH,SACM,MAAA,CAAIzH,UAAU,iGACbQ,SAAAD,EAAAA,KAAC,MAAA,CAAIP,UAAU,+EACbQ,SAAA,CAAAV,EAAAA,IAAC,OAAIE,UAAU,8FACbQ,SAAAD,EAAAA,KAAC,MAAA,CAAIP,UAAU,oCACbQ,SAAA,CAAAD,OAAC,MAAA,CACCC,SAAA,CAAAV,EAAAA,IAAC,KAAA,CAAGE,UAAU,qBAAsBQ,SAAAiH,EAAexM,UACnDsF,KAAC,IAAA,CAAEP,UAAU,gBACVQ,SAAA,CAAAiH,EAAevM,aAAa,MAAIuM,EAAetM,iBAGpD2E,EAAAA,IAAC,SAAA,CACCW,QAAS,IAAMiH,EAAkB,MACjC1H,UAAU,mEAEVQ,WAAAV,IAAC,OAAA,CAAKE,UAAU,WAAWQ,SAAA,eAKjCD,KAAC,MAAA,CAAIP,UAAU,gBAEZQ,SAAA,CAAAiH,EAAenM,cACdiF,OAAC,MAAA,CAAIP,UAAU,4BACbQ,SAAA,CAAAV,EAAAA,IAAC,KAAA,CAAGE,UAAU,2CAA2CQ,SAAA,YACzDD,KAAC,MAAA,CAAIP,UAAU,wCACbQ,SAAA,GAAAD,KAAC,MAAA,CAAIP,UAAU,sCACbQ,SAAA,CAAAV,MAAC,MAAA,CAAIE,UAAU,mCACZQ,SAAAiH,EAAenM,aAAazB,iBAE/BiG,EAAAA,IAAC,MAAA,CAAIE,UAAU,wBAAwBQ,SAAA,eAEzCD,KAAC,MAAA,CAAIP,UAAU,sCACbQ,SAAA,CAAAV,EAAAA,IAAC,MAAA,CAAIE,UAAU,mCACZQ,UAAA,OAAAkI,EAAAjB,EAAenM,aAAatB,sBAA5B,EAAA0O,EAA6CnO,QAAQ,KAAM,SAE9DuF,EAAAA,IAAC,MAAA,CAAIE,UAAU,wBAAwBQ,SAAA,gBAEzCD,KAAC,MAAA,CAAIP,UAAU,sCACbQ,SAAA,CAAAV,MAAC,MAAA,CAAIE,UAAU,kCACZQ,SAAAiH,EAAenM,aAAarB,gBAE/B6F,EAAAA,IAAC,MAAA,CAAIE,UAAU,wBAAwBQ,SAAA,gBAEzCD,KAAC,MAAA,CAAIP,UAAU,sCACbQ,SAAA,CAAAV,MAAC,MAAA,CAAIE,UAAU,qCACZQ,SAAAiH,EAAenM,aAAalB,iBAE/B0F,EAAAA,IAAC,MAAA,CAAIE,UAAU,wBAAwBQ,SAAA,oBAO9CiH,EAAepN,UAAYoN,EAAepN,SAASrL,OAAS,GAC3DuR,EAAAA,KAAC,MAAA,CAAIP,UAAU,uDACbQ,SAAA,GAAAD,KAAC,KAAA,CAAGP,UAAU,6DACZQ,SAAA,GAAAV,IAACyI,EAAA,CAAWvI,UAAU,iCAAiC,aAGzDF,IAAC,MAAA,CAAIE,UAAU,YACZQ,SAAAiH,EAAepN,SAAS3K,IAAI,CAACiZ,EAAiBC,IAC7CrI,OAAC,IAAA,CAAcP,UAAU,wBAAwBQ,SAAA,CAAA,KAC5CmI,IADGC,SASfnB,EAAenN,iBAAmBmN,EAAenN,gBAAgBtL,OAAS,GACzEuR,EAAAA,KAAC,MAAA,CAAIP,UAAU,mDACbQ,SAAA,GAAAD,KAAC,KAAA,CAAGP,UAAU,6DACZQ,SAAA,GAAAV,IAAC+I,EAAA,CAAc7I,UAAU,+BAA+B,YAG1DF,IAAC,MAAA,CAAIE,UAAU,YACZQ,SAAAiH,EAAenN,gBAAgB5K,IAAI,CAACoZ,EAAaF,IAChDrI,OAAC,IAAA,CAAcP,UAAU,wBAAwBQ,SAAA,CAAA,KAC5CsI,IADGF,UASf,OAAAG,EAAAtB,EAAelM,oBAAf,EAAAwN,EAA8BvP,WAC7B+G,EAAAA,KAAC,MAAA,CAAIP,UAAU,iDACbQ,SAAA,GAAAD,KAAC,KAAA,CAAGP,UAAU,6DACZQ,SAAA,GAAAV,IAACG,EAAA,CAAMD,UAAU,+BAA+B,YAGlDF,EAAAA,IAAC,MAAA,CAAIE,UAAU,YACZQ,SAAAiH,EAAelM,cAAc/B,SAAS9J,IAAK5B,YAC1CyS,OAAAA,OAAC,MAAA,CAA4BP,UAAU,wCACrCQ,SAAA,GAAAD,KAAC,MAAA,CAAIP,UAAU,yCACbQ,SAAA,CAAAV,EAAAA,IAAC,KAAA,CAAGE,UAAU,sCAAuCQ,SAAA1S,EAAQiI,gBAC7D+J,IAAC,OAAA,CAAKE,UAAW,8CAA8C6H,EAAkB/Z,EAAQqI,SAASnF,aAC/FwP,SAAAuH,EAAkBja,EAAQqI,SAASnF,kBAIxCuP,KAAC,MAAA,CAAIP,UAAU,gDACbQ,SAAA,CAAAD,OAAC,MAAA,CACCC,SAAA,CAAAV,EAAAA,IAAC,MAAA,CAAIE,UAAU,gBAAgBQ,SAAA,aAC/BD,KAAC,MAAA,CAAIP,UAAU,8BAA+BQ,SAAA,CAAA1S,EAAQS,gBAAgBQ,cAAc,iBAErF,MAAA,CACCyR,SAAA,CAAAV,EAAAA,IAAC,MAAA,CAAIE,UAAU,gBAAgBQ,SAAA,SAC/BV,EAAAA,IAAC,OAAIE,UAAU,8BAA+BQ,WAAQrK,SAASC,QAAQmE,QAAQ,eAEhF,MAAA,CACCiG,SAAA,CAAAV,EAAAA,IAAC,MAAA,CAAIE,UAAU,gBAAgBQ,SAAA,SAC/BD,KAAC,MAAA,CAAIP,UAAU,8BACZQ,SAAA,EAAA,OAAAzL,EAAAjH,EAAQ4I,UAAUC,mBAAlB,EAAA5B,EAAgCwF,QAAQ,KAAM,IAAI,iBAGtD,MAAA,CACCiG,SAAA,CAAAV,EAAAA,IAAC,MAAA,CAAIE,UAAU,gBAAgBQ,SAAA,UAC/BV,IAAC,MAAA,CAAIE,UAAU,8BACZQ,UAAA,OAAArL,EAAArH,EAAQiJ,eAAe7D,wBAAvB,EAAAiC,EAA0CoF,QAAQ,KAAM,gBAG5D,MAAA,CACCiG,SAAA,CAAAV,EAAAA,IAAC,MAAA,CAAIE,UAAU,gBAAgBQ,SAAA,WAC/BD,KAAC,MAAA,CAAIP,UAAU,6BAA8BQ,SAAA,CAAA1S,EAAQuH,OAAO8B,KAAK,eA/B7DrJ,EAAQH,+BA+C5C","x_google_ignoreList":[0,1,2]}