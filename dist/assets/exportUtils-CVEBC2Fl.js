import{ah as t,ai as e}from"./index-BXAoWvaK.js";function n(t){const{user:e,trainingRecords:n,acwrData:a,exportDate:o,dateRange:i}=t,r=n.map(t=>{var e,n,o;const i=a.find(e=>e.date===t.date);return[t.date,t.rpe.toString(),t.duration_min.toString(),(t.load??"").toString(),(null==(e=null==i?void 0:i.acwr)?void 0:e.toString())||"",(null==(n=null==i?void 0:i.acuteLoad)?void 0:n.toString())||"",(null==(o=null==i?void 0:i.chronicLoad)?void 0:o.toString())||"",(null==i?void 0:i.riskLevel)||""]}),d=[`# ${e.name}さんの練習記録`,`# エクスポート日時: ${o}`,`# 期間: ${i.start} ～ ${i.end}`,"",["日付","RPE","練習時間(分)","負荷","ACWR","急性負荷","慢性負荷","リスクレベル"].join(","),...r.map(t=>t.join(","))].join("\n"),l=new Blob(["\ufeff"+d],{type:"text/csv;charset=utf-8;"}),c=document.createElement("a"),s=URL.createObjectURL(l);c.setAttribute("href",s),c.setAttribute("download",`${e.name}_練習記録_${i.start}_${i.end}.csv`),c.style.visibility="hidden",document.body.appendChild(c),c.click(),document.body.removeChild(c)}function a(t){const{teamName:e,athletes:n,teamSummary:a,exportDate:o,dateRange:i}=t,r=[];n.forEach(t=>{t.trainingRecords.forEach(e=>{var n,a,o;const i=t.acwrData.find(t=>t.date===e.date);r.push([t.user.name,e.date,e.rpe.toString(),e.duration_min.toString(),(e.load??"").toString(),(null==(n=null==i?void 0:i.acwr)?void 0:n.toString())||"",(null==(a=null==i?void 0:i.acuteLoad)?void 0:a.toString())||"",(null==(o=null==i?void 0:i.chronicLoad)?void 0:o.toString())||"",(null==i?void 0:i.riskLevel)||""])})});const d=[`# ${e} チーム練習記録`,`# エクスポート日時: ${o}`,`# 期間: ${i.start} ～ ${i.end}`,`# 総選手数: ${a.totalAthletes}名`,`# アクティブ選手数: ${a.activeAthletes}名`,`# チーム平均ACWR: ${a.averageACWR}`,`# 高リスク選手数: ${a.highRiskAthletes}名`,"",["選手名","日付","RPE","練習時間(分)","負荷","ACWR","急性負荷","慢性負荷","リスクレベル"].join(","),...r.map(t=>t.join(","))].join("\n"),l=new Blob(["\ufeff"+d],{type:"text/csv;charset=utf-8;"}),c=document.createElement("a"),s=URL.createObjectURL(l);c.setAttribute("href",s),c.setAttribute("download",`${e}_チーム練習記録_${i.start}_${i.end}.csv`),c.style.visibility="hidden",document.body.appendChild(c),c.click(),document.body.removeChild(c)}function o(t){const{user:e,exportDate:n,dateRange:a}=t,o=JSON.stringify(t,null,2),i=new Blob([o],{type:"application/json"}),r=document.createElement("a"),d=URL.createObjectURL(i);r.setAttribute("href",d),r.setAttribute("download",`${e.name}_詳細データ_${a.start}_${a.end}.json`),r.style.visibility="hidden",document.body.appendChild(r),r.click(),document.body.removeChild(r)}function i(n,a,o){const i=t();let r,d=new Date(i);switch(n){case"week":r=new Date(i),r.setDate(r.getDate()-7);break;case"month":default:r=new Date(i),r.setMonth(r.getMonth()-1);break;case"quarter":r=new Date(i),r.setMonth(r.getMonth()-3);break;case"custom":throw new Error("カスタム期間には開始日と終了日が必要です")}return{start:e(r),end:e(d)}}export{n as a,a as b,o as e,i as g};
//# sourceMappingURL=exportUtils-CVEBC2Fl.js.map
