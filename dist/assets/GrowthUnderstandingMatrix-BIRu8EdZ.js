import{at as h,j as e}from"./index-C7IL5YWP.js";import{d as u,R as j,S as b,C as f,X as p,Y as g,b as x,T as y,e as v,g as c}from"./chart-vendor-B8I3tXXj.js";import"./supabase-vendor-CRHRt2Ih.js";const N=(r,t,s)=>Math.max(t,Math.min(s,r));function w(r,t){return!isFinite(r)||r<=0||!isFinite(t)||t<=0?6:6+N(r/t,0,1)*12}const M=r=>{const{cx:t,cy:s}=r;return t==null||s==null?null:e.jsx("text",{x:t,y:s,textAnchor:"middle",dominantBaseline:"central",fontSize:18,children:"★"})};function R(r){const{points:t,teamAvg:s}=r,d=u.useMemo(()=>t!=null&&t.length?Math.max(...t.map(i=>typeof i.load=="number"?i.load:0),0):0,[t]),o=s?[{x:s.x,y:s.y,name:"チーム平均",load:s.load,rpe:null,duration_min:null}]:[];return e.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-4 sm:p-5",children:[e.jsx("div",{className:"flex items-end justify-between mb-3",children:e.jsxs("div",{children:[e.jsx("div",{className:"text-sm sm:text-base font-semibold text-gray-900",children:"成長度 × 理解度 × 負荷（sRPE）"}),e.jsx("div",{className:"text-xs text-gray-500",children:"点の大きさ＝load / ★＝チーム平均 / 50ラインで4象限"})]})}),e.jsx("div",{style:{width:"100%",height:420},children:e.jsx(j,{children:e.jsxs(b,{margin:{top:10,right:16,bottom:10,left:10},children:[e.jsx(f,{}),e.jsx(p,{type:"number",dataKey:"x",domain:[0,100],ticks:[0,25,50,75,100],label:{value:"理解度",position:"insideBottom",offset:-5}}),e.jsx(g,{type:"number",dataKey:"y",domain:[0,100],ticks:[0,25,50,75,100],label:{value:"成長度",angle:-90,position:"insideLeft"}}),e.jsx(x,{x:50,strokeDasharray:"4 4"}),e.jsx(x,{y:50,strokeDasharray:"4 4"}),e.jsx(y,{cursor:{strokeDasharray:"3 3"},content:({active:i,payload:a})=>{if(!i||!(a!=null&&a.length))return null;const n=a[0].payload;return e.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-3 shadow",children:[e.jsx("div",{className:"font-semibold mb-1",children:n.name}),e.jsxs("div",{className:"text-sm",children:["理解度: ",Math.round(n.x)]}),e.jsxs("div",{className:"text-sm",children:["成長度: ",Math.round(n.y)]}),e.jsxs("div",{className:"text-sm",children:["負荷(load): ",Math.round(n.load)]}),typeof n.rpe=="number"&&e.jsxs("div",{className:"text-sm",children:["RPE: ",n.rpe]}),typeof n.duration_min=="number"&&e.jsxs("div",{className:"text-sm",children:["時間: ",n.duration_min,"分"]})]})}}),e.jsx(v,{}),e.jsx(c,{name:"選手",data:t,shape:i=>{const{cx:a,cy:n,payload:l}=i,m=w((l==null?void 0:l.load)??0,d);return e.jsx("circle",{cx:a,cy:n,r:m,fill:"#3b82f6",fillOpacity:.55,stroke:"#1d4ed8",strokeWidth:1})}}),e.jsx(c,{name:"チーム平均",data:o,shape:e.jsx(M,{})})]})})})]})}function C(r){const{date:t,athletes:s}=r,{points:d,teamAvg:o,loading:i,error:a}=h({date:t,athletes:s});return i?e.jsx("div",{className:"bg-white rounded-xl border border-gray-200 p-4 sm:p-5",children:e.jsx("div",{className:"flex items-center justify-center py-10",children:e.jsx("div",{className:"animate-spin rounded-full h-10 w-10 border-b-2 border-blue-600"})})}):a?e.jsxs("div",{className:"bg-white rounded-xl border border-red-200 p-4 sm:p-5 text-sm text-red-700",children:["GrowthUnderstandingMatrix：",a]}):e.jsx(R,{points:d,teamAvg:o})}export{R as GrowthUnderstandingMatrixChart,C as default};
