import{ah as v,ai as R}from"./index-C7IL5YWP.js";function D(d){const{user:r,trainingRecords:u,acwrData:o,exportDate:t,dateRange:a}=d,c=["日付","RPE","練習時間(分)","負荷","ACWR","急性負荷","慢性負荷","リスクレベル"],l=u.map(i=>{var n,m,h;const e=o.find(b=>b.date===i.date);return[i.date,i.rpe.toString(),i.duration_min.toString(),(i.load??"").toString(),((n=e==null?void 0:e.acwr)==null?void 0:n.toString())||"",((m=e==null?void 0:e.acuteLoad)==null?void 0:m.toString())||"",((h=e==null?void 0:e.chronicLoad)==null?void 0:h.toString())||"",(e==null?void 0:e.riskLevel)||""]}),g=[`# ${r.name}さんの練習記録`,`# エクスポート日時: ${t}`,`# 期間: ${a.start} ～ ${a.end}`,"",c.join(","),...l.map(i=>i.join(","))].join(`
`),p="\uFEFF",$=new Blob([p+g],{type:"text/csv;charset=utf-8;"}),s=document.createElement("a"),S=URL.createObjectURL($);s.setAttribute("href",S),s.setAttribute("download",`${r.name}_練習記録_${a.start}_${a.end}.csv`),s.style.visibility="hidden",document.body.appendChild(s),s.click(),document.body.removeChild(s)}function k(d){const{teamName:r,athletes:u,teamSummary:o,exportDate:t,dateRange:a}=d,c=["選手名","日付","RPE","練習時間(分)","負荷","ACWR","急性負荷","慢性負荷","リスクレベル"],l=[];u.forEach(i=>{i.trainingRecords.forEach(e=>{var m,h,b;const n=i.acwrData.find(f=>f.date===e.date);l.push([i.user.name,e.date,e.rpe.toString(),e.duration_min.toString(),(e.load??"").toString(),((m=n==null?void 0:n.acwr)==null?void 0:m.toString())||"",((h=n==null?void 0:n.acuteLoad)==null?void 0:h.toString())||"",((b=n==null?void 0:n.chronicLoad)==null?void 0:b.toString())||"",(n==null?void 0:n.riskLevel)||""])})});const g=[`# ${r} チーム練習記録`,`# エクスポート日時: ${t}`,`# 期間: ${a.start} ～ ${a.end}`,`# 総選手数: ${o.totalAthletes}名`,`# アクティブ選手数: ${o.activeAthletes}名`,`# チーム平均ACWR: ${o.averageACWR}`,`# 高リスク選手数: ${o.highRiskAthletes}名`,"",c.join(","),...l.map(i=>i.join(","))].join(`
`),p="\uFEFF",$=new Blob([p+g],{type:"text/csv;charset=utf-8;"}),s=document.createElement("a"),S=URL.createObjectURL($);s.setAttribute("href",S),s.setAttribute("download",`${r}_チーム練習記録_${a.start}_${a.end}.csv`),s.style.visibility="hidden",document.body.appendChild(s),s.click(),document.body.removeChild(s)}function A(d){const{user:r,exportDate:u,dateRange:o}=d,t=JSON.stringify(d,null,2),a=new Blob([t],{type:"application/json"}),c=document.createElement("a"),l=URL.createObjectURL(a);c.setAttribute("href",l),c.setAttribute("download",`${r.name}_詳細データ_${o.start}_${o.end}.json`),c.style.visibility="hidden",document.body.appendChild(c),c.click(),document.body.removeChild(c)}function j(d,r,u){const o=v();let t,a=new Date(o);switch(d){case"week":{t=new Date(o),t.setDate(t.getDate()-7);break}case"month":{t=new Date(o),t.setMonth(t.getMonth()-1);break}case"quarter":{t=new Date(o),t.setMonth(t.getMonth()-3);break}case"custom":throw new Error("カスタム期間には開始日と終了日が必要です");default:t=new Date(o),t.setMonth(t.getMonth()-1)}return{start:R(t),end:R(a)}}export{D as a,k as b,A as e,j as g};
